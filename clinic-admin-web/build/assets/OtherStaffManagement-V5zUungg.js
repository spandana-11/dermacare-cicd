import{r as m,j as e,B as k,h as q,i as Y,b as he,a as xe,R as ue}from"./index-BZd6-648.js";import{v as w,a as G,f as je,b as ve}from"./Validators-FoVLkSgm.js";import{c as H}from"./capitalizeWords-CuwF8AcI.js";import{U as ge}from"./UserPermissionModal-CI7dZmvK.js";import{C as te,a as le,b as re}from"./CModalHeader-Durv8XK2.js";import{C as be}from"./CModalTitle-CQh3zxe_.js";import{C as fe}from"./CForm-qjDyPqIY.js";import{C as x}from"./CFormLabel-CWNs-Shv.js";import{C as v}from"./CFormInput-Ck0ix0GZ.js";import{C as oe}from"./CFormSelect-DCAectsn.js";import{C as pe}from"./CFormTextarea-1_ucRcIb.js";import{C as de}from"./CModalFooter-CnaQ0PLi.js";import{b as O}from"./index.esm-BZe2opj0.js";import{C as Ne}from"./ConfirmationModal-DxV_gve6.js";import{L as Ce}from"./loader-Dx4sjdu_.js";import{C as ye,a as ke,b as ae,c as D,d as Ae,e as y}from"./CTable-BxVenPcb.js";import{E as we}from"./eye-b51ggR7A.js";import{P as De,T as Se}from"./trash-2-rbTdXEzu.js";import"./CNavItem-wDeXchN9.js";const Ie=({visible:g,onClose:N,onSave:Q,initialData:C,viewMode:S,technicians:p,fetchTechs:ne})=>{const A={wardBoyId:"",clinicId:localStorage.getItem("HospitalId"),branchId:localStorage.getItem("branchId"),hospitalName:localStorage.getItem("HospitalName"),fullName:"",gender:"male",dateOfBirth:"",contactNumber:"",emailId:"",governmentId:"",dateOfJoining:"",department:"",workExprience:"",shiftTimingOrAvailability:"",emergencyContact:"",role:"other staff",address:{houseNo:"",street:"",landmark:"",city:"",state:"",postalCode:"",country:"India"},bankAccountDetails:{accountNumber:"",accountHolderName:"",ifscCode:"",bankName:"",branchName:"",panCardNumber:""},medicalFitnessCertificate:"",profilePicture:"",basicHealthFirstAidTrainingCertificate:"",previousEmploymentHistory:"",policeVerification:"",policeVerificationCertificate:"",userName:"",password:"",permissions:{}},[a,f]=m.useState(A),[F,me]=m.useState(localStorage.getItem("HospitalId")),[L,_]=m.useState(!1),[J,I]=m.useState(!1),[E,K]=m.useState(null),[U,B]=m.useState(!1),[o,b]=m.useState({}),$=["fullName","dateOfBirth","contactNumber","governmentId","dateOfJoining","department","clinicId","medicalFitnessCertificate","role","address.houseNo","address.street","address.city","address.state","address.postalCode","address.country","bankAccountDetails.accountNumber","bankAccountDetails.accountHolderName","bankAccountDetails.bankName","bankAccountDetails.branchName","bankAccountDetails.ifscCode","bankAccountDetails.panCardNumber"],V=s=>{f(l=>{const t={...l.permissions};return t[s]?delete t[s]:t[s]=[],{...l,permissions:t}})},X=(s,l)=>{f(t=>{const r={...t.permissions};return r[s]||(r[s]=[]),r[s].includes(l)?r[s]=r[s].filter(h=>h!==l):r[s]=[...r[s],l],{...t,permissions:r}})},z=s=>{f(l=>{const t={...l.permissions};return t[s]?t[s].length===G.length?t[s]=[]:t[s]=[...G]:t[s]=[...G],{...l,permissions:t}})},M=s=>new Promise((l,t)=>{const r=new FileReader;r.readAsDataURL(s),r.onload=()=>l(r.result),r.onerror=h=>t(h)});m.useEffect(()=>{f(C||A)},[C]);const u=(s,l)=>{f(r=>({...r,[s]:l}));const t=w(s,l,{...a,[s]:l},p);b(r=>({...r,[s]:t}))},ee=(s,l)=>{const t=w(s,l,a,p);b(r=>({...r,[s]:t}))},j=(s,l,t)=>{f(r=>({...r,[s]:{...r[s],[l]:t}}))},T=(s,l)=>{const t=s.target.files[0];if(!t)return;const r=new FileReader;r.onloadend=()=>{f(h=>({...h,[l]:r.result,[`${l}Name`]:t.name,[`${l}Type`]:t.type}))},r.readAsDataURL(t)},W=()=>{const s=ve(a,$);if(s.length){k.error(s.join(`
`),{autoClose:1e3});return}console.log(a),Q(a),f(A),N()},R=()=>{_(!1),K(null),B(!1)},Z=(s,l)=>{K(s),B(l==null?void 0:l.includes("pdf")),_(!0)},i=s=>{try{return atob(s)}catch{return null}},n=({title:s,children:l})=>e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold border-b pb-2 mb-4",children:s}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:l})]}),c=({label:s,value:l})=>e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 fw-bold",children:s}),e.jsx("p",{className:"text-base text-gray-900 text-break",children:l||"N/A"})]}),P=({label:s,value:l})=>e.jsxs("div",{className:"col-span-3",children:[s&&e.jsx("p",{className:"text-sm font-medium text-gray-600 fw-bold",children:s}),e.jsx("p",{className:"text-base text-gray-900 text-break",children:l||"N/A"})]}),ie=({label:s,type:l,data:t})=>{if(!t)return e.jsxs("p",{children:[s," "]});const r=l==null?void 0:l.startsWith("image/"),h=t.startsWith("data:")?t:`data:${l};base64,${t}`;return e.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[e.jsxs("strong",{children:[s,":"]}),e.jsxs("div",{className:"mt-2",children:[r?e.jsx("img",{src:h,alt:s,className:"w-32 h-32 object-cover rounded-md border cursor-pointer",onClick:()=>Z(h,l)}):e.jsx("button",{type:"button ",className:" btn text-blue-600 hover:underline block mx-2",onClick:()=>Z(h,l),style:{backgroundColor:"var(--color-black)",color:"white"},children:"Preview"}),e.jsx("a",{href:h,download:s.replace(/\s+/g,"_"),className:"text-green-600 hover:underline text-sm block  btn",style:{backgroundColor:"var(--color-black)",color:"white"},children:"Download"})]})]})};return e.jsxs(e.Fragment,{children:[e.jsxs(te,{visible:g,onClose:N,size:"lg",className:"custom-modal",backdrop:"static",children:[e.jsx(le,{children:e.jsx(be,{children:S?"Personal Information":"Add / Edit Other Staff"})}),e.jsx(re,{children:S?e.jsxs("div",{className:"p-4 border rounded shadow-sm bg-white ",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"fw-bold ",children:"Name : "}),e.jsx("span",{children:a.fullName})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"fw-bold",children:"Email : "}),e.jsx("span",{children:a.emailId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"fw-bold",children:"Cantact : "}),e.jsx("span",{children:a.contactNumber})]})]}),e.jsxs("div",{className:"text-center",children:[a.profilePicture?e.jsx("img",{src:i(a.profilePicture),alt:a.fullName,width:"80",height:"80",style:{borderRadius:"50%",objectFit:"cover",border:"1px solid var(--color-black)"}}):e.jsx("img",{src:"/assets/images/default-avatar.png",alt:"No profile",width:"40",height:"40",style:{borderRadius:"50%",objectFit:"cover",border:"1px solid var(--color-black)"}}),e.jsxs("div",{style:{color:"var(--color-black)",marginTop:"5px",fontSize:"14px",fontWeight:"500"},children:["ID: ",a.id]})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"space-y-5 mt-5",children:[e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Full Name",value:a.fullName})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Email",value:a.emailId})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Contact",value:a.contactNumber})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Gender",value:a.gender})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Date of Birth",value:a.dateOfBirth})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Government ID",value:a.governmentId})})]}),e.jsx(n,{title:"Work Information",children:e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Date of Joining",value:a.dateOfJoining})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Department",value:a.department})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Experience",value:a.yearOfExperience})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Shift Timings",value:a.shiftTimingOrAvailability})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Emergency Contact",value:a.emergencyContact})})]})}),e.jsx(n,{title:"Address",children:e.jsx(P,{value:`${a.address.houseNo}, ${a.address.street}, ${a.address.city}, ${a.address.state} - ${a.address.postalCode}, ${a.address.country}`})}),e.jsx(n,{title:"Bank Details",children:e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Account Number",value:a.bankAccountDetails.accountNumber})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Account Holder Name",value:a.bankAccountDetails.accountHolderName})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"IFSC Code",value:a.bankAccountDetails.ifscCode})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Bank Name",value:a.bankAccountDetails.bankName})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"Branch Name",value:a.bankAccountDetails.branchName})}),e.jsx("div",{className:"col-md-4",children:e.jsx(c,{label:"PAN Card",value:a.bankAccountDetails.panCardNumber})})]})}),e.jsx(n,{title:"Documents",children:e.jsxs("div",{className:"row",children:[a.qualificationOrCertifications!=""?e.jsx("div",{className:"col-md-6",children:e.jsx(ie,{label:"Qualification / Certifications",type:a.qualificationOrCertificationsType,data:a.qualificationOrCertifications})}):e.jsx("p",{className:"col-md-6",children:"Not Provided qualification/Certifications"}),a.medicalFitnessCertificate!=""?e.jsx("div",{className:"col-md-6",children:e.jsx(ie,{label:"Medical Fitness Certificate",type:a.medicalFitnessCertificateType||"application/pdf",data:a.medicalFitnessCertificate})}):e.jsx("p",{className:"col-md-6",children:"Not Provided medical Fitness Certificate"})]})}),e.jsx("div",{className:"mt-4"}),e.jsx(n,{title:"Other Information ",children:e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(c,{label:"Police Verification",value:a.policeVerification})}),e.jsx("div",{className:"col-md-12",children:e.jsx(P,{label:"Previous Employment",value:a.previousEmploymentHistory})}),e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(P,{label:"User Name",value:a.userName})}),e.jsx("div",{className:"col-md-6",children:e.jsx(P,{label:"Password",value:a.password})})]})]})})]})]}):e.jsxs(fe,{children:[e.jsx("h5",{children:"Basic Information"}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-2",children:[e.jsxs(x,{children:["ClinicID ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{value:F,disabled:!0,onChange:s=>u("clinicId",s.target.value)})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsxs(x,{children:["Role ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{value:a.role,disabled:!0,onChange:s=>u("role",s.target.value)})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(x,{children:["Full Name ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{value:a.fullName,onChange:s=>u("fullName",s.target.value),onBlur:()=>ee("fullName",a.fullName),invalid:!!o.fullName}),o.fullName&&e.jsx("div",{className:"text-danger mt-1",children:o.fullName})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(x,{children:["Gender ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs(oe,{value:a.gender,onChange:s=>u("gender",s.target.value),invalid:!!o.gender,children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]}),o.gender&&e.jsx("div",{className:"text-danger mt-1",children:o.gender})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsxs(x,{children:["Date of Birth ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{type:"date",value:a.dateOfBirth,max:new Date(new Date().setFullYear(new Date().getFullYear()-18)).toISOString().split("T")[0],onChange:s=>u("dateOfBirth",s.target.value)})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(x,{children:["Contact Number ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{type:"text",maxLength:10,value:a.contactNumber,onChange:s=>{const l=s.target.value;if(/^\d*$/.test(l)){u("contactNumber",l);const t=validators.contactNumber(l);b(r=>({...r,contactNumber:t}))}}}),o.contactNumber&&e.jsx("div",{className:"text-danger mt-1",children:o.contactNumber})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx(x,{children:"Email"}),e.jsx(v,{type:"email",value:a.emailId,onChange:s=>{const l=s.target.value;u("emailId",l);const t=validators.email(l);b(r=>({...r,emailId:t}))}}),o.emailId&&e.jsx("div",{className:"text-danger mt-1",children:o.emailId})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsxs(x,{children:["GovernmentID (AadharCard No) ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{maxLength:12,value:a.governmentId,onChange:s=>{const l=s.target.value;if(/^\d*$/.test(l)){u("governmentId",l);const t=validators.aadhar(l);b(r=>({...r,governmentId:t}))}}}),o.governmentId&&e.jsx("div",{className:"text-danger mt-1",children:o.governmentId})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(x,{children:["Date of Joining ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{type:"date",value:a.dateOfJoining,onChange:s=>u("dateOfJoining",s.target.value),onBlur:()=>b(s=>({...s,dateOfJoining:w("dateOfJoining",a.dateOfJoining,a,p)}))}),o.dateOfJoining&&e.jsx("div",{className:"text-danger mt-1",children:o.dateOfJoining})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(x,{children:["Department ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{value:H(a.department),onChange:s=>u("department",s.target.value),onBlur:()=>b(s=>({...s,department:w("department",a.department,a,p)}))}),o.department&&e.jsx("div",{className:"text-danger mt-1",children:o.department})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-4",children:[" ",e.jsx(x,{children:"Years of Experience"}),e.jsx(v,{type:"number",value:a.yearOfExperience,onChange:s=>u("yearOfExperience",s.target.value)})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(x,{children:["Shift Timings / Availability ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs(oe,{value:a.shiftTimingOrAvailability,onChange:s=>u("shiftTimingOrAvailability",s.target.value),onBlur:()=>{const s=w("shiftTimingOrAvailability",a.shiftTimingOrAvailability,a,p);b(l=>({...l,shiftTimingOrAvailability:s}))},children:[e.jsx("option",{value:"",children:"Select Shift"}),e.jsx("option",{value:"06:00-12:00",children:"Morning (06:00 AM – 12:00 PM) – 6 hrs"}),e.jsx("option",{value:"12:00-18:00",children:"Afternoon (12:00 PM – 06:00 PM) – 6 hrs"}),e.jsx("option",{value:"18:00-00:00",children:"Evening (06:00 PM – 12:00 AM) – 6 hrs"}),e.jsx("option",{value:"00:00-06:00",children:"Night (12:00 AM – 06:00 AM) – 6 hrs"}),e.jsx("option",{value:"06:00-15:00",children:"Day Shift (06:00 AM – 03:00 PM) – 9 hrs"}),e.jsx("option",{value:"15:00-00:00",children:"Evening Shift (03:00 PM – 12:00 AM) – 9 hrs"}),e.jsx("option",{value:"21:00-06:00",children:"Night Shift (09:00 PM – 06:00 AM) – 9 hrs"}),e.jsx("option",{value:"06:00-18:00",children:"Long Day (06:00 AM – 06:00 PM) – 12 hrs"}),e.jsx("option",{value:"18:00-06:00",children:"Long Night (06:00 PM – 06:00 AM) – 12 hrs"})]}),o.shiftTimingOrAvailability&&e.jsx("div",{className:"text-danger mt-1",children:o.shiftTimingOrAvailability})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx(x,{children:"Emergency Contact"}),e.jsx(v,{type:"text",maxLength:10,value:a.emergencyContact,onChange:s=>{const l=s.target.value;/^\d*$/.test(l)&&u("emergencyContact",l)},onBlur:()=>{const s=w("emergencyContact",a.emergencyContact,a,p);b(l=>({...l,emergencyContact:s}))}}),o.emergencyContact&&e.jsx("div",{className:"text-danger mt-1",children:o.emergencyContact})]})]}),e.jsx("div",{className:"row mb-3"}),e.jsx("h5",{className:"mt-3",children:"Address"}),Object.keys(a.address).reduce((s,l,t)=>(t%3===0&&s.push([]),s[s.length-1].push(l),s),[]).map((s,l)=>e.jsx("div",{className:"row mb-3",children:s.map(t=>{var r;return e.jsxs("div",{className:"col-md-4",children:[e.jsxs(x,{className:"text-capitalize",children:[t," ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{type:"text",maxLength:t==="postalCode"?6:void 0,value:H(a.address[t]),onChange:h=>{let d=h.target.value;t==="postalCode"?/^\d*$/.test(d)&&j("address",t,d):j("address",t,d)},onBlur:()=>{const h=w(t,a.address[t],a,p);b(d=>({...d,address:{...d.address,[t]:h}}))}}),((r=o.address)==null?void 0:r[t])&&e.jsx("div",{className:"text-danger mt-1",children:o.address[t]})]},t)})},l)),e.jsx("h5",{className:"mt-3",children:"Bank Account Details"}),Object.keys(a.bankAccountDetails).reduce((s,l,t)=>(t%3===0&&s.push([]),s[s.length-1].push(l),s),[]).map((s,l)=>e.jsx("div",{className:"row mb-3",children:s.map(t=>{var r;return e.jsxs("div",{className:"col-md-4",children:[e.jsxs(x,{className:"text-capitalize",children:[t," ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{value:a.bankAccountDetails[t],maxLength:t==="accountNumber"?20:t==="panCardNumber"?10:t==="ifscCode"?11:void 0,onChange:async h=>{let d=h.target.value;if(t==="accountNumber"){/^\d*$/.test(d)&&j("bankAccountDetails",t,d);return}if(t==="panCardNumber"){d=d.toUpperCase(),/^[A-Z]{0,5}[0-9]{0,4}[A-Z]{0,1}$/.test(d)&&j("bankAccountDetails",t,d);return}if(t==="ifscCode"){d=d.toUpperCase(),/^[A-Z0-9]*$/.test(d)&&j("bankAccountDetails",t,d);return}j("bankAccountDetails",t,d)},onBlur:async()=>{const h=w(t,a.bankAccountDetails[t],a);if(b(d=>({...d,bankAccountDetails:{...d.bankAccountDetails,[t]:h}})),t==="panCardNumber"&&a.bankAccountDetails[t].length===10&&(/^[A-Z]{5}[0-9]{4}[A-Z]$/.test(a.bankAccountDetails[t])||k.error("Invalid PAN format (e.g., ABCDE1234F)")),t==="ifscCode"&&a.bankAccountDetails[t].length===11){if(!/^[A-Z]{4}0[A-Z0-9]{6}$/.test(a.bankAccountDetails[t])){k.error("Invalid IFSC format (e.g., HDFC0001234)"),j("bankAccountDetails","bankName",""),j("bankAccountDetails","branchName","");return}try{const se=await fetch(`https://ifsc.razorpay.com/${a.bankAccountDetails[t]}`);if(se.ok){const ce=await se.json();j("bankAccountDetails","bankName",ce.BANK||""),j("bankAccountDetails","branchName",ce.BRANCH||"")}}catch{k.error("Error fetching bank details"),j("bankAccountDetails","bankName",""),j("bankAccountDetails","branchName","")}}}}),((r=o.bankAccountDetails)==null?void 0:r[t])&&e.jsx("div",{className:"text-danger mt-1",children:o.bankAccountDetails[t]})]},t)})},l)),e.jsx("h5",{className:"mt-3",children:"Documents"}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsxs(x,{children:["Profile Image ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{type:"file",accept:"image/*",onChange:async s=>{const l=s.target.files[0];if(l){const t=await M(l);u("profilePicture",t)}}})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(x,{children:["Medical Fitness Certificate ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{type:"file",onChange:s=>T(s,"medicalFitnessCertificate")})]})]}),e.jsx(x,{children:"Previous Employment History"}),e.jsx(pe,{rows:3,value:a.previousEmploymentHistory,onChange:s=>u("previousEmploymentHistory",s.target.value),placeholder:"Enter previous employment history"}),e.jsx("div",{className:"mb-3 w-100 mt-4",style:{display:"flex",justifyContent:"end",alignContent:"end",alignItems:"end"}}),e.jsx(ge,{show:J,onClose:()=>I(!1),features:je,actions:G,permissions:a.permissions,toggleFeature:V,toggleAllActions:z,togglePermission:X,onSave:()=>{console.log("Saved Permissions",a.permissions),I(!1)}})]})}),e.jsx(de,{children:S?e.jsx(O,{color:"secondary",onClick:N,children:"Close"}):e.jsxs(e.Fragment,{children:[e.jsx(O,{style:{backgroundColor:"var(--color-bgcolor)",color:"var(--color-black)"},onClick:()=>f(A),children:"Clear"}),e.jsx(O,{color:"secondary",onClick:N,children:"Cancel"}),e.jsx(O,{style:{backgroundColor:"var(--color-black)",color:"white"},onClick:W,children:"Save"})]})})]}),e.jsxs(te,{visible:L,onClose:R,size:"xl",children:[e.jsx(le,{onClose:R,children:e.jsx("strong",{children:U?"PDF Preview":"Image Preview"})}),e.jsx(re,{className:"text-center",children:U?e.jsx("iframe",{src:E,title:"PDF Preview",style:{width:"100%",height:"80vh",border:"none"}}):e.jsx("img",{src:E,alt:"Preview",style:{maxWidth:"100%",maxHeight:"80vh",borderRadius:"8px"}})})]})]})},Pe=g=>q.get(`${Y}/getWardBoysByClinicId/${g}`),Oe=g=>q.post(`${Y}/addWardBoy`,g),Fe=(g,N)=>q.put(`${Y}/updateWardBoyById/${g}`,N),Be=g=>q.delete(`${Y}/deleteWardBoyById/${g}`),Xe=()=>{const[g,N]=m.useState([]),[Q,C]=m.useState(!1),[S,p]=m.useState(null),[ne,A]=m.useState(!1),[a,f]=m.useState(1),[F,me]=m.useState(10),{searchQuery:L,setSearchQuery:_}=he(),[J,I]=m.useState(!1),[E,K]=m.useState(null),[U,B]=m.useState(!1),[o,b]=m.useState(null),[$,V]=m.useState(null),[X,z]=m.useState(!1),M=async()=>{var i;I(!0);try{const n=localStorage.getItem("HospitalId");if(n){const c=await Pe(n);console.log("API Response:",c),I(!1),N(((i=c.data)==null?void 0:i.data)||[])}}catch(n){console.error("❌ Error fetching Other Staff:",n),N([]),I(!1)}finally{I(!1)}};m.useEffect(()=>{M()},[]);const u=async i=>{try{if(S)await Fe(S.wardBoyId,i),M(),k.success("Other Staff updated successfully!");else{const n=await Oe(i);await M(),console.log(n),V({username:n.data.data.userName,password:n.data.data.password}),C(!1),z(!0),k.success("Other Staff added successfully!")}}catch(n){k.error("❌ Failed to save Other Staff."),console.error("API error:",n)}},ee=async i=>{try{await Be(i),N(n=>n.filter(c=>c.id!==i)),k.success("Other Staff deleted successfully!")}catch(n){k.error("❌ Failed to delete Other Staff."),console.error("Delete error:",n)}finally{B(!1)}},{user:j}=xe(),T=(i,n)=>{var c,P;return(P=(c=j==null?void 0:j.permissions)==null?void 0:c[i])==null?void 0:P.includes(n)},W=ue.useMemo(()=>{const i=L.toLowerCase().trim();return i?g.filter(n=>Object.values(n).some(c=>String(c).toLowerCase().includes(i))):g},[L,g]),R=W.slice((a-1)*F,a*F),Z=i=>{try{return atob(i)}catch{return null}};return e.jsxs("div",{children:[T("Laboratory","create")&&e.jsx("div",{className:"mb-3 w-100",style:{display:"flex",justifyContent:"end",alignContent:"end",alignItems:"end"},children:e.jsx(O,{style:{color:"var(--color-black)",backgroundColor:"var(--color-bgcolor)"},onClick:()=>C(!0),children:"Add Other Staff"})}),e.jsxs(te,{visible:X,backdrop:"static",keyboard:!1,children:[e.jsx(le,{children:e.jsx("h5",{children:"OtherStaff Credentials"})}),e.jsx(re,{children:$?e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",$.username]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Password:"})," ",$.password]}),e.jsx("small",{className:"text-danger",children:"⚠️ Please save these credentials securely. They will not be shown again."})]}):e.jsx("p",{children:"No data available"})}),e.jsx(de,{children:e.jsx(O,{color:"primary",onClick:()=>{z(!1),V(null)},children:"Close"})})]}),e.jsx(Ne,{isVisible:U,title:"Delete Other Staff",message:"Are you sure you want to delete this Other staff? This action cannot be undone.",confirmText:"Yes, Delete",cancelText:"Cancel",confirmColor:"danger",cancelColor:"secondary",onConfirm:()=>ee(o),onCancel:()=>B(!1)}),J?e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx(Ce,{message:"Loading technician..."})}):E?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"50vh",color:"var(--color-black)"},children:E}):e.jsxs(ye,{className:"mt-3",striped:!0,hover:!0,responsive:!0,children:[e.jsx(ke,{children:e.jsxs(ae,{className:"pink-table  w-auto",children:[e.jsx(D,{children:"#"}),e.jsx(D,{children:"Photo"})," ",e.jsx(D,{children:"Name"}),e.jsx(D,{children:"Contact"}),e.jsx(D,{children:"Sex"}),e.jsx(D,{children:"Specialization"}),e.jsx(D,{children:"Date Of Joining"}),e.jsx(D,{className:"text-end",children:"Actions"})]})}),e.jsx(Ae,{className:"pink-table",children:R.length>0?R.map((i,n)=>e.jsxs(ae,{children:[e.jsx(y,{children:(a-1)*F+n+1}),e.jsx(y,{children:i.profilePicture?e.jsx("img",{src:Z(i.profilePicture),alt:i.fullName,width:"40",height:"40",style:{borderRadius:"50%",objectFit:"cover",border:"1px solid var(--color-black)"}}):e.jsx("img",{src:"/assets/images/default-avatar.png",alt:"No profile",width:"40",height:"40",style:{borderRadius:"50%",objectFit:"cover",border:"1px solid var(--color-black)"}})}),e.jsx(y,{children:H(i.fullName)}),e.jsx(y,{children:H(i.contactNumber)}),e.jsx(y,{children:H(i.gender)}),e.jsx(y,{children:i.specialization||"NA"}),e.jsx(y,{children:i.dateOfJoining}),e.jsx(y,{className:"text-end",children:e.jsxs("div",{className:"d-flex justify-content-end gap-2  ",children:[T("Laboratory","read")&&e.jsx("button",{className:"actionBtn",onClick:()=>{p(i),A(!0),C(!0)},title:"View",children:e.jsx(we,{size:18})}),T("Laboratory","update")&&e.jsx("button",{className:"actionBtn",onClick:()=>{p(i),A(!1),C(!0)},title:"Edit",children:e.jsx(De,{size:18})}),T("Laboratory","delete")&&e.jsx("button",{className:"actionBtn",onClick:()=>{b(i.wardBoyId),B(!0)},title:"Delete",children:e.jsx(Se,{size:18})})]})})]},i.id)):e.jsx(ae,{children:e.jsx(y,{colSpan:"9",className:"text-center",style:{color:"var(--color-black)"},children:"No Staff found."})})})]}),!J&&e.jsx("div",{className:"d-flex justify-content-end mt-3",style:{marginRight:"40px"},children:Array.from({length:Math.ceil(W.length/F)},(i,n)=>e.jsx(O,{style:{backgroundColor:a===n+1?"var(--color-black)":"#fff",color:a===n+1?"#fff":"var(--color-black)",border:"1px solid #ccc",borderRadius:"5px",cursor:"pointer"},className:"ms-2",onClick:()=>f(n+1),children:n+1},n))}),e.jsx(Ie,{visible:Q,onClose:()=>{C(!1),p(null),A(!1)},onSave:u,initialData:S,viewMode:ne,technicians:g,fetchTechs:M})]})};export{Xe as default};
