import{v as Q,r as u,j as e,B as m,n as he,i as ue,R as xe}from"./index-C7YuJAAI.js";import{c as $}from"./capitalizeWords-CuwF8AcI.js";import{C as je}from"./ConfirmationModal-Dkioqmh-.js";import{L as be}from"./loader-CAA1vNCh.js";import{f as ge,a as V}from"./Features-D45jZVjg.js";import{C as se,a as ae,b as te}from"./CModalHeader-Bku5iNpS.js";import{C as pe}from"./CModalTitle-CrSU8CaH.js";import{C as ve}from"./CForm-B3RLrqng.js";import{C as h}from"./CFormLabel-C_a-pvv2.js";import{C as g}from"./CFormInput-CNM-faD4.js";import{C as oe}from"./CFormSelect-DDyQ53N9.js";import{C as fe}from"./CFormTextarea-CsOwBSQs.js";import{a as A}from"./index.esm-B3sb08FX.js";import{C as ie}from"./CModalFooter-BtK5r1_p.js";import{C as Ne,a as Ce,b as ee,c as D,d as ye,e as k}from"./CTable-nsP1Y0CA.js";import{E as ke}from"./eye--1BT-mqr.js";import{P as we,T as De}from"./trash-2-BXEuflO5.js";import"./CNavItem-BHTEVeIb.js";import"./createLucideIcon-Cqvp34RQ.js";const Ae=f=>Q.get(`/receptionists/${f}`),Pe=f=>Q.post("/createReceptionist",f),Ie=(f,N)=>Q.put(`/updateReceptionist/${f}`,N),Se=f=>Q.delete(`/deleteReceptionist/${f}`),Fe=({visible:f,onClose:N,onSave:W,initialData:C,viewMode:P,receptionist:b,fetchTechs:le})=>{const T={},y={clinicId:localStorage.getItem("HospitalId"),branchId:localStorage.getItem("branchId"),hospitalName:localStorage.getItem("HospitalName"),fullName:"",dateOfBirth:"",contactNumber:"",qualification:"",governmentId:"",dateOfJoining:"",department:"",emergencyContact:"",profilePicture:"",emailId:"",graduationCertificate:"",computerSkillsProof:"",previousEmploymentHistory:"",role:"receptionist",gender:"male",yearOfExperience:"",vaccinationStatus:"Fully Vaccinated",address:{houseNo:"",street:"",landmark:"",city:"",state:"",postalCode:"",country:"India"},bankAccountDetails:{accountNumber:"",accountHolderName:"",ifscCode:"",bankName:"",branchName:"",panCardNumber:""},permissions:T},[a,p]=u.useState(y),[re,_]=u.useState(localStorage.getItem("HospitalId")),[ne,O]=u.useState(!1),[I,S]=u.useState(!1),[K,U]=u.useState(null),[F,z]=u.useState(!1),J=["fullName","dateOfBirth","contactNumber","emailId","governmentId","dateOfJoining","department","clinicId","profilePicture","role","address.houseNo","address.street","address.city","address.state","address.postalCode","address.country","bankAccountDetails.accountNumber","bankAccountDetails.accountHolderName","bankAccountDetails.bankName","bankAccountDetails.branchName","bankAccountDetails.ifscCode","bankAccountDetails.panCardNumber"];function R(s,l){const t=[];for(const n of l){const r=n.split(".");let i=s;for(const v of r)i=i==null?void 0:i[v];(!i||String(i).trim()==="")&&t.push(n)}return t}const q=s=>{p(l=>{const t={...l.permissions};return t[s]?delete t[s]:t[s]=[],{...l,permissions:t}})},X=(s,l)=>{p(t=>{const n={...t.permissions};return n[s]||(n[s]=[]),n[s].includes(l)?n[s]=n[s].filter(r=>r!==l):n[s]=[...n[s],l],{...t,permissions:n}})},Y=s=>{p(l=>{const t={...l.permissions};return t[s]?t[s].length===V.length?t[s]=[]:t[s]=[...V]:t[s]=[...V],{...l,permissions:t}})},B=s=>new Promise((l,t)=>{const n=new FileReader;n.readAsDataURL(s),n.onload=()=>l(n.result),n.onerror=r=>t(r)});u.useEffect(()=>{p(C||y)},[C]);const x=(s,l)=>{p(t=>({...t,[s]:l}))},j=(s,l,t)=>{p(n=>({...n,[s]:{...n[s],[l]:t}}))},E=(s,l)=>{const t=s.target.files[0];if(!t)return;const n=new FileReader;n.onloadend=()=>{p(r=>({...r,[l]:n.result,[`${l}Name`]:t.name,[`${l}Type`]:t.type}))},n.readAsDataURL(t)},M=()=>{const s=R(a,J);if(s.length>0){m.error(`Please fill required fields: ${s.join(", ")}`);return}if(a.dateOfBirth){const i=new Date(a.dateOfBirth),v=new Date,w=v.getFullYear()-i.getFullYear();if((v.getMonth()<i.getMonth()||v.getMonth()===i.getMonth()&&v.getDate()<i.getDate()?w-1:w)<18){m.error("Technician must be at least 18 years old.");return}}if(!/^[6-9]\d{9}$/.test(a.contactNumber)){m.error("Contact number must be 10 digits and start with 6-9.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.emailId)){m.error("Please enter a valid email address.");return}if(b==null?void 0:b.some(i=>i.contactNumber===a.contactNumber&&i.id!==a.id)){m.error("Contact number already exists!");return}if(b==null?void 0:b.some(i=>i.emailId===a.emailId&&i.id!==a.id)){m.error("Email already exists!");return}if(Object.keys(a.permissions).length===0){m.error("Please assign at least one user permission before saving.");return}console.log(a),W(a),p(y),N()},G=()=>{const s=R(a,J);if(s.length>0){m.error(`Please fill required fields: ${s.join(", ")}`);return}if(a.dateOfBirth){const i=new Date(a.dateOfBirth),v=new Date,w=v.getFullYear()-i.getFullYear();if((v.getMonth()<i.getMonth()||v.getMonth()===i.getMonth()&&v.getDate()<i.getDate()?w-1:w)<18){m.error("Technician must be at least 18 years old.");return}}if(!/^[6-9]\d{9}$/.test(a.contactNumber)){m.error("Contact number must be 10 digits and start with 6-9.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.emailId)){m.error("Please enter a valid email address.");return}if(b==null?void 0:b.some(i=>i.contactNumber===a.contactNumber&&i.id!==a.id)){m.error("Contact number already exists!");return}if(b==null?void 0:b.some(i=>i.emailId===a.emailId&&i.id!==a.id)){m.error("Email already exists!");return}console.log(a),S(!0)},H=()=>{O(!1),U(null),z(!1)},Z=(s,l)=>{U(s),z(l==null?void 0:l.includes("pdf")),O(!0)},o=s=>{try{return atob(s)}catch{return null}},c=({title:s,children:l})=>e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold border-b pb-2 mb-4",children:s}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:l})]}),d=({label:s,value:l})=>e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 fw-bold",children:s}),e.jsx("p",{className:"text-base text-gray-900 text-break",children:l||"N/A"})]}),L=({label:s,value:l})=>e.jsxs("div",{className:"col-span-3",children:[s&&e.jsx("p",{className:"text-sm font-medium text-gray-600 fw-bold",children:s}),e.jsx("p",{className:"text-base text-gray-900 text-break",children:l||"N/A"})]}),ce=({label:s,type:l,data:t})=>{if(!t)return e.jsxs("p",{children:[s," "]});const n=l==null?void 0:l.startsWith("image/"),r=t.startsWith("data:")?t:`data:${l};base64,${t}`;return e.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[e.jsxs("strong",{children:[s,":"]}),e.jsxs("div",{className:"mt-2",children:[n?e.jsx("img",{src:r,alt:s,className:"w-32 h-32 object-cover rounded-md border cursor-pointer",onClick:()=>Z(r,l)}):e.jsx("button",{type:"button ",className:" btn text-blue-600 hover:underline block mx-2",onClick:()=>Z(r,l),style:{backgroundColor:"var(--color-black)",color:"white"},children:"Preview"}),e.jsx("a",{href:r,download:s.replace(/\s+/g,"_"),className:"text-green-600 hover:underline text-sm block  btn",style:{backgroundColor:"var(--color-black)",color:"white"},children:"Download"})]})]})};return e.jsxs(e.Fragment,{children:[e.jsxs(se,{visible:f,onClose:N,size:"lg",className:"custom-modal",backdrop:"static",children:[e.jsx(ae,{children:e.jsx(pe,{children:P?"Personal Information":"Add / Edit Receptionist"})}),e.jsx(te,{children:P?e.jsxs("div",{className:"p-4 border rounded shadow-sm bg-white ",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"fw-bold ",children:"Name : "}),e.jsx("span",{children:a.fullName})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"fw-bold",children:"Email : "}),e.jsx("span",{children:a.emailId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"fw-bold",children:"Cantact : "}),e.jsx("span",{children:a.contactNumber})]})]}),e.jsxs("div",{className:"text-center",children:[a.profilePicture?e.jsx("img",{src:o(a.profilePicture),alt:a.fullName,width:"80",height:"80",style:{borderRadius:"50%",objectFit:"cover",border:"1px solid var(--color-black)"}}):e.jsx("img",{src:"/assets/images/default-avatar.png",alt:"No profile",width:"40",height:"40",style:{borderRadius:"50%",objectFit:"cover",border:"1px solid var(--color-black)"}}),e.jsxs("div",{style:{color:"var(--color-black)",marginTop:"5px",fontSize:"14px",fontWeight:"500"},children:["ID: ",a.id]})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"space-y-5 mt-5",children:[e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Full Name",value:a.fullName})}),e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Email",value:a.emailId})}),e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Contact",value:a.contactNumber})}),e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Date of Birth",value:a.dateOfBirth})}),e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Government ID",value:a.governmentId})})]}),e.jsx(c,{title:"Work Information",children:e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Date of Joining",value:a.dateOfJoining})}),e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Department",value:a.department})}),e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Qualification",value:a.qualification})}),e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Emergency Contact",value:a.emergencyContact})})]})}),e.jsx(c,{title:"Address",children:e.jsx(L,{value:`${a.address.houseNo}, ${a.address.street}, ${a.address.city}, ${a.address.state} - ${a.address.postalCode}, ${a.address.country}`})}),e.jsx(c,{title:"Bank Details",children:e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Account Number",value:a.bankAccountDetails.accountNumber})}),e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Account Holder Name",value:a.bankAccountDetails.accountHolderName})}),e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"IFSC Code",value:a.bankAccountDetails.ifscCode})}),e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Bank Name",value:a.bankAccountDetails.bankName})}),e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"Branch Name",value:a.bankAccountDetails.branchName})}),e.jsx("div",{className:"col-md-4",children:e.jsx(d,{label:"PAN Card",value:a.bankAccountDetails.panCardNumber})})]})}),e.jsx(c,{title:"Documents",children:e.jsxs("div",{className:"row",children:[a.graduationCertificate!=""?e.jsx("div",{className:"col-md-6",children:e.jsx(ce,{label:"Qualification / Certifications",type:a.graduationCertificateType,data:a.graduationCertificate})}):e.jsx("p",{className:"col-md-6",children:"Not Provided Graduation Certificate"}),a.computerSkillsProof!=""?e.jsx("div",{className:"col-md-6",children:e.jsx(ce,{label:"Computer Skills Proof",type:a.computerSkillsProofType||"application/pdf",data:a.computerSkillsProof})}):e.jsx("p",{className:"col-md-6",children:"Not Provided Computer Skills Proof"})]})}),e.jsx("div",{className:"mt-4"}),e.jsx(c,{title:"Other Information ",children:e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(d,{label:"Lab License",value:a.computerSkillsProof})}),e.jsx("div",{className:"col-md-12",children:e.jsx(L,{label:"Previous Employment",value:a.previousEmploymentHistory})})]})})]})]}):e.jsxs(ve,{children:[e.jsx("h5",{children:"Basic Information"}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-5",children:[e.jsxs(h,{children:["ClinicID ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(g,{value:re,disabled:!0,onChange:s=>x("clinicId",s.target.value)})]}),e.jsxs("div",{className:"col-md-7",children:[e.jsxs(h,{children:["Role ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(g,{value:a.role,disabled:!0,onChange:s=>x("role",s.target.value)})]})]})}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(h,{children:["Full Name ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(g,{value:a.fullName,onChange:s=>x("fullName",s.target.value)})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(h,{children:["Gender ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs(oe,{value:a.gender,onChange:s=>x("gender",s.target.value),children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsxs(h,{children:["Date of Birth ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(g,{type:"date",value:a.dateOfBirth,max:new Date(new Date().setFullYear(new Date().getFullYear()-18)).toISOString().split("T")[0],onChange:s=>x("dateOfBirth",s.target.value)})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(h,{children:["Contact Number ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(g,{type:"text",maxLength:10,value:a.contactNumber,onChange:s=>{const l=s.target.value;/^\d*$/.test(l)&&x("contactNumber",l)}})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(h,{children:["Email ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(g,{type:"email",value:a.emailId,onChange:s=>x("emailId",s.target.value)})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsxs(h,{children:["GovernmentID(AadharCard No) ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(g,{maxLength:12,value:a.governmentId,onChange:s=>{const l=s.target.value;/^\d*$/.test(l)&&x("governmentId",l)}})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(h,{children:["Date of Joining ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(g,{type:"date",value:a.dateOfJoining,onChange:s=>x("dateOfJoining",s.target.value)})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(h,{children:["Vaccination Status ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs(oe,{value:a.vaccinationStatus,onChange:s=>x("vaccinationStatus",s.target.value),children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Not Vaccinated",children:"Not Vaccinated"}),e.jsx("option",{value:"Partially Vaccinated",children:"Partially Vaccinated"}),e.jsx("option",{value:"Fully Vaccinated",children:"Fully Vaccinated"})]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-4",children:[" ",e.jsx(h,{children:"Department"}),e.jsx(g,{value:$(a.department),onChange:s=>x("department",s.target.value)})," "]}),e.jsxs("div",{className:"col-md-4",children:[" ",e.jsxs(h,{children:["Years of Experience ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(g,{type:"number",value:a.yearOfExperience,onChange:s=>x("yearOfExperience",s.target.value)})]}),e.jsxs("div",{className:"col-md-4",children:[" ",e.jsx(h,{children:"Qualification"}),e.jsx(g,{value:$(a.qualification),onChange:s=>x("qualification",s.target.value)})]})]}),e.jsx("div",{className:"row mb-3",children:e.jsxs("div",{className:"col-md-4",children:[e.jsx(h,{children:"Emergency Contact"}),e.jsx(g,{type:"text",maxLength:10,value:a.emergencyContact,onChange:s=>{const l=s.target.value;/^\d*$/.test(l)&&x("emergencyContact",s.target.value)}})]})}),e.jsx("h5",{className:"mt-3",children:"Address"}),Object.keys(a.address).reduce((s,l,t)=>(t%3===0&&s.push([]),s[s.length-1].push(l),s),[]).map((s,l)=>e.jsx("div",{className:"row mb-3",children:s.map(t=>e.jsxs("div",{className:"col-md-4",children:[e.jsxs(h,{className:"text-capitalize",children:[t," ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(g,{type:"text",maxLength:t==="postalCode"?6:void 0,value:$(a.address[t]),onChange:n=>{let r=n.target.value;t==="postalCode"?/^\d*$/.test(r)&&j("address",t,r):j("address",t,r)}})]},t))},l)),e.jsx("h5",{className:"mt-3",children:"Bank Account Details"}),Object.keys(a.bankAccountDetails).reduce((s,l,t)=>(t%3===0&&s.push([]),s[s.length-1].push(l),s),[]).map((s,l)=>e.jsx("div",{className:"row mb-3",children:s.map(t=>e.jsxs("div",{className:"col-md-4",children:[e.jsxs(h,{className:"text-capitalize",children:[t," ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(g,{value:a.bankAccountDetails[t],maxLength:t==="accountNumber"?20:t==="panCardNumber"?10:t==="ifscCode"?11:void 0,onChange:async n=>{let r=n.target.value;if(t==="accountNumber"){/^\d*$/.test(r)&&j("bankAccountDetails",t,r);return}if(t==="panCardNumber"){r=r.toUpperCase(),/^[A-Z]{0,5}[0-9]{0,4}[A-Z]{0,1}$/.test(r)&&j("bankAccountDetails",t,r),r.length===10&&(/^[A-Z]{5}[0-9]{4}[A-Z]$/.test(r)||m.error("Invalid PAN format (e.g., ABCDE1234F)"));return}if(t==="ifscCode"){if(r=r.toUpperCase(),!/^[A-Z0-9]*$/.test(r))return;if(j("bankAccountDetails",t,r),r.length===11){if(!/^[A-Z]{4}0[A-Z0-9]{6}$/.test(r)){m.error("Invalid IFSC format (e.g., HDFC0001234)"),j("bankAccountDetails","bankName",""),j("bankAccountDetails","branchName","");return}try{const v=await fetch(`https://ifsc.razorpay.com/${r}`);if(v.ok){const w=await v.json();j("bankAccountDetails","bankName",w.BANK||""),j("bankAccountDetails","branchName",w.BRANCH||"")}else m.error("Invalid IFSC Code"),j("bankAccountDetails","bankName",""),j("bankAccountDetails","branchName","")}catch{m.error("Error fetching bank details"),j("bankAccountDetails","bankName",""),j("bankAccountDetails","branchName","")}}else j("bankAccountDetails","bankName",""),j("bankAccountDetails","branchName","");return}j("bankAccountDetails",t,r)}})]},t))},l)),e.jsx("h5",{className:"mt-3",children:"Documents"}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsxs(h,{children:["Profile Image ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(g,{type:"file",accept:"image/*",onChange:async s=>{const l=s.target.files[0];if(l){const t=await B(l);x("profilePicture",t)}}})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx(h,{children:"Graduation Certificate"}),e.jsx(g,{type:"file",onChange:s=>E(s,"graduationCertificate")})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx(h,{children:"Computer Skills Proof"}),e.jsx(g,{type:"file",onChange:s=>E(s,"computerSkillsProof")})]})]}),e.jsx(h,{children:"Previous Employment History"}),e.jsx(fe,{rows:3,value:a.previousEmploymentHistory,onChange:s=>x("previousEmploymentHistory",s.target.value),placeholder:"Enter previous employment history"}),e.jsx("div",{className:"mb-3 w-100 mt-4",style:{display:"flex",justifyContent:"end",alignContent:"end",alignItems:"end"},children:e.jsx(A,{style:{color:"var(--color-black)",backgroundColor:"var(--color-bgcolor)"},onClick:G,children:"User Permissions"})}),I&&e.jsx("div",{className:"modal fade show d-block",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog modal-lg",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Set User Permissions"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>S(!1)})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"row",children:ge.map(s=>{const l=!!a.permissions[s],t=l&&a.permissions[s].length===V.length;return e.jsxs("div",{className:"col-md-5 mb-3 border p-2 rounded mx-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("label",{className:"fw-bold",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:()=>q(s)})," ",s]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",disabled:!l,checked:t,onChange:()=>Y(s)})," ","Select All"]})]}),e.jsx("div",{className:"d-flex flex-wrap gap-3 mt-2",children:V.map(n=>{var r;return e.jsxs("label",{className:"d-flex align-items-center gap-1",children:[e.jsx("input",{type:"checkbox",disabled:!l,checked:((r=a.permissions[s])==null?void 0:r.includes(n))||!1,onChange:()=>X(s,n)}),n]},n)})})]},s)})})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>S(!1),children:"Close"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>S(!1),children:"Save Permissions"})]})]})})}),I&&e.jsx("div",{className:"modal-backdrop fade show"})]})}),e.jsx(ie,{children:P?e.jsx(A,{color:"secondary",onClick:N,children:"Close"}):e.jsxs(e.Fragment,{children:[e.jsx(A,{style:{backgroundColor:"var(--color-bgcolor)",color:"var(--color-black)"},onClick:()=>p(y),children:"Clear"}),e.jsx(A,{color:"secondary",onClick:N,children:"Cancel"}),e.jsx(A,{style:{backgroundColor:"var(--color-black)",color:"white"},onClick:M,children:"Save"})]})})]}),e.jsxs(se,{visible:ne,onClose:H,size:"xl",children:[e.jsx(ae,{onClose:H,children:e.jsx("strong",{children:F?"PDF Preview":"Image Preview"})}),e.jsx(te,{className:"text-center",children:F?e.jsx("iframe",{src:K,title:"PDF Preview",style:{width:"100%",height:"80vh",border:"none"}}):e.jsx("img",{src:K,alt:"Preview",style:{maxWidth:"100%",maxHeight:"80vh",borderRadius:"8px"}})})]})]})},_e=()=>{const[f,N]=u.useState([]),[W,C]=u.useState(!1),[P,b]=u.useState(null),[le,T]=u.useState(!1),[y,a]=u.useState(1),[p,re]=u.useState(10),{searchQuery:_,setSearchQuery:ne}=he(),[O,I]=u.useState(!1),[S,K]=u.useState(null),[U,F]=u.useState(!1),[z,J]=u.useState(null),[R,q]=u.useState(null),[X,Y]=u.useState(!1),B=async()=>{var o;I(!0);try{const c=localStorage.getItem("HospitalId");if(c){const d=await Ae(c);console.log("API Response:",d),I(!1),N(((o=d.data)==null?void 0:o.data)||[])}}catch(c){console.error("❌ Error fetching lab receptionist:",c),N([]),I(!1)}finally{I(!1)}};u.useEffect(()=>{B()},[]);const x=async o=>{try{if(P)await Ie(P.id,o),B(),m.success("Receptionist updated successfully!");else{const c=await Pe(o);await B(),console.log(c),q({username:c.data.data.userName,password:c.data.data.password}),C(!1),Y(!0),m.success("Receptionist added successfully!")}C(!1),b(null)}catch(c){m.error("❌ Failed to save receptionist."),console.error("API error:",c)}},j=async o=>{try{await Se(o),N(c=>c.filter(d=>d.id!==o)),m.success("Receptionist deleted successfully!")}catch(c){m.error("❌ Failed to delete receptionist."),console.error("Delete error:",c)}finally{F(!1)}},{user:E}=ue(),M=(o,c)=>{var d,L;return(L=(d=E==null?void 0:E.permissions)==null?void 0:d[o])==null?void 0:L.includes(c)},G=xe.useMemo(()=>{const o=_.toLowerCase().trim();return o?f.filter(c=>Object.values(c).some(d=>String(d).toLowerCase().includes(o))):f},[_,f]),H=G.slice((y-1)*p,y*p),Z=o=>{try{return atob(o)}catch{return null}};return e.jsxs("div",{children:[M("Laboratory","create")&&e.jsx("div",{className:"mb-3 w-100",style:{display:"flex",justifyContent:"end",alignContent:"end",alignItems:"end"},children:e.jsx(A,{style:{color:"var(--color-black)",backgroundColor:"var(--color-bgcolor)"},onClick:()=>C(!0),children:"Add Receptionist"})}),e.jsxs(se,{visible:X,backdrop:"static",keyboard:!1,children:[e.jsx(ae,{children:e.jsx("h5",{children:"Receptionist Credentials"})}),e.jsx(te,{children:R?e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",R.username]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Password:"})," ",R.password]}),e.jsx("small",{className:"text-danger",children:"⚠️ Please save these credentials securely. They will not be shown again."})]}):e.jsx("p",{children:"No data available"})}),e.jsx(ie,{children:e.jsx(A,{color:"primary",onClick:()=>{Y(!1),q(null)},children:"Close"})})]}),e.jsx(je,{isVisible:U,title:"Delete receptionist",message:"Are you sure you want to delete this receptionist? This action cannot be undone.",confirmText:"Yes, Delete",cancelText:"Cancel",confirmColor:"danger",cancelColor:"secondary",onConfirm:()=>j(z),onCancel:()=>F(!1)}),O?e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx(be,{message:"Loading receptionist..."})}):S?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"50vh",color:"var(--color-black)"},children:S}):e.jsxs(Ne,{className:"mt-3",striped:!0,hover:!0,responsive:!0,children:[e.jsx(Ce,{children:e.jsxs(ee,{className:"pink-table  w-auto",children:[e.jsx(D,{children:"#"}),e.jsx(D,{children:"Photo"})," ",e.jsx(D,{children:"Name"}),e.jsx(D,{children:"Contact"}),e.jsx(D,{children:"Sex"}),e.jsx(D,{children:"Qualification"}),e.jsx(D,{children:"Date Of Joining"}),e.jsx(D,{className:"text-end",children:"Actions"})]})}),e.jsx(ye,{className:"pink-table",children:H.length>0?H.map((o,c)=>e.jsxs(ee,{children:[e.jsx(k,{children:(y-1)*p+c+1}),e.jsx(k,{children:o.profilePicture?e.jsx("img",{src:Z(o.profilePicture),alt:o.fullName,width:"40",height:"40",style:{borderRadius:"50%",objectFit:"cover",border:"1px solid var(--color-black)"}}):e.jsx("img",{src:"/assets/images/default-avatar.png",alt:"No profile",width:"40",height:"40",style:{borderRadius:"50%",objectFit:"cover",border:"1px solid var(--color-black)"}})}),e.jsx(k,{children:$(o.fullName)}),e.jsx(k,{children:$(o.contactNumber)}),e.jsx(k,{children:$(o.gender)}),e.jsx(k,{children:o.qualification||"NA"}),e.jsx(k,{children:o.dateOfJoining}),e.jsx(k,{className:"text-end",children:e.jsxs("div",{className:"d-flex justify-content-end gap-2  ",children:[M("Laboratory","read")&&e.jsx("button",{className:"actionBtn",onClick:()=>{b(o),T(!0),C(!0)},title:"View",children:e.jsx(ke,{size:18})}),M("Laboratory","update")&&e.jsx("button",{className:"actionBtn",onClick:()=>{b(o),T(!1),C(!0)},title:"Edit",children:e.jsx(we,{size:18})}),M("Laboratory","delete")&&e.jsx("button",{className:"actionBtn",onClick:()=>{J(o.id),F(!0)},title:"Delete",children:e.jsx(De,{size:18})})]})})]},o.id)):e.jsx(ee,{children:e.jsx(k,{colSpan:"9",className:"text-center",style:{color:"var(--color-black)"},children:"No receptionist found."})})})]}),!O&&e.jsx("div",{className:"d-flex justify-content-end mt-3",style:{marginRight:"40px"},children:Array.from({length:Math.ceil(G.length/p)},(o,c)=>e.jsx(A,{style:{backgroundColor:y===c+1?"var(--color-black)":"#fff",color:y===c+1?"#fff":"var(--color-black)",border:"1px solid #ccc",borderRadius:"5px",cursor:"pointer"},className:"ms-2",onClick:()=>a(c+1),children:c+1},c))}),e.jsx(Fe,{visible:W,onClose:()=>{C(!1),b(null),T(!1)},onSave:x,initialData:P,viewMode:le,receptionist:f,fetchTechs:B})]})};export{_e as default};
