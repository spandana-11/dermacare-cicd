import{r as c,_ as B,$ as T,a as F,c as z,P as N,b as ps,j as e,Q as vs,H as gs,a9 as xs,o as Le,B as ke,E as Oe,F as Ke,aa as fs,y as V,ab as js,D as Ns,ac as ys}from"./index-D-oDOyWO.js";import{X as bs}from"./index.es-CyaLuy6q.js";import{C as Ss,a as H,c as Cs}from"./index.esm-Dag7HEVz.js";/* empty css                      */import{F as As,a as Ve}from"./index-C1wl4Siq.js";import{_ as Is,f as ws,b as Ps,T as Es,u as Qs}from"./CConditionalPortal-Cy0Xk2dr.js";import{a as j,C as D}from"./CRow-C5UAjCDF.js";import{C as O,a as k}from"./CFormInput-CxOD02nI.js";import{C as qe}from"./CInputGroup-DFlVQaGa.js";import{C as He}from"./CForm-C_9ZANgI.js";import{C as Ds}from"./CInputGroupText-Bw8sjWME.js";import{c as Ts}from"./cil-search-CDkY_4k-.js";import{C as he,a as Be,b as pe}from"./CModalHeader-DCaq31xv.js";import{C as ze}from"./CModalTitle-B_oINO8I.js";import{C as ve}from"./CModalFooter-Cjr_bjNp.js";import{C as ie}from"./CFormSelect-CxLkCuzD.js";import{g as Ms}from"./DefaultLayout-CxfxLLjP.js";import"./CFormLabel-ccOuQI7Q.js";var Ge=c.createContext({}),je=c.forwardRef(function(r,n){var h=r.children,t=r.activeItemKey,d=r.alwaysOpen,g=d===void 0?!1:d,v=r.className,o=r.flush,u=B(r,["children","activeItemKey","alwaysOpen","className","flush"]),l=c.useState(t),S=l[0],A=l[1];return T.createElement("div",F({className:z("accordion",{"accordion-flush":o},v)},u,{ref:n}),T.createElement(Ge.Provider,{value:{_activeItemKey:S,alwaysOpen:g,setActiveKey:A}},h))});je.propTypes={activeItemKey:N.oneOfType([N.number,N.string]),alwaysOpen:N.bool,children:N.node,className:N.string,flush:N.bool};je.displayName="CAccordion";function fe(){return fe=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var h=arguments[n];for(var t in h)({}).hasOwnProperty.call(h,t)&&(r[t]=h[t])}return r},fe.apply(null,arguments)}function Fs(r,n){return r.classList?!!n&&r.classList.contains(n):(" "+(r.className.baseVal||r.className)+" ").indexOf(" "+n+" ")!==-1}function Rs(r,n){r.classList?r.classList.add(n):Fs(r,n)||(typeof r.className=="string"?r.className=r.className+" "+n:r.setAttribute("class",(r.className&&r.className.baseVal||"")+" "+n))}function We(r,n){return r.replace(new RegExp("(^|\\s)"+n+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function $s(r,n){r.classList?r.classList.remove(n):typeof r.className=="string"?r.className=We(r.className,n):r.setAttribute("class",We(r.className&&r.className.baseVal||"",n))}var Ls=function(n,h){return n&&h&&h.split(" ").forEach(function(t){return Rs(n,t)})},ge=function(n,h){return n&&h&&h.split(" ").forEach(function(t){return $s(n,t)})},Ne=function(r){Is(n,r);function n(){for(var t,d=arguments.length,g=new Array(d),v=0;v<d;v++)g[v]=arguments[v];return t=r.call.apply(r,[this].concat(g))||this,t.appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(o,u){var l=t.resolveArguments(o,u),S=l[0],A=l[1];t.removeClasses(S,"exit"),t.addClass(S,A?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(o,u)},t.onEntering=function(o,u){var l=t.resolveArguments(o,u),S=l[0],A=l[1],M=A?"appear":"enter";t.addClass(S,M,"active"),t.props.onEntering&&t.props.onEntering(o,u)},t.onEntered=function(o,u){var l=t.resolveArguments(o,u),S=l[0],A=l[1],M=A?"appear":"enter";t.removeClasses(S,M),t.addClass(S,M,"done"),t.props.onEntered&&t.props.onEntered(o,u)},t.onExit=function(o){var u=t.resolveArguments(o),l=u[0];t.removeClasses(l,"appear"),t.removeClasses(l,"enter"),t.addClass(l,"exit","base"),t.props.onExit&&t.props.onExit(o)},t.onExiting=function(o){var u=t.resolveArguments(o),l=u[0];t.addClass(l,"exit","active"),t.props.onExiting&&t.props.onExiting(o)},t.onExited=function(o){var u=t.resolveArguments(o),l=u[0];t.removeClasses(l,"exit"),t.addClass(l,"exit","done"),t.props.onExited&&t.props.onExited(o)},t.resolveArguments=function(o,u){return t.props.nodeRef?[t.props.nodeRef.current,o]:[o,u]},t.getClassNames=function(o){var u=t.props.classNames,l=typeof u=="string",S=l&&u?u+"-":"",A=l?""+S+o:u[o],M=l?A+"-active":u[o+"Active"],R=l?A+"-done":u[o+"Done"];return{baseClassName:A,activeClassName:M,doneClassName:R}},t}var h=n.prototype;return h.addClass=function(d,g,v){var o=this.getClassNames(g)[v+"ClassName"],u=this.getClassNames("enter"),l=u.doneClassName;g==="appear"&&v==="done"&&l&&(o+=" "+l),v==="active"&&d&&ws(d),o&&(this.appliedClasses[g][v]=o,Ls(d,o))},h.removeClasses=function(d,g){var v=this.appliedClasses[g],o=v.base,u=v.active,l=v.done;this.appliedClasses[g]={},o&&ge(d,o),u&&ge(d,u),l&&ge(d,l)},h.render=function(){var d=this.props;d.classNames;var g=Ps(d,["classNames"]);return T.createElement(Es,fe({},g,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},n}(T.Component);Ne.defaultProps={classNames:""};Ne.propTypes={};var ye=c.forwardRef(function(r,n){var h=r.children,t=r.className,d=r.horizontal,g=r.onHide,v=r.onShow,o=r.visible,u=B(r,["children","className","horizontal","onHide","onShow","visible"]),l=c.useRef(null),S=Qs(n,l),A=c.useState(),M=A[0],R=A[1],K=c.useState(),b=K[0],C=K[1],E=function(){if(v&&v(),d){l.current&&C(l.current.scrollWidth);return}l.current&&R(l.current.scrollHeight)},f=function(){if(d){C(0);return}R(0)},W=function(){if(d){l.current&&C(l.current.scrollWidth);return}l.current&&R(l.current.scrollHeight)},q=function(){if(g&&g(),d){C(0);return}R(0)},ne=function(){if(d){C(0);return}R(0)};return T.createElement(Ne,{in:o,nodeRef:l,onEntering:E,onEntered:f,onExit:W,onExiting:q,onExited:ne,timeout:350},function(J){var ce=M===0?null:{height:M},Ie=b===0?null:{width:b};return T.createElement("div",F({className:z(t,{"collapse-horizontal":d,collapsing:J==="entering"||J==="exiting","collapse show":J==="entered",collapse:J==="exited"}),style:F(F({},ce),Ie)},u,{ref:S}),h)})});ye.propTypes={children:N.node,className:N.string,horizontal:N.bool,onHide:N.func,onShow:N.func,visible:N.bool};ye.displayName="CCollapse";var be=c.createContext({}),Y=c.forwardRef(function(r,n){var h=r.children,t=r.className,d=B(r,["children","className"]),g=c.useContext(be),v=g.id,o=g.visible;return T.createElement(ye,{className:"accordion-collapse",id:v,visible:o},T.createElement("div",F({className:z("accordion-body",t)},d,{ref:n}),h))});Y.propTypes={children:N.node,className:N.string};Y.displayName="CAccordionBody";var Se=c.forwardRef(function(r,n){var h=r.children,t=r.className,d=B(r,["children","className"]),g=c.useContext(be),v=g.id,o=g.visible,u=g.setVisible;return T.createElement("button",F({type:"button",className:z("accordion-button",{collapsed:!o},t),"aria-controls":v,"aria-expanded":o,onClick:function(){return u(!o)}},d,{ref:n}),h)});Se.propTypes={children:N.node,className:N.string};Se.displayName="CAccordionButton";var Z=c.forwardRef(function(r,n){var h=r.children,t=r.className,d=B(r,["children","className"]);return T.createElement("div",F({className:z("accordion-header",t)},d,{ref:n}),T.createElement(Se,null,h))});Z.propTypes={children:N.node,className:N.string};Z.displayName="CAccordionHeader";var ee=c.forwardRef(function(r,n){var h=r.children,t=r.className,d=r.id,g=r.itemKey,v=B(r,["children","className","id","itemKey"]),o=c.useId(),u=d??o,l=c.useRef(g??u),S=c.useContext(Ge),A=S._activeItemKey,M=S.alwaysOpen,R=S.setActiveKey,K=c.useState(A===l.current),b=K[0],C=K[1];return c.useEffect(function(){!M&&b&&R(l.current)},[b]),c.useEffect(function(){C(A===l.current)},[A]),T.createElement("div",F({className:z("accordion-item",t)},v,{ref:n}),T.createElement(be.Provider,{value:{id:u,setVisible:C,visible:b}},h))});ee.propTypes={children:N.node,className:N.string,itemKey:N.oneOfType([N.number,N.string])};ee.displayName="CAccordionItem";var Ce=c.forwardRef(function(r,n){var h,t=r.children,d=r.as,g=d===void 0?"ul":d,v=r.className,o=r.flush,u=r.layout,l=B(r,["children","as","className","flush","layout"]);return T.createElement(g,F({className:z("list-group",(h={"list-group-flush":o},h["list-group-".concat(u)]=u,h),v)},l,{ref:n}),t)});Ce.propTypes={as:N.elementType,children:N.node,className:N.string,flush:N.bool,layout:N.oneOf(["horizontal","horizontal-sm","horizontal-md","horizontal-lg","horizontal-xl","horizontal-xxl"])};Ce.displayName="CListGroup";var Ae=c.forwardRef(function(r,n){var h,t=r.children,d=r.active,g=r.as,v=g===void 0?"li":g,o=r.className,u=r.disabled,l=r.color,S=B(r,["children","active","as","className","disabled","color"]),A=v==="a"||v==="button"?Ss:v;return S=F(F(F(F({},(v==="a"||v==="button")&&{active:d,disabled:u,as:v,ref:n}),d&&{"aria-current":!0}),u&&{"aria-disabled":!0}),S),T.createElement(A,F({className:z("list-group-item",(h={},h["list-group-item-".concat(l)]=l,h["list-group-item-action"]=v==="a"||v==="button",h.active=d,h.disabled=u,h),o)},S),t)});Ae.propTypes={active:N.bool,as:N.elementType,children:N.node,className:N.string,color:ps,disabled:N.bool};Ae.displayName="CListGroupItem";const xe=({title:r,qaList:n=[],setQAList:h})=>{const[t,d]=c.useState(""),[g,v]=c.useState(""),[o,u]=c.useState([]),[l,S]=c.useState("add"),A=()=>{g.trim()!==""&&(u([...o,g]),v(""))},M=b=>{u(o.filter(C=>C!==b))},R=()=>{t.trim()&&o.length>0&&(h([...n,{[t]:o}]),d(""),u([]))},K=b=>{const C=[...n];C.splice(b,1),h(C)};return c.useEffect(()=>{if(n.length>0){const b=n[n.length-1],C=Object.keys(b)[0],E=b[C];d(C),u(E)}},[n]),c.useEffect(()=>{if((l==="edit"||l==="view")&&n.length>0){const b=n[n.length-1],C=Object.keys(b)[0],E=b[C];d(C),u(E)}},[n,l]),e.jsxs(j,{md:12,className:"mt-3",children:[e.jsxs("label",{className:"mb-2",children:["Question ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(O,{placeholder:"Enter your question",value:t,onChange:b=>d(b.target.value)}),e.jsxs("label",{className:"mt-3",children:["Answers ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(qe,{className:"mb-2",children:[e.jsx(O,{placeholder:"Enter answer",value:g,onChange:b=>v(b.target.value)}),e.jsx(H,{color:"success",onClick:A,className:"text-white",children:e.jsx(As,{})})]}),o.length>0&&e.jsx(Ce,{className:"mb-3",children:o.map((b,C)=>e.jsxs(Ae,{className:"d-flex justify-content-between align-items-center",children:[b,e.jsx(Ve,{onClick:()=>M(b),style:{color:"gray",cursor:"pointer"}})]},C))}),e.jsx(H,{color:"info",className:"mb-3 text-white",onClick:R,children:"Save Q&A"}),n.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h6",{className:"mt-4",children:"Saved Questions & Answers"}),n.map((b,C)=>{const E=Object.keys(b)[0],f=b[E];return e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:E}),e.jsx("ul",{children:f.map((W,q)=>e.jsx("li",{children:W},q))}),e.jsx(Ve,{onClick:()=>K(C),style:{color:"red",cursor:"pointer"}})]},C)})]})]})},ks=({preQAList:r,setPreQAList:n,procedureQAList:h,setProcedureQAList:t,postQAList:d,setPostQAList:g})=>e.jsxs(je,{default:!0,children:[e.jsxs(ee,{itemKey:1,children:[e.jsx(Z,{children:"Pre-Procedure"}),e.jsx(Y,{children:e.jsx(xe,{title:"Pre-Procedure",qaList:r,setQAList:n})})]}),e.jsxs(ee,{itemKey:2,children:[e.jsx(Z,{children:"Procedure"}),e.jsx(Y,{children:e.jsx(xe,{title:"Procedure",qaList:h,setQAList:t})})]}),e.jsxs(ee,{itemKey:3,children:[e.jsx(Z,{children:"Post-Procedure"}),e.jsx(Y,{children:e.jsx(xe,{title:"Post-Procedure",qaList:d,setQAList:g})})]})]}),vr=()=>{const[r,n]=c.useState(""),[h,t]=c.useState([]),[d,g]=c.useState([]),[v,o]=c.useState([]),[u,l]=c.useState(!1),[S,A]=c.useState(null),[M,R]=c.useState(""),[K,b]=c.useState([]),[C,E]=c.useState(!1),[f,W]=c.useState(null),[q,ne]=c.useState(!1),[J,ce]=c.useState(""),[Ie,Os]=c.useState(""),[Ks,Ue]=c.useState([]),[Vs,oe]=c.useState([]),[we,le]=c.useState([]),[_,Pe]=c.useState([]),[Je,de]=c.useState(""),[_e,Xe]=c.useState(""),[Ee,Hs]=c.useState(null),[se,Ye]=c.useState({serviceImage:"",viewImage:"",subServiceName:"",serviceName:"",serviceImageFile:null}),[Bs,zs]=c.useState([]),[Ws,qs]=c.useState([]),[Gs,Us]=c.useState([]);let Qe=[];try{typeof h.descriptionQA=="string"?Qe=JSON.parse(h.descriptionQA):Qe=h.descriptionQA||[]}catch(s){console.error("Invalid descriptionQA format:",s)}const[a,Q]=c.useState({categoryName:"",categoryId:"",serviceName:"",subServiceName:"",description:"",procedureQA:[],preProcedureQA:[],postProcedureQA:[]}),[X,De]=c.useState("add"),Ze=()=>{De("add"),oe([]),Ue([]),ce(""),de(""),Q({categoryName:"",categoryId:"",serviceName:"",serviceId:"",subServiceId:"",subServiceName:"",price:"",discount:0,minTime:"",taxPercentage:0,status:"",serviceImage:"",serviceImageFile:null,viewImage:"",viewDescription:"",platformFeePercentage:0,descriptionQA:[]}),E(!0)},es=async s=>{var $e;console.log(s.subServiceId),Xe(s.subServiceId),De("edit"),E(!0);const i=d.find($=>$.categoryName===s.categoryName),m=(i==null?void 0:i.categoryId)||"";let p=[];try{p=(($e=(await Le.get(`${ke}/${Oe}/${m}`)).data)==null?void 0:$e.data)||[],le(p)}catch($){console.error("Error fetching service list:",$)}const x=p.find($=>$.serviceName===s.serviceName),y=(x==null?void 0:x.serviceId)||"";let I=[];if(y)try{const U=(await Ke(y)).data;Array.isArray(U)?I=U.flatMap(hs=>hs.subServices||[]):U!=null&&U.subServices&&(I=U.subServices)}catch($){console.error("Error fetching subservices:",$)}Pe({subServices:I});const P=I.find($=>$.subServiceName===s.subServiceName),L=(P==null?void 0:P.subServiceId)||"",G=(P==null?void 0:P.subServiceName)||"";de(L);const Re=Array.isArray(s.procedureQA)?s.procedureQA:JSON.parse(s.procedureQA||"[]"),ae=s.serviceImage||"";ae.startsWith("data:")||`${ae}`,Q({subServiceId:L,subServiceName:G,serviceName:s.serviceName||"",serviceId:y,categoryName:s.categoryName||"",categoryId:m||"",price:s.price||"",discount:s.discountPercentage||0,taxPercentage:s.taxPercentage||0,minTime:s.minTime||"",serviceImage:ae,serviceImageFile:null,status:s.status||"",viewDescription:s.viewDescription||"",platformFeePercentage:s.platformFeePercentage||0,viewImage:s.viewImage||"",procedureQA:Re,preProcedureQA:[],postProcedureQA:[]}),oe(Re)},[ss,me]=c.useState(!1),[Te,rs]=c.useState(null),[w,ue]=c.useState({subServiceName:"",serviceName:"",serviceId:"",categoryName:"",price:"",status:"",taxPercentage:"",descriptionQA:"",answers:"",minTime:"",discount:"",viewDescription:"",serviceImage:"",bannerImage:""}),[Js,_s]=c.useState({}),re=async()=>{l(!0),A(null);try{const s=await gs();if(s.data&&Array.isArray(s.data)){const m=s.data.map(p=>({categoryId:p.categoryId,categoryName:p.categoryName}));g(s.data)}else throw new Error("Invalid category data format");const i=localStorage.getItem("HospitalId");if(i){const m=await xs(i);Array.isArray(m)?t(m):(t([]),console.warn("No subservices found for this hospital."))}else console.warn("No hospitalId found in localStorage."),t([])}catch(s){console.error("Error fetching data:",s),A("Failed to fetch data. Please try again later.")}finally{l(!1)}};c.useEffect(()=>{re()},[]),c.useEffect(()=>{if(q&&(se!=null&&se.descriptionQA)&&typeof se.descriptionQA=="string")try{Ye(s=>({...s,descriptionQA:JSON.parse(s.descriptionQA)}))}catch{console.error("Invalid QA format")}},[q]),c.useEffect(()=>{(()=>{const i=r.toLowerCase().trim();if(!i){o([]);return}const m=h.filter(p=>{var P,L,G;const x=(P=p.subServiceName)==null?void 0:P.toLowerCase().startsWith(i),y=(L=p.serviceName)==null?void 0:L.toLowerCase().startsWith(i),I=(G=p.categoryName)==null?void 0:G.toLowerCase().startsWith(i);return x||y||I});o(m)})()},[r,h]);const ts=[{name:"S.No",selector:(s,i)=>i+1,width:"70px",sortable:!1},{name:"Procedure Name",selector:s=>s.subServiceName,sortable:!0,width:"230px"},{name:"Service Name",selector:s=>s.serviceName,width:"230px"},{name:"Category Name",selector:s=>s.categoryName,width:"180px"},{name:"Price",selector:s=>s.price,width:"100px"},{name:"Actions",cell:s=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"250px"},children:[e.jsx("div",{color:"primary",onClick:()=>W(s),style:{marginRight:"5px",width:"50px",color:"green"},children:"View"}),e.jsx("div",{color:"primary",onClick:()=>es(s),style:{marginRight:"5px",width:"50px",color:"blue"},children:"Edit"}),e.jsx("div",{color:"danger",onClick:()=>ls(s),style:{width:"50px",color:"red"},children:"Delete"}),e.jsx(as,{isVisible:ss,message:"Are you sure you want to delete this service?",onConfirm:ds,onCancel:ms})]}),width:"150px",headerStyle:{textAlign:"center"}}],as=({isVisible:s,message:i,onConfirm:m,onCancel:p})=>e.jsxs(he,{visible:s,onClose:p,backdrop:!1,children:[e.jsx(Ms,{style:{marginLeft:"200px"},children:" !Alert"}),e.jsx(pe,{style:{textAlign:"center"},children:i}),e.jsxs(ve,{children:[e.jsx(H,{color:"secondary",onClick:p,children:"Cancel"}),e.jsx(H,{color:"danger",onClick:m,children:"Confirm"})]})]}),is=()=>{const s={};return a.serviceName||(s.serviceName="Service name is required."),a.categoryName||(s.categoryName="Category is required."),a.price?isNaN(a.price)?s.price="price must be a valid number.":parseFloat(a.price)<0&&(s.price="price cannot be a negative number."):s.price="price is required.",a.status||(s.status="Status is required."),!a.discount&&a.discount!==0?s.discount="Discount is required.":parseFloat(a.discount)<0&&(s.discount="Discount cannot be a negative number."),!a.taxPercentage&&a.taxPercentage!==0?s.taxPercentage="taxPercentage is required.":parseFloat(a.taxPercentage)<0&&(s.taxPercentage="taxPercentage cannot be a negative number."),!a.minTime||isNaN(a.minTime)?s.minTime="Minimum time is required and must be a Minutes.":parseFloat(a.minTime)<=0&&(s.minTime="Minimum time must be greater than zero."),a.viewDescription||(s.viewDescription="View description is Required."),a.serviceImage||(console.log("Service Image in Form:",a.serviceImage),s.serviceImage="Please upload a service image."),a.categoryId||(s.categoryId="Please select a valid category."),ue(s),Object.keys(s).length===0},ns=async()=>{var m,p,x,y;console.log("iam from handleAddSubService calling");const s=await Me(a.serviceImageFile),i=(s==null?void 0:s.split(",")[1])||"";if(console.log("Calling validateForm..."),!is()){V.error("Validation failed",{position:"top-right"}),console.log("Validation failed"),E(!0);return}E(!1);try{console.log("iam from try calling");const I={hospitalId:localStorage.getItem("HospitalId"),subServiceName:a.subServiceName,subServiceId:a.subServiceId,serviceId:a.serviceId,serviceName:a.serviceName,categoryName:a.categoryName,categoryId:a.categoryId,price:a.price,discountPercentage:a.discount,taxPercentage:a.taxPercentage,minTime:a.minTime,status:a.status,subServiceImage:i,procedureQA:a.procedureQA,preProcedureQA:a.preProcedureQA,postProcedureQA:a.postProcedureQA,viewDescription:a.viewDescription,platformFeePercentage:a.platformFeePercentage,discountAmount:a.discount,taxAmount:a.taxAmount,discountedCost:a.discountedCost,clinicPay:a.clinicPay,finalCost:a.finalCost};if(console.log(I),console.log(a.subServiceId),!/^[a-f\d]{24}$/i.test(a.subServiceId)){V.error("SubService ID is invalid. Please re-select sub-service.",{position:"top-right"});return}console.log(I);const P=await js(I,a.subServiceId);P.status===201?(V.success(P.data.message,{position:"top-right"}),re(),Ns()):P.status===500&&V.error((p=(m=S.response)==null?void 0:m.data)==null?void 0:p.message,{position:"top-right"})}catch(I){console.error("Error response:",I.response),V.error((y=(x=I.response)==null?void 0:x.data)==null?void 0:y.message,{position:"top-right"})}Q({subServiceName:"",serviceName:"",serviceid:"",categoryName:"",price:"",discount:0,minTime:"",taxPercentage:0,status:"",serviceImage:"",viewImage:"",viewDescription:"",categoryId:""}),oe([])},cs=s=>{const i=parseInt(s,10);if(isNaN(i))return"Invalid time";if(i<60)return`${i} min`;const m=Math.floor(i/60),p=i%60;return p===0?`${m} hour${m>1?"s":""}`:`${m} hour${m>1?"s":""} ${p} min`},os=async()=>{var s;try{const i=localStorage.getItem("HospitalId");let m="";a.serviceImageFile?m=(await Me(a.serviceImageFile)).split(",")[1]:(s=a.serviceImage)!=null&&s.startsWith("data:")?m=a.serviceImage.split(",")[1]:m=a.serviceImage||"";const p=a.price>0?Number(a.price):0,x={hospitalId:i,subServiceName:a.subServiceName||"",viewDescription:a.viewDescription||"",status:a.status||"",minTime:a.minTime||"",descriptionQA:Array.isArray(a.descriptionQA)?a.descriptionQA:[],price:p,discountPercentage:a.discount||0,taxPercentage:a.taxPercentage||0,platformFeePercentage:a.platformFeePercentage||0,subServiceImage:m};console.log("Payload for updateSubServiceData:",x);const y=await fs(_e,i,x);V.success("SubService updated successfully!",{position:"top-right"}),ne(!1),E(!1),re()}catch(i){console.error("Update failed:",i),V.error("Error updating service.",{position:"top-right"})}},Me=s=>new Promise((i,m)=>{const p=new FileReader;p.readAsDataURL(s),p.onload=()=>i(p.result),p.onerror=x=>m(x)}),ls=async s=>{console.log(s),rs(s.subServiceId),me(!0)},ds=async()=>{console.log(Te);const s=localStorage.getItem("HospitalId");try{const i=await ys(Te,s);console.log("Service deleted:",i),V.success("SubService deleted successfully!",{position:"top-right"}),re()}catch(i){console.error("Error deleting service:",i)}me(!1)},ms=()=>{me(!1),console.log("Service deletion canceled")},te=s=>{const{name:i,value:m}=s.target;if(i==="categoryName"){const p=d.find(x=>x.categoryName===m);Q(x=>({...x,[i]:m,categoryId:p?p.categoryId:""}))}else Q(p=>({...p,[i]:m}));ue({...w,[i]:""})},us=()=>{Q({serviceName:"",categoryName:"",price:"",discount:0,taxPercentage:0,minTime:"",status:"",serviceImage:"",viewImage:"",viewDescription:"",categoryId:""}),E(!1),ue({})},Fe=async s=>{var p;const{name:i,value:m}=s.target;if(i==="categoryName"){const x=d.find(y=>y.categoryId===m);Q(y=>({...y,categoryName:(x==null?void 0:x.categoryName)||"",categoryId:m,serviceName:"",serviceId:""}));try{const I=((p=(await Le.get(`${ke}/${Oe}/${m}`)).data)==null?void 0:p.data)||[];le(I)}catch(y){console.error("Failed to fetch services:",y),le([])}}else if(i==="serviceName"){const x=we.find(I=>I.serviceName===m),y=(x==null?void 0:x.serviceId)||"";if(Q(I=>({...I,serviceName:m,serviceId:y})),y){const P=(await Ke(y)).data;let L=[];Array.isArray(P)?L=P.flatMap(G=>G.subServices||[]):P&&P.subServices&&(L=P.subServices),Pe({subServices:L})}}else Q(x=>({...x,[i]:m}))};return e.jsxs("div",{style:{overflow:"hidden"},children:[e.jsx(vs,{}),e.jsx("div",{children:e.jsxs(He,{className:"d-flex justify-content-end mb-3",children:[e.jsxs(qe,{className:"mb-3",style:{marginRight:"20px",width:"400px"},children:[e.jsx(O,{type:"text",placeholder:"Search by ServiceName, Category",value:r,onChange:s=>n(s.target.value),style:{height:"40px"}}),e.jsx(Ds,{style:{height:"40px"},children:e.jsx(Cs,{icon:Ts})})]}),e.jsx(H,{color:"primary",style:{height:"40px"},onClick:()=>Ze(),children:"Add Procedure Details"})]})}),f&&e.jsxs(he,{visible:!!f,onClose:()=>W(null),size:"xl",children:[e.jsx(Be,{children:e.jsx(ze,{className:"w-100 text-center text-primary fs-4",children:"Procedure Details"})}),e.jsxs(pe,{children:[e.jsxs(D,{className:"mb-3",children:[e.jsxs(j,{sm:6,children:[e.jsx("strong",{children:"Procedure Name:"}),e.jsx("div",{children:f.subServiceName})]}),e.jsxs(j,{sm:6,children:[e.jsx("strong",{children:"Procedure ID:"}),e.jsx("div",{children:f.subServiceId})]})]}),e.jsxs(D,{className:"mb-3",children:[e.jsxs(j,{sm:6,children:[e.jsx("strong",{children:"Service Name:"}),e.jsx("div",{children:f.serviceName})]}),e.jsxs(j,{sm:6,children:[e.jsx("strong",{children:"Service Id:"}),e.jsx("div",{children:f.serviceId})]})]}),e.jsxs(D,{className:"mb-3",children:[e.jsxs(j,{sm:6,children:[e.jsx("strong",{children:"Category Name:"}),e.jsx("div",{children:f.categoryName})]}),e.jsxs(j,{sm:6,children:[e.jsx("strong",{children:"Category Id:"}),e.jsx("div",{children:f.categoryId})]})]}),e.jsx(D,{className:"mb-3",children:e.jsxs(j,{sm:6,children:[e.jsx("strong",{children:"Status:"}),e.jsx("div",{children:f.status})]})}),e.jsx("hr",{}),e.jsxs(D,{className:"mb-3",children:[e.jsxs(j,{sm:4,children:[e.jsx("strong",{children:"Price:"}),e.jsxs("div",{children:["₹ ",Math.round(f.price)]})]}),e.jsxs(j,{sm:4,children:[e.jsx("strong",{children:"Discount %:"}),e.jsxs("div",{children:[Math.round(f.discountPercentage),"%"]})]}),e.jsxs(j,{sm:4,children:[e.jsx("strong",{children:"Discount Amount:"}),e.jsxs("div",{children:["₹ ",Math.round(f.discountAmount)]})]})]}),e.jsxs(D,{className:"mb-3",children:[e.jsxs(j,{sm:4,children:[e.jsx("strong",{children:"Discounted Cost:"}),e.jsxs("div",{children:["₹ ",Math.round(f.discountedCost)]})]}),e.jsxs(j,{sm:4,children:[e.jsx("strong",{children:"Tax %:"}),e.jsxs("div",{children:[Math.round(f.taxPercentage),"%"]})]}),e.jsxs(j,{sm:4,children:[e.jsx("strong",{children:"Tax Amount:"}),e.jsxs("div",{children:["₹ ",Math.round(f.taxAmount)]})]})]}),e.jsxs(D,{className:"mb-3",children:[e.jsxs(j,{sm:4,children:[e.jsx("strong",{children:"Platform Fee %:"}),e.jsxs("div",{children:[Math.round(f.platformFeePercentage),"%"]})]}),e.jsxs(j,{sm:4,children:[e.jsx("strong",{children:"Platform Fee:"}),e.jsxs("div",{children:["₹ ",Math.round(f.platformFee)]})]}),e.jsxs(j,{sm:4,children:[e.jsx("strong",{children:"Clinic Pay:"}),e.jsxs("div",{children:["₹ ",Math.round(f.clinicPay)]})]})]}),e.jsxs(D,{className:"mb-3",children:[e.jsxs(j,{sm:4,children:[e.jsx("strong",{children:"Final Cost:"}),e.jsxs("div",{children:["₹ ",Math.round(f.finalCost)]})]}),e.jsxs(j,{sm:4,children:[e.jsx("strong",{children:"Service Time:"}),e.jsx("div",{children:cs(f.minTime)})]})]}),e.jsx("hr",{}),e.jsx(D,{className:"mb-3",children:e.jsxs(j,{sm:12,children:[e.jsx("strong",{className:"mb-3",children:"Pre-Procedure QA:"}),Array.isArray(f.preProcedureQA)&&f.preProcedureQA.length>0?f.preProcedureQA.map((s,i)=>{const m=Object.keys(s)[0],p=s[m];return e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:m}),e.jsx("ul",{children:p.map((x,y)=>e.jsx("li",{children:x},y))})]},i)}):e.jsx("div",{children:"No Pre-Procedure Q&A available"})]})}),e.jsx(D,{className:"mb-3",children:e.jsxs(j,{sm:12,children:[e.jsx("strong",{className:"mb-3",children:"Procedure QA:"}),Array.isArray(f.procedureQA)&&f.procedureQA.length>0?f.procedureQA.map((s,i)=>{const m=Object.keys(s)[0],p=s[m];return e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:m}),e.jsx("ul",{children:p.map((x,y)=>e.jsx("li",{children:x},y))})]},i)}):e.jsx("div",{children:"No Procedure Q&A available"})]})}),e.jsx(D,{className:"mb-3",children:e.jsxs(j,{sm:12,children:[e.jsx("strong",{className:"mb-3",children:"Post-Procedure QA:"}),Array.isArray(f.postProcedureQA)&&f.postProcedureQA.length>0?f.postProcedureQA.map((s,i)=>{const m=Object.keys(s)[0],p=s[m];return e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:m}),e.jsx("ul",{children:p.map((x,y)=>e.jsx("li",{children:x},y))})]},i)}):e.jsx("div",{children:"No Post-Procedure Q&A available"})]})}),e.jsx("hr",{}),e.jsxs(D,{children:[e.jsxs(j,{sm:6,children:[e.jsx("strong",{children:"Service Image:"}),f.subServiceImage?e.jsxs("div",{className:"mt-2",children:[e.jsx("img",{src:`data:image/png;base64,${f.subServiceImage}`,alt:"Service",style:{width:"100%",maxWidth:"250px",borderRadius:"8px"}}),Ee&&e.jsx("img",{src:Ee,alt:"Preview",height:"80",className:"mt-2"})]}):e.jsx("div",{children:"No image available"})]}),e.jsxs(j,{sm:6,children:[e.jsx("strong",{children:"View Description:"}),e.jsx("div",{children:f.viewDescription})]})]})]}),e.jsx(ve,{children:e.jsx(H,{color:"secondary",onClick:()=>W(null),children:"Close"})})]}),e.jsxs(he,{visible:C,onClose:()=>E(!1),size:"xl",backdrop:"static",children:[e.jsx(Be,{children:e.jsx(ze,{style:{textAlign:"center",width:"100%"},children:X==="edit"?"Edit Procedure Details":"Add New Procedure Details"})}),e.jsx(pe,{children:e.jsxs(He,{children:[e.jsxs(D,{className:"mb-4",children:[e.jsxs(j,{md:6,children:[e.jsxs("h6",{children:["Category Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(ie,{value:a.categoryId||"",onChange:Fe,"aria-label":"Select Category",name:"categoryName",disabled:X==="edit",children:[e.jsx("option",{value:"",children:"Select a Category"}),d==null?void 0:d.map(s=>e.jsx("option",{value:s.categoryId,children:s.categoryName},s.categoryId))]}),w.categoryName&&e.jsx(k,{className:"text-danger",children:w.categoryName})]}),e.jsxs(j,{md:6,children:[e.jsxs("h6",{children:["Service Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(ie,{name:"serviceName",value:a.serviceName||"",onChange:Fe,disabled:X==="edit",children:[e.jsx("option",{value:"",children:"Select Service"}),we.map(s=>e.jsx("option",{value:s.serviceName,children:s.serviceName},s.serviceId))]}),w.serviceName&&e.jsx(k,{className:"text-danger",children:w.serviceName})]})]}),e.jsxs(D,{className:"mb-4",children:[e.jsxs(j,{md:6,children:[e.jsxs("h6",{children:["Procedure Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(ie,{name:"subServiceId",value:Je,onChange:s=>{var p;const i=s.target.value;de(i);const m=(p=_==null?void 0:_.subServices)==null?void 0:p.find(x=>x.subServiceId===i);Q(x=>({...x,subServiceId:i,subServiceName:(m==null?void 0:m.subServiceName)||""}))},children:[e.jsx("option",{value:"",children:"Select Sub Service"}),Array.isArray(_.subServices)&&_.subServices.map(s=>e.jsx("option",{value:s.subServiceId,children:s.subServiceName},s.subServiceId))]}),w.subServiceName&&e.jsx(k,{className:"text-danger",children:w.subServiceName})]}),e.jsxs(j,{md:6,children:[e.jsxs("h6",{children:["View Description ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(O,{type:"text",placeholder:"View Description",value:a.viewDescription||"",name:"viewDescription",onChange:te,maxLength:100}),w.viewDescription&&e.jsx(k,{className:"text-danger",children:w.viewDescription})]})]}),e.jsxs(D,{className:"mb-4",children:[e.jsxs(j,{md:6,children:[e.jsxs("h6",{children:["Status ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(ie,{value:a.status||"",onChange:te,name:"status",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"InActive",children:"Inactive"})]}),w.status&&e.jsx(k,{className:"text-danger",children:w.status})]}),e.jsxs(j,{md:6,children:[e.jsxs("h6",{children:["Price ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(O,{type:"number",value:a.price||"",onChange:s=>Q(i=>({...i,price:s.target.value}))}),w.price&&e.jsx(k,{className:"text-danger",children:w.price})]})]}),e.jsxs(D,{className:"mb-4",children:[e.jsxs(j,{md:4,children:[e.jsxs("h6",{children:["Discount % ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(O,{type:"number",placeholder:"Discount",value:a.discount||"",name:"discount",onChange:te,min:1,onKeyDown:s=>{(s.key==="-"||s.key==="e")&&s.preventDefault()}}),w.discount&&e.jsx(k,{className:"text-danger",children:w.discount})]}),e.jsxs(j,{md:4,children:[e.jsxs("h6",{children:["TaxPercentage % ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(O,{type:"number",placeholder:"Tax Percentage",value:a.taxPercentage||"",name:"taxPercentage",onChange:te,min:1,onKeyDown:s=>{(s.key==="-"||s.key==="e")&&s.preventDefault()}}),w.taxPercentage&&e.jsx(k,{className:"text-danger",children:w.taxPercentage})]}),e.jsx(j,{children:e.jsxs("div",{className:"mb-4",children:[e.jsxs("h6",{children:["Min Time ",e.jsx("span",{className:"text-danger",children:"*"})]})," ",e.jsx(O,{type:"number",name:"minTime",value:a.minTime||"",onChange:s=>Q({...a,minTime:s.target.value}),placeholder:"Must be in Minutes"}),w.minTime&&e.jsx(k,{className:"text-danger",children:w.minTime})]})})]}),e.jsxs(j,{md:12,children:[e.jsxs("h6",{children:["Service Image ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(O,{type:"file",accept:"image/*",onChange:s=>{const i=s.target.files[0];if(i){const m=new FileReader;m.onloadend=()=>{var x;const p=((x=m.result)==null?void 0:x.split(",")[1])||"";Q(y=>({...y,serviceImage:p,serviceImageFile:i}))},m.readAsDataURL(i)}}}),(a==null?void 0:a.serviceImage)&&e.jsx("img",{src:a.serviceImage.startsWith("data:")?a.serviceImage:`data:image/jpeg;base64,${a.serviceImage}`,alt:"Preview",style:{width:100,height:100,marginTop:10}})]}),e.jsx("h6",{className:"m-3",children:"Procedure (Optional)"}),e.jsx(ks,{preQAList:a.preProcedureQA,setPreQAList:s=>Q(i=>({...i,preProcedureQA:s})),procedureQAList:a.procedureQA,setProcedureQAList:s=>Q(i=>({...i,procedureQA:s})),postQAList:a.postProcedureQA,setPostQAList:s=>Q(i=>({...i,postProcedureQA:s}))})]})}),e.jsxs(ve,{children:[e.jsx(H,{color:"secondary",onClick:us,children:"Cancel"}),e.jsx(H,{color:"primary",onClick:X==="edit"?os:ns,children:X==="edit"?"Update":"Add"})]})]}),u?e.jsx("div",{style:{display:"flex",justifyContent:"center",height:"300px",fontSize:"1.5rem"},children:"Loading..."}):S?e.jsx("div",{style:{display:"flex",justifyContent:"center",height:"300px",fontSize:"1.5rem"},children:S}):e.jsx(bs,{columns:ts,data:v.length>0?v:h,pagination:!0,highlightOnHover:!0,pointerOnHover:!0})]})};export{vr as default};
