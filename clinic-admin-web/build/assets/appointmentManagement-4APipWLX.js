import{r as n,h as H,j as e}from"./index-Bbof3Raq.js";import{G as P}from"./appointmentAPI-CNP23f_7.js";import{C as T}from"./CFormCheck-BcXq__90.js";import{a as S}from"./index.esm-DU0vhm2R.js";import{C as L,a as M,b as m,c as a,d as R,e as o}from"./CTable-DrFMuIJT.js";import{j as z}from"./DefaultLayout-BA9RlpQB.js";import"./CFormLabel-siHnfzPm.js";import"./CConditionalPortal-Brqyb-aa.js";import"./cil-user-Ddrdy7PS.js";const se=()=>{const[G,V]=n.useState(null),[_,k]=n.useState([]),[U,A]=n.useState([]),[f,N]=n.useState([]),[q,w]=n.useState([]),[J,I]=n.useState([]),[p,h]=n.useState([]),[c,x]=n.useState([]),[r,j]=n.useState([]),[u,y]=n.useState(1),[D,v]=n.useState(!0),C=7,F=H(),$=async()=>{try{const t=localStorage.getItem("HospitalId");if(console.log("Hospital ID from localStorage:",t),!t){h([]),v(!1);return}const s=await P(t);console.log("Appointments for this Hospital:",s),s!=null&&s.data?h(s.data):(console.warn("No data returned for Hospital ID:",t),h([]))}catch(t){console.error("Failed to fetch appointments:",t),h([])}finally{v(!1)}};n.useEffect(()=>{$()},[]),n.useEffect(()=>{let t=[...p];console.log("Initial bookings:",t);const s=l=>l==null?void 0:l.toLowerCase().trim(),i={"Service & Treatment":"services & treatments","Tele Consultation":"Tele consultation","In-clinic":"in-clinic consultation"};if(r.length>0&&(t=t.filter(l=>r.some(d=>s(d)===s(l.status))),console.log("After status filter:",t)),c.length===1){const l=c[0];if(l==="Tele Consultation")t=t.filter(d=>s(d.consultationType)==="tele consultation"||s(d.consultationType)==="online consultation"),console.log(`After ${l} filter:`,t);else{const d=i[l];d&&(t=t.filter(E=>s(E.consultationType)===d),console.log(`After ${l} filter:`,t))}}N(t),y(1)},[p,c,r]),n.useEffect(()=>{const t=[...new Set(p.map(i=>i.subServiceName).filter(Boolean))],s=[...new Set(p.map(i=>i.consultationType).filter(Boolean))];w(t),I(s),console.log("Available Consultation Types:",s)},[p]),n.useEffect(()=>{window.scrollTo(0,0)},[u]);const B=f.slice((u-1)*C,u*C),g=t=>{c.includes(t)?x([]):x([t])},b=t=>{const s=t.target.value;r.includes(s)?j([]):j([s])};return e.jsx("div",{style:{overflow:"hidden"},children:e.jsxs("div",{className:"container mt-4",children:[e.jsx("h5",{children:"Appointments"}),e.jsxs("div",{className:"d-flex gap-2 mb-3",children:[e.jsx("button",{onClick:()=>g("Service & Treatment"),className:`btn ${c.includes("Service & Treatment")?"btn-dark":"btn-outline-dark"}`,children:"Service & Treatment"}),e.jsx("button",{onClick:()=>g("In-clinic"),className:`btn ${c.includes("In-clinic")?"btn-dark":"btn-outline-dark"}`,children:"In-Clinic Consultation"}),e.jsx("button",{onClick:()=>g("Tele Consultation"),className:`btn ${c.includes("Tele Consultation")?"btn-dark":"btn-outline-dark"}`,children:"Tele Consultation"})]}),e.jsxs("div",{className:"mb-3 d-flex justify-content-between align-items-center flex-wrap gap-2",children:[e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx(T,{label:"Active",value:"Active",onChange:b,checked:r.includes("Active")}),e.jsx(T,{label:"Completed",value:"Completed",onChange:b,checked:r.includes("Completed")}),e.jsx(T,{label:"Confirmed",value:"Confirmed",onChange:b,checked:r.includes("Confirmed")})]}),e.jsx(S,{color:"secondary",onClick:()=>{k([]),A([]),x([]),j([])},children:"Reset Filters"})]}),e.jsxs(L,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(M,{children:e.jsxs(m,{children:[e.jsx(a,{children:"S.No"}),e.jsx(a,{children:"Patient File_ID"}),e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Doctor Name"}),e.jsx(a,{children:"Consultation Type"}),e.jsx(a,{children:"Date"}),e.jsx(a,{children:"Time"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Action"})]})}),e.jsx(R,{children:D?e.jsx(m,{children:e.jsx(o,{colSpan:"9",className:"text-center text-primary fw-bold",children:"Loading appointments..."})}):Array.isArray(f)&&f.length>0?B.map((t,s)=>{var i;return e.jsxs(m,{children:[e.jsx(o,{children:s+1}),e.jsx(o,{children:t.patientId}),e.jsx(o,{children:t.name}),e.jsx(o,{children:t.doctorName}),e.jsx(o,{children:t.consultationType}),e.jsxs(o,{children:[t.sele?`${t.sele} `:"",t.serviceDate]}),e.jsx(o,{children:t.slot||t.servicetime}),e.jsx(o,{children:e.jsx(z,{color:"info",children:(i=t.status)==null?void 0:i.split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")})}),e.jsx(o,{children:e.jsx(S,{color:"info",size:"sm",onClick:()=>F(`/appointmentDetails/${t.bookingId}`,{state:{appointment:t}}),children:"View"})})]},`${t.id}-${s}`)}):e.jsx(m,{children:e.jsx(o,{colSpan:"9",className:"text-center text-danger fw-bold",children:"No appointments found."})})})]}),e.jsx("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end"},children:Array.from({length:Math.ceil(f.length/C)},(t,s)=>e.jsx("button",{onClick:()=>y(s+1),style:{margin:"0 5px",padding:"5px 10px",backgroundColor:u===s+1?"#007bff":"#fff",color:u===s+1?"#fff":"#000",border:"1px solid #ccc",borderRadius:"5px"},children:s+1},s))})]})})};export{se as default};
