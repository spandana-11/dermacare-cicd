import{r as n,u as E,j as t}from"./index-D0zCbO2O.js";import{A as B}from"./appointmentAPI-Dbze5yzr.js";import{L as H}from"./loader-CfcsqQLc.js";import{C as S}from"./CFormCheck-CXwQ8RHT.js";import{b as T}from"./index.esm-CTRZmI6a.js";import{C as L,a as R,b as g,c,d as $,e as a}from"./CTable-BUHt29dN.js";import"./CFormLabel-CDfh8m4I.js";import"./CNavItem-B31luXr5.js";const le=()=>{const[v,y]=n.useState([]),[k,x]=n.useState(!0),[r,j]=n.useState([]),[z,M]=n.useState([]),I=E(),[d,u]=n.useState([]),[i,m]=n.useState([]),[P,V]=n.useState(1),[X,N]=n.useState([]),[p,q]=n.useState([]),[G,w]=n.useState([]),[J,K]=n.useState([]),[O,Q]=n.useState([]),[U,A]=n.useState(null),[C,W]=n.useState(null),F={"Service & Treatment":"services & treatments","Tele Consultation":"tele consultation","In-clinic":"in-clinic consultation"},h=async e=>{try{const s=await B();if(s&&s.data){const o=e?s.data.filter(f=>l(f.clinicId)===l(e)):s.data;j(o||[]),x(!1)}}catch(s){console.error("Failed to fetch appointments:",s),j([]),x(!1)}};n.useEffect(()=>{const e=localStorage.getItem("HospitalId");e?(A(e),h(e)):(console.warn("No HospitalId found in localStorage. Displaying all relevant appointments."),h(null))},[]);const b=e=>{const s=e.target.value;i.includes(s)?m([]):m([s])};n.useEffect(()=>{let e=r;if(e=e.filter(s=>["completed","in-progress","active"].includes(l(s.status))),i.length>0&&(e=e.filter(s=>{const o=l(s.status);return i.includes("Completed")?o==="completed":i.includes("Active")?o==="active"||o==="in-progress":!0})),d.length===1){const s=d[0];if(s==="Tele Consultation")e=e.filter(o=>l(o.consultationType)==="tele consultation"||l(o.consultationType)==="online consultation");else{const o=F[s];o&&(e=e.filter(f=>l(f.consultationType)===o))}}y(e)},[r,d,i]),n.useEffect(()=>{const e=[...new Set(r.map(o=>o.servicename).filter(Boolean))],s=[...new Set(r.map(o=>o.consultationType).filter(Boolean))];N(e),w(s),console.log("Available Consultation Types:",s)},[r]);const D=e=>{d.includes(e)?u([]):u([e])};n.useEffect(()=>{const e=localStorage.getItem("HospitalId");e?h(e):console.warn("No HospitalId in localStorage")},[]);const l=e=>e==null?void 0:e.toLowerCase().trim();return t.jsx("div",{style:{overflowX:"auto"},children:t.jsxs("div",{className:"container  ",children:[t.jsx("h5",{className:"mb-3",children:"Completed Appointments"}),t.jsx("div",{className:"d-flex gap-2 mb-3",children:["Service & Treatment","In-clinic","Tele Consultation"].map(e=>t.jsx("button",{onClick:()=>D(e),className:`btn ${d.includes(e)?"btn-selected":"btn-unselected"}`,children:e},e))}),t.jsxs("div",{className:"mb-3 d-flex justify-content-between",children:[t.jsxs("div",{className:"d-flex gap-3 mb-3",style:{color:"var(--color-black)"},children:[t.jsx(S,{label:"Completed",value:"Completed",onChange:b,checked:i.includes("Completed")}),t.jsx(S,{label:"Active",value:"Active",onChange:b,checked:i.includes("Active")})]}),t.jsx(T,{style:{backgroundColor:"var(--color-black)",color:"white"},onClick:()=>{u([]),m([])},children:"Reset Filters"})]}),k?t.jsx("div",{className:"d-flex justify-content-center align-items-center",children:t.jsx(H,{message:"Loading reports..."})}):C?t.jsx("div",{children:C}):t.jsxs(L,{striped:!0,hover:!0,responsive:!0,children:[t.jsx(R,{className:"pink-table",children:t.jsxs(g,{children:[t.jsx(c,{children:"S.No"}),t.jsx(c,{children:"Name"}),t.jsx(c,{children:"Consultation Type"}),t.jsx(c,{children:"Date"}),t.jsx(c,{children:"Time"}),t.jsx(c,{children:"Status"}),t.jsx(c,{children:"Action"})]})}),t.jsx($,{children:v.length>0?v.map((e,s)=>t.jsxs(g,{className:"pink-table",children:[t.jsx(a,{children:s+1}),t.jsx(a,{children:e.name}),t.jsx(a,{children:e.consultationType}),t.jsx(a,{children:e.serviceDate}),t.jsx(a,{children:e.slot||e.servicetime}),t.jsx(a,{children:l(e.status)==="in-progress"?"Active":e.status}),t.jsx(a,{children:t.jsx(T,{style:{backgroundColor:"var(--color-black)",color:"white"},className:"text-white",size:"sm",onClick:()=>I(`/reportDetails/${e.bookingId}`,{state:{report:e,appointmentInfo:{name:e.name,age:e.age,gender:e.gender,problem:e.problem,bookingId:e.bookingId,patientId:e.patientId||(p==null?void 0:p.patientId),item:e,selectedAppointment:p}}}),children:"View"})})]},`${e.bookingId}-${s}`)):t.jsx(g,{children:t.jsx(a,{colSpan:"8",className:"text-center ",style:{color:"var(--color-black)"},children:"No appointments found."})})})]})]})})};export{le as default};
