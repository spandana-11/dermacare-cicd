import{r as s,h as v,j as t}from"./index-C6Cu0DpS.js";import{A as I}from"./appointmentAPI-CT6zXdIJ.js";import{a as x}from"./index.esm-CuIIRQYS.js";import{C as w,a as N,b as d,c as i,d as k,e as a}from"./CTable-qb4loNj2.js";const R=()=>{const[p,u]=s.useState([]);s.useState(!0);const[l,j]=s.useState([]);s.useState([]);const T=v(),[r,c]=s.useState([]);s.useState([]),s.useState(1);const[A,g]=s.useState([]),[D,S]=s.useState([]);s.useState([]),s.useState([]);const b={"Service & Treatment":"services & treatments","Video Consultation":"online consultation","In-clinic":"in-clinic consultation"},h=async()=>{try{const e=await I();j(e.data||[])}catch(e){console.error("Failed to fetch appointments:",e)}};s.useEffect(()=>{localStorage.getItem("HospitalId")&&h()},[]),s.useEffect(()=>{let e=l.filter(o=>f(o.status)==="completed");if(r.length===1){const o=r[0],n=b[o];n&&(e=e.filter(y=>f(y.consultationType)===n))}u(e)},[l,r]),s.useEffect(()=>{const e=[...new Set(l.map(n=>n.servicename).filter(Boolean))],o=[...new Set(l.map(n=>n.consultationType).filter(Boolean))];g(e),S(o),console.log("Available Consultation Types:",o)},[l]);const C=e=>{r.includes(e)?c([]):c([e])},m="Completed";s.useEffect(()=>{const e=l.filter(o=>{var n;return((n=o.status)==null?void 0:n.toLowerCase().trim())===m.toLowerCase().trim()});u(e)},[l,m]),s.useEffect(()=>{localStorage.getItem("HospitalId")?h():console.warn("No HospitalId in localStorage")},[]);const f=e=>e==null?void 0:e.toLowerCase().trim();return t.jsx("div",{style:{overflowX:"auto"},children:t.jsxs("div",{className:"container mt-4",children:[t.jsx("h5",{className:"mb-3",children:"Appointments"}),t.jsx("div",{className:"d-flex gap-2 mb-3",children:["Service & Treatment","In-clinic","Video Consultation"].map(e=>t.jsx("button",{onClick:()=>C(e),className:`btn ${r.includes(e)?"btn-dark":"btn-outline-dark"}`,children:e},e))}),t.jsx("div",{className:"mb-3",children:t.jsx(x,{color:"secondary",onClick:()=>c([]),children:"Reset Filters"})}),t.jsxs(w,{striped:!0,hover:!0,responsive:!0,children:[t.jsx(N,{children:t.jsxs(d,{children:[t.jsx(i,{children:"S.No"}),t.jsx(i,{children:"Name"}),t.jsx(i,{children:"Consultation Type"}),t.jsx(i,{children:"Date"}),t.jsx(i,{children:"Time"}),t.jsx(i,{children:"Status"}),t.jsx(i,{children:"Action"})]})}),t.jsx(k,{children:p.length>0?p.map((e,o)=>t.jsxs(d,{children:[t.jsx(a,{children:o+1}),t.jsx(a,{children:e.name}),t.jsx(a,{children:e.consultationType}),t.jsx(a,{children:e.serviceDate}),t.jsx(a,{children:e.slot||e.servicetime}),t.jsx(a,{children:e.status}),t.jsx(a,{children:t.jsx(x,{color:"primary",size:"sm",onClick:()=>T(`/reportDetails/${e.reportId}`,{state:{report:e,appointmentInfo:{name:e.name,age:e.age,gender:e.gender,problem:e.problem,bookingId:e.bookingId,item:e}}}),children:"View"})})]},`${e.bookingId}-${o}`)):t.jsx(d,{children:t.jsx(a,{colSpan:"8",className:"text-center text-danger fw-bold",children:"No completed appointments found."})})})]})]})})};export{R as default};
