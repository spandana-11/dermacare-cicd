import{r as n,h as V,j as t}from"./index-D-oDOyWO.js";import{G as E}from"./appointmentAPI-DD8TCHsO.js";import{C as y}from"./CFormCheck-ChMtEQws.js";import{a as T}from"./index.esm-Dag7HEVz.js";import{C as L,a as M,b as m,c as a,d as R,e as l}from"./CTable-hmvqCQO3.js";import{j as z}from"./DefaultLayout-CxfxLLjP.js";import"./CFormLabel-ccOuQI7Q.js";import"./CConditionalPortal-Cy0Xk2dr.js";const se=()=>{const[G,_]=n.useState(null),[U,k]=n.useState([]),[q,w]=n.useState([]),[f,I]=n.useState([]),[J,N]=n.useState([]),[K,A]=n.useState([]),[p,h]=n.useState([]),[r,x]=n.useState([]),[c,g]=n.useState([]),[u,v]=n.useState(1),[D,S]=n.useState(!0),C=7,$=V(),B=async()=>{try{const e=localStorage.getItem("HospitalId");if(console.log("Hospital ID from localStorage:",e),!e){h([]),S(!1);return}const s=await E(e);console.log("Appointments for this Hospital:",s),s!=null&&s.data?h(s.data):(console.warn("No data returned for Hospital ID:",e),h([]))}catch(e){console.error("Failed to fetch appointments:",e),h([])}finally{S(!1)}},F=e=>{switch(console.log(e),e==null?void 0:e.toLowerCase()){case"completed":return"success";case"confirmed":return"info";case"in progress":return"primary";case"rescheduled":return"secondary";default:return"dark"}};n.useEffect(()=>{B()},[]),n.useEffect(()=>{let e=[...p];console.log("Initial bookings:",e);const s=o=>o==null?void 0:o.toLowerCase().trim(),i={"Service & Treatment":"services & treatments","Video Consultation":"video consultation","In-clinic":"in-clinic consultation"};if(c.length>0&&(e=e.filter(o=>c.some(d=>s(d)===s(o.status))),console.log("After status filter:",e)),r.length===1){const o=r[0];if(o==="Video Consultation")e=e.filter(d=>s(d.consultationType)==="video consultation"||s(d.consultationType)==="online consultation"),console.log(`After ${o} filter:`,e);else{const d=i[o];d&&(e=e.filter(P=>s(P.consultationType)===d),console.log(`After ${o} filter:`,e))}}I(e),v(1)},[p,r,c]),n.useEffect(()=>{const e=[...new Set(p.map(i=>i.subServiceName).filter(Boolean))],s=[...new Set(p.map(i=>i.consultationType).filter(Boolean))];N(e),A(s),console.log("Available Consultation Types:",s)},[p]),n.useEffect(()=>{window.scrollTo(0,0)},[u]);const H=f.slice((u-1)*C,u*C),j=e=>{r.includes(e)?x([]):x([e])},b=e=>{const s=e.target.value;c.includes(s)?g([]):g([s])};return t.jsx("div",{style:{overflow:"hidden"},children:t.jsxs("div",{className:"container mt-4",children:[t.jsx("h5",{children:"Appointments"}),t.jsxs("div",{className:"d-flex gap-2 mb-3",children:[t.jsx("button",{onClick:()=>j("Service & Treatment"),className:`btn ${r.includes("Service & Treatment")?"btn-dark":"btn-outline-dark"}`,children:"Service & Treatment"}),t.jsx("button",{onClick:()=>j("In-clinic"),className:`btn ${r.includes("In-clinic")?"btn-dark":"btn-outline-dark"}`,children:"In-Clinic Consultation"}),t.jsx("button",{onClick:()=>j("Video Consultation"),className:`btn ${r.includes("Video Consultation")?"btn-dark":"btn-outline-dark"}`,children:"Video Consultation"})]}),t.jsxs("div",{className:"mb-3 d-flex justify-content-between align-items-center flex-wrap gap-2",children:[t.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[t.jsx(y,{label:"In-Progress",value:"In-Progress",onChange:b,checked:c.includes("In-Progress")}),t.jsx(y,{label:"Completed",value:"Completed",onChange:b,checked:c.includes("Completed")}),t.jsx(y,{label:"Confirmed",value:"Confirmed",onChange:b,checked:c.includes("Confirmed")})]}),t.jsx(T,{color:"secondary",onClick:()=>{k([]),w([]),x([]),g([])},children:"Reset Filters"})]}),t.jsxs(L,{striped:!0,hover:!0,responsive:!0,children:[t.jsx(M,{children:t.jsxs(m,{children:[t.jsx(a,{children:"S.No"}),t.jsx(a,{children:"H_ID"}),t.jsx(a,{children:"Name"}),t.jsx(a,{children:"Service Name"}),t.jsx(a,{children:"Consultation Type"}),t.jsx(a,{children:"Date"}),t.jsx(a,{children:"Time"}),t.jsx(a,{children:"Status"}),t.jsx(a,{children:"Action"})]})}),t.jsx(R,{children:D?t.jsx(m,{children:t.jsx(l,{colSpan:"9",className:"text-center text-primary fw-bold",children:"Loading appointments..."})}):Array.isArray(f)&&f.length>0?H.map((e,s)=>{var i;return t.jsxs(m,{children:[t.jsx(l,{children:s+1}),t.jsx(l,{children:e.clinicId}),t.jsx(l,{children:e.name}),t.jsx(l,{children:e.subServiceName}),t.jsx(l,{children:e.consultationType}),t.jsxs(l,{children:[e.sele?`${e.sele} `:"",e.serviceDate]}),t.jsx(l,{children:e.slot||e.servicetime}),t.jsx(l,{children:t.jsx(z,{color:F(e.status),children:(i=e.status)==null?void 0:i.split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ")})}),t.jsx(l,{children:t.jsx(T,{color:"primary",size:"sm",onClick:()=>$(`/appointmentDetails/${e.bookingId}`,{state:{appointment:e}}),children:"View"})})]},`${e.id}-${s}`)}):t.jsx(m,{children:t.jsx(l,{colSpan:"9",className:"text-center text-danger fw-bold",children:"No appointments found."})})})]}),t.jsx("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end"},children:Array.from({length:Math.ceil(f.length/C)},(e,s)=>t.jsx("button",{onClick:()=>v(s+1),style:{margin:"0 5px",padding:"5px 10px",backgroundColor:u===s+1?"#007bff":"#fff",color:u===s+1?"#fff":"#000",border:"1px solid #ccc",borderRadius:"5px"},children:s+1},s))})]})})};export{se as default};
