import{r as o,a as ae,u as re,j as e,C as s,n as te,h as T,B as p}from"./index-BZd6-648.js";import{C as oe,a as w,b as V}from"./index.esm-BZe2opj0.js";import le from"./Resetpassword-cM9BleW8.js";import{C as ie,a as Z}from"./CRow-CddRgLsf.js";import{C as ne,a as ce}from"./CCardBody-DXToTA2O.js";import{C as de,a as U,b as F}from"./CNavItem-wDeXchN9.js";import{C as me}from"./CForm-qjDyPqIY.js";import{C as pe}from"./CFormSelect-DCAectsn.js";import{C as E}from"./CInputGroup-a-5sa2GQ.js";import{C as O}from"./CInputGroupText-VjaLAQT7.js";import{c as he}from"./CustomerViewDetails-DHdEXT0k.js";import{C as B}from"./CFormInput-Ck0ix0GZ.js";import{c as ue}from"./cil-lock-locked-DmxpJbVL.js";import{C as fe,a as xe,b as ge}from"./CModalHeader-Durv8XK2.js";import{C as ye}from"./CModalTitle-CQh3zxe_.js";import{C as Ce}from"./CModalFooter-CnaQ0PLi.js";import"./index-CY5ypuYj.js";import"./CFormLabel-CWNs-Shv.js";var je=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M384,200V144A128,128,0,0,0,166.418,52.57l22.4,22.855A96,96,0,0,1,352,144v56H88V328c0,92.636,75.364,168,168,168s168-75.364,168-168V200Zm8,128c0,74.99-61.009,136-136,136s-136-61.01-136-136V232H392Z' class='ci-primary'/>"],we=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M473.605,88.081c-1.352-.137-135.958-14.259-199.218-68.251L269.9,16H242.1l-4.488,3.83C174.464,73.727,39.744,87.944,38.4,88.081L24,89.532V104c0,89.133,14.643,165.443,43.523,226.813,38.105,80.973,100.1,133.669,184.267,156.623l4.21,1.148,4.21-1.148c84.165-22.954,146.162-75.65,184.267-156.623C473.357,269.443,488,193.133,488,104V89.532ZM455.87,118.113q-.237,12.789-.948,25.887H272V57.915C331.921,97.482,421.024,113.237,455.87,118.113ZM272,320H414.266A288.233,288.233,0,0,1,390.9,360H272Zm0-32V248H439.9a402.662,402.662,0,0,1-13.236,42.884V288Zm0-72V176H452.378c-1.4,13.307-3.256,26.682-5.639,40ZM56.13,118.113c34.846-4.876,123.949-20.631,183.87-60.2V450.224C94.012,398.389,58.492,245.387,56.13,118.113ZM272,450.224V392h92.347C340.049,416.7,309.708,436.836,272,450.224Z' class='ci-primary'/>"];const Ne=""+new URL("DermaCare-c_uvrZe2.png",import.meta.url).href,Oe=()=>{const[c,W]=o.useState("clinic"),[f,q]=o.useState(""),[d,J]=o.useState(""),[i,_]=o.useState("admin"),[N,h]=o.useState(""),[n,g]=o.useState({}),[b,v]=o.useState(!1),[y,G]=o.useState(!1),[$,x]=o.useState(!1),{selectedHospital:z,setUser:Y,setHospitalId:I,setSelectedHospital:K,fetchAllData:Q}=ae(),X=re(),ee=()=>{const r={};return f.trim()||(r.userName="Username is required"),d.trim()||(r.password="Password is required"),d&&d.length<6&&(r.password="Password must be at least 6 characters"),g(r),Object.keys(r).length===0};o.useEffect(()=>{localStorage.clear()},[]);const se=async r=>{var m,S,k;if(r&&r.preventDefault&&r.preventDefault(),!!ee()){v(!0),h("");try{let t;if(i.toLowerCase()==="admin"?t=await T.post("/clinicLogin",{userName:f,password:d,role:i},{headers:{"Content-Type":"application/json"}}):t=(await T.post("/loginUsingRoles",{userName:f,password:d,role:i},{headers:{"Content-Type":"application/json"}})).data,console.log("✅ Login API response:",t.data),(t==null?void 0:t.status)===200){const a=t.data;if(!a){p.error((t==null?void 0:t.message)||"Invalid login response");return}const l=a.hospitalId,u=a.hospitalName,L=a.staffId,C=a.staffName,H=a.accessToken,P=a.permissions,M=a.branchId,D=a.branchName;if(console.log(l,u,z,i),l&&(localStorage.setItem("HospitalId",l),I(l)),u&&localStorage.setItem("HospitalName",u),H&&localStorage.setItem("token",H),i&&localStorage.setItem("role",i),M&&localStorage.setItem("branchId",M),L&&localStorage.setItem("staffId",L),C&&localStorage.setItem("staffName",C),D&&localStorage.setItem("branchName",D),a.accessToken&&localStorage.setItem("token",a.accessToken),await new Promise(j=>setTimeout(j,100)),l){const j=a.hospitalData||{},A={name:u||C,role:i,permissions:P};Y(A),localStorage.setItem("hospitalUser",JSON.stringify(A)),localStorage.setItem("permissions",JSON.stringify(P));const R={hospitalId:l,hospitalName:u,data:j};K(R),localStorage.setItem("selectedHospital",JSON.stringify(R)),I(l),localStorage.setItem("HospitalId",l),await Q(l),p.success(((m=t.data)==null?void 0:m.message)||"Login successful!"),X("/dashboard")}}}catch(t){console.error("Login error:",t);const a=(k=(S=t==null?void 0:t.response)==null?void 0:S.data)==null?void 0:k.message;a?a.toLowerCase().includes("username")?(h("Invalid username. Please try again."),p.error("Invalid username. Please try again.")):a.toLowerCase().includes("password")?(h("Invalid password. Please try again."),p.error("Invalid password. Please try again.")):(h(a),p.error(a)):(h("An unexpected error occurred. Please try again later."),p.error("An unexpected error occurred. Please try again later."))}finally{v(!1)}}};return e.jsxs("div",{className:"d-flex flex-column min-vh-100 derma-bg",children:[e.jsx("div",{className:"flex-grow-1 d-flex justify-content-center align-content-center align-items-center ",children:e.jsx(oe,{fluid:!0,className:"p-0 h-100   align-content-center align-items-center",children:e.jsxs(ie,{className:"g-0 h-100",children:[e.jsxs(Z,{md:6,className:"d-none d-md-flex flex-column justify-content-center derma-hero px-5 py-4",children:[e.jsx("div",{}),e.jsxs("div",{className:"text-center px-3",style:{color:s.primary},children:[e.jsx("img",{src:Ne,alt:"Derma Care",className:"mb-4",style:{width:120,height:"auto"}}),e.jsx("h2",{className:"fw-bold mb-3",style:{color:s.primary},children:"Welcome to Derma Care"}),e.jsx("p",{className:"lead mb-4",style:{opacity:.95,color:s.primary},children:"Manage dermatology operations seamlessly — appointments, records, billing & more."}),e.jsxs("div",{className:"d-flex justify-content-center gap-3 flex-wrap",children:[e.jsx("span",{className:"badge",style:{color:s.primary},children:"HIPAA-ready"}),e.jsx("span",{className:"badge",style:{color:s.primary},children:"e-Prescriptions"}),e.jsx("span",{className:"badge",style:{color:s.primary},children:"Smart Scheduling"})]})]})]}),e.jsx(Z,{md:6,className:"d-flex align-items-center justify-content-center  md-5",children:e.jsx(ne,{className:"shadow-lg border-0 glass-card w-100",style:{maxWidth:460},children:e.jsxs(ce,{className:"p-4 p-md-5",children:[e.jsx("h3",{className:"text-center fw-bold mb-3",style:{color:s.primary},children:"Derma Portal"}),e.jsx("p",{className:"text-center mb-4",style:{color:s.primary},children:"Please choose your workspace to continue"}),e.jsxs(de,{variant:"pills",className:"justify-content-center gap-2 mb-4",children:[e.jsx(U,{children:e.jsx(F,{active:c==="clinic",onClick:()=>W("clinic"),style:{backgroundColor:c==="clinic"?s.primary:s.white,color:c==="clinic"?s.white:s.primary,border:`1px solid ${s.primary}`,borderRadius:"8px",fontWeight:"500",padding:"8px 16px",cursor:"pointer"},children:"Clinic"})}),e.jsx(U,{children:e.jsx(F,{active:c==="doctor",onClick:()=>window.location.href="https://doctorweb.aesthetech.life",style:{backgroundColor:c==="doctor"?s.primary:s.white,color:c==="doctor"?s.white:s.primary,border:`1px solid ${s.primary}`,borderRadius:"8px",fontWeight:"500",padding:"8px 16px",cursor:"pointer"},children:"Doctor"})})]}),N&&e.jsx("div",{className:"alert alert-danger text-center py-2 mb-3",children:N}),c==="clinic"&&e.jsxs(me,{onSubmit:se,noValidate:!0,children:[e.jsxs(pe,{className:"mb-3",value:i,onChange:r=>_(r.target.value),children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"receptionist",children:"Receptionist"}),e.jsx("option",{value:"nurse",children:"Nurse"}),e.jsx("option",{value:"lab_technician",children:"Lab Technician"}),e.jsx("option",{value:"pharmacist",children:"Pharmacist"})]}),e.jsxs(E,{className:"mb-2",children:[e.jsx(O,{children:e.jsx(w,{icon:he})}),e.jsx(B,{placeholder:"Username",value:f,onChange:r=>{q(r.target.value),n.userName&&g(m=>({...m,userName:""}))},"aria-invalid":!!n.userName,autoComplete:"username"})]}),n.userName&&e.jsx("small",{className:"text-danger",children:n.userName}),e.jsxs(E,{className:"mt-3 mb-2",children:[e.jsx(O,{onClick:()=>G(r=>!r),style:{cursor:"pointer"},title:y?"Hide password":"Show password",children:e.jsx(w,{icon:y?je:ue})}),e.jsx(B,{type:y?"text":"password",placeholder:"Password",value:d,onChange:r=>{J(r.target.value),n.password&&g(m=>({...m,password:""}))},"aria-invalid":!!n.password,autoComplete:"current-password"})]}),n.password&&e.jsx("small",{className:"text-danger",children:n.password}),e.jsx("div",{className:"d-flex justify-content-between mt-2",style:{color:s.primary},children:e.jsx("a",{style:{color:s.primary},href:"#",className:"text-decoration-none derma-link",onClick:r=>{r.preventDefault(),x(!0)},children:"Forgot password?"})}),e.jsx(V,{type:"submit",disabled:b,className:"w-100 mt-4 derma-btn",style:{backgroundColor:s.primary,color:"white"},children:b?e.jsx(te,{size:"sm"}):"Login"})]})]})})})]})})}),e.jsxs("footer",{className:"d-flex justify-content-around small py-2 opacity-75 mt-auto",style:{color:s.primary,backgroundColor:"#f8f9fa"},children:[e.jsxs("span",{className:"d-inline-flex align-items-center gap-2",style:{color:s.primary},children:[e.jsx(w,{icon:we})," Secure by design"]}),e.jsxs("span",{style:{color:s.primary},children:["© ",new Date().getFullYear()," Chiselon Technologies"]}),e.jsx("a",{href:"https://chiselontechnologies.com",target:"_blank",style:{color:s.primary},children:"About Chiselon Technologies"})]}),e.jsxs(fe,{visible:$,onClose:()=>x(!1),children:[e.jsx(xe,{children:e.jsx(ye,{children:"Reset Password"})}),e.jsx(ge,{children:e.jsx(le,{onClose:()=>x(!1)})}),e.jsx(Ce,{children:e.jsx(V,{color:"secondary",onClick:()=>x(!1),children:"Close"})})]})]})};export{Oe as default};
