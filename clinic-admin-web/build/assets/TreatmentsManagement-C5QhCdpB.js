import{o as w,B as b,a1 as ne,a2 as oe,a3 as le,r as n,j as e,Q as ie,y as c}from"./index-D-oDOyWO.js";import{c as ce,a as m}from"./index.esm-Dag7HEVz.js";/* empty css                      */import{X as de}from"./index.es-CyaLuy6q.js";import{C as E}from"./CForm-C_9ZANgI.js";import{C as me}from"./CInputGroup-DFlVQaGa.js";import{C as I}from"./CFormInput-CxOD02nI.js";import{C as pe}from"./CInputGroupText-Bw8sjWME.js";import{c as ue}from"./cil-search-CDkY_4k-.js";import{C,a as T,b as N}from"./CModalHeader-DCaq31xv.js";import{C as g}from"./CModalTitle-B_oINO8I.js";import{C as he,a as q}from"./CRow-C5UAjCDF.js";import{C as k}from"./CModalFooter-Cjr_bjNp.js";import"./CFormLabel-ccOuQI7Q.js";import"./CConditionalPortal-Cy0Xk2dr.js";const xe=async()=>{try{const r=await w.get(`${b}/${ne}`);return console.log("treatment data:",r.data),r.data}catch(r){throw console.error("Error fetching treatment data:",r.message),r.response&&(console.error("Error Response Data:",r.response.data),console.error("Error Response Status:",r.response.status)),r}},je=async r=>{try{const l={treatmentName:r.treatmentName||"",hospitalId:r.hospitalId||""},s=await w.post(`${b}/${oe}`,l,{headers:{"Content-Type":"application/json"}});return console.log("Treatment added successfully:",s.data),s.data}catch(l){throw console.error("Error adding treatment:",l.response),l}},fe=async(r,l,s)=>{try{const d={testName:r.treatmentName};return(await w.put(`${b}/labtest/updateLabTest/${l}/${s}`,d,{headers:{"Content-Type":"application/json"}})).data}catch(d){throw console.error("Error updating treatment:",d.response||d),d}},ye=async(r,l)=>{try{const s=await w.delete(`${b}/${le}/${r}/${l}`,{headers:{"Content-Type":"application/json"}});return console.log("Treatment deleted successfully:",s.data),s.data}catch(s){throw console.error("Error deleting treatment:",s.response?s.response.data:s),s}},Fe=()=>{const[r,l]=n.useState(""),[s,d]=n.useState([]),[v,M]=n.useState([]),[H,$]=n.useState(!1),[A,_]=n.useState(null),[G,x]=n.useState(!1),[S,L]=n.useState(null),[X,j]=n.useState(!1),[p,F]=n.useState(null),[f,V]=n.useState({}),[z,D]=n.useState(!1),[J,R]=n.useState(null),[K,B]=n.useState(null),[u,Q]=n.useState({treatmentName:""}),O=localStorage.getItem("HospitalId"),P=t=>t.map(a=>({...a,id:a.id||a._id})),y=async()=>{$(!0);try{const t=await xe();d(P(t.data))}catch{_("Failed to fetch treatment data.")}finally{$(!1)}};n.useEffect(()=>{y()},[]),n.useEffect(()=>{const t=r.toLowerCase().trim();if(!t){M([]);return}const a=s.filter(o=>{var i;return(i=o.treatmentName)==null?void 0:i.toLowerCase().includes(t)});M(a)},[r,s]);const W=async()=>{try{await ye(J,K),c.success("Treatment deleted successfully!",{position:"top-right"}),y()}catch(t){c.error("Failed to delete treatment."),console.error("Delete error:",t)}D(!1)},Y=()=>{R(null),B(null),D(!1)},Z=async()=>{var t,a,o,i;if(!u.treatmentName.trim()){V({treatmentName:"Treatment name is required."});return}try{const h={treatmentName:u.treatmentName,hospitalId:O};await je(h),c.success("Treatment added successfully!"),y(),x(!1),Q({treatmentName:""})}catch(h){const U=((a=(t=h.response)==null?void 0:t.data)==null?void 0:a.message)||((o=h.response)==null?void 0:o.statusText)||"An unexpected error occurred.";((i=h.response)==null?void 0:i.status)===409||U.toLowerCase().includes("duplicate")?c.error(`Error: Duplicate treatment name - ${u.treatmentName} already exists!`,{position:"top-right"}):c.error(`Error adding treatment: ${U}`,{position:"top-right"})}},ee=t=>{F(t),j(!0)},te=async()=>{const{id:t,hospitalId:a,treatmentName:o}=p;if(!o.trim()){c.error("Treatment name is required.");return}try{await fe({treatmentName:o.trim(),hospitalId:a.trim()},t,a),c.success("Treatment updated successfully!"),j(!1),y()}catch(i){console.error("Update error:",i),c.error("Failed to update treatment.")}},re=t=>{R(t.treatmentId||t.id||t._id),B(t.hospitalId),D(!0)},ae=[{name:"S.No",selector:(t,a)=>a+1,width:"10%"},{name:"Treatment Name",selector:t=>t.treatmentName,sortable:!0,width:"45%"},{name:"Actions",cell:t=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"250px"},children:[e.jsx("div",{onClick:()=>L(t),style:{color:"green",cursor:"pointer"},children:"View"}),e.jsx("div",{onClick:()=>ee(t),style:{color:"blue",cursor:"pointer"},children:"Edit"}),e.jsx("div",{onClick:()=>re(t),style:{color:"red",cursor:"pointer"},children:"Delete"})]})}],se=({isVisible:t,message:a,onConfirm:o,onCancel:i})=>e.jsxs(C,{visible:t,onClose:i,backdrop:"static",children:[e.jsx(T,{children:e.jsx(g,{children:"Confirmation"})}),e.jsx(N,{children:a}),e.jsxs(k,{children:[e.jsx(m,{color:"secondary",onClick:i,children:"Cancel"}),e.jsx(m,{color:"danger",onClick:o,children:"Confirm"})]})]});return e.jsxs("div",{children:[e.jsx(ie,{}),e.jsxs(E,{className:"d-flex justify-content-between mb-3",children:[e.jsxs(me,{className:"mb-3",style:{width:"300px",marginLeft:"40px"},children:[e.jsx(I,{type:"text",placeholder:"Search by Treatment Name",value:r,onChange:t=>l(t.target.value)}),e.jsx(pe,{children:e.jsx(ce,{icon:ue})})]}),e.jsx(m,{color:"primary",style:{marginRight:"100px"},onClick:()=>x(!0),children:"Add Treatment"})]}),S&&e.jsxs(C,{visible:!!S,onClose:()=>L(null),backdrop:"static",children:[e.jsx(T,{children:e.jsx(g,{children:"Treatment Details"})}),e.jsx(N,{children:e.jsxs(he,{className:"mb-3",children:[e.jsx(q,{sm:4,children:e.jsx("strong",{children:"Treatment Name:"})}),e.jsx(q,{sm:8,children:S.treatmentName})]})})]}),e.jsxs(C,{visible:G,onClose:()=>x(!1),backdrop:"static",children:[e.jsx(T,{children:e.jsx(g,{children:"Add New Treatment"})}),e.jsx(N,{children:e.jsxs(E,{children:[e.jsxs("h6",{children:["Treatment Name ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(I,{type:"text",name:"treatmentName",value:u.treatmentName,onChange:t=>{const a=t.target.value;Q({...u,treatmentName:a}),f.treatmentName&&V(o=>({...o,treatmentName:""}))},placeholder:"Enter Treatment Name",className:f.treatmentName?"is-invalid":""}),f.treatmentName&&e.jsx("div",{className:"invalid-feedback",style:{color:"red"},children:f.treatmentName})]})}),e.jsxs(k,{children:[e.jsx(m,{color:"primary",onClick:Z,children:"Add"}),e.jsx(m,{color:"secondary",onClick:()=>x(!1),children:"Cancel"})]})]}),e.jsxs(C,{visible:X,onClose:()=>j(!1),backdrop:"static",children:[e.jsx(T,{children:e.jsx(g,{children:"Edit Treatment"})}),e.jsx(N,{children:e.jsxs(E,{children:[e.jsx("h6",{children:"Treatment Name"}),e.jsx(I,{type:"text",value:(p==null?void 0:p.treatmentName)||"",onChange:t=>F({...p,treatmentName:t.target.value})})]})}),e.jsxs(k,{children:[e.jsx(m,{color:"primary",onClick:te,children:"Update"}),e.jsx(m,{color:"secondary",onClick:()=>j(!1),children:"Cancel"})]})]}),e.jsx(se,{isVisible:z,message:"Are you sure you want to delete this treatment?",onConfirm:W,onCancel:Y}),H?e.jsx("div",{style:{textAlign:"center"},children:"Loading..."}):A?e.jsx("div",{children:A}):e.jsx(de,{columns:ae,data:v.length?v:s,pagination:!0})]})};export{Fe as default};
