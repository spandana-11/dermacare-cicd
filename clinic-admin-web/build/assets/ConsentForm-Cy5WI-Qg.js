import{B as re,a0 as se,o as ae,a1 as ce,r as Y,v as de,u as ue,j as e}from"./index-Bbof3Raq.js";const he=async(i,P,u)=>{console.log("Calling API:",`${re}/${se}/${i}/${P}/${u}`);try{return(await ae.get(`${re}/${se}/${i}/${P}/${u}`)).data}catch(v){throw console.error("Error fetching service data:",v.message),v.response&&(console.error("Error Response Data:",v.response.data),console.error("Error Response Status:",v.response.status)),v}},me=async(i,P)=>{try{return(await ae.put(`${re}/${ce}/${i}`,P,{headers:{"Content-Type":"application/json"}})).data}catch(u){throw u}};var ie={exports:{}};(function(i,P){(function(u,v){i.exports=v(Y)})(typeof self<"u"?self:de,function(u){return function(){var v={155:function(t){t.exports=u}},ne={};function m(t){var n=ne[t];if(n!==void 0)return n.exports;var s=ne[t]={exports:{}};return v[t](s,s.exports,m),s.exports}m.d=function(t,n){for(var s in n)m.o(n,s)&&!m.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},m.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},m.r=function(t){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var M={};m.r(M),m.d(M,{useReactToPrint:function(){return z}});var oe=m(155);function l({level:t="error",messages:n,suppressErrors:s=!1}){s||(t==="error"?console.error(n):t==="warning"?console.warn(n):console.debug(n))}function Q(t,n){if(n||!t){const s=document.getElementById("printWindow");s&&document.body.removeChild(s)}}function G(t){return t instanceof Error?t:new Error("Unknown Error")}function J(t,n){const{documentTitle:s,onAfterPrint:f,onPrintError:w,preserveAfterPrint:_,print:A,suppressErrors:j}=n;setTimeout(()=>{var g,y;if(t.contentWindow){let W=function(){f==null||f(),Q(_)};if(t.contentWindow.focus(),A)A(t).then(W).catch(N=>{w?w("print",G(N)):l({messages:["An error was thrown by the specified `print` function"],suppressErrors:j})});else{if(t.contentWindow.print){const N=(y=(g=t.contentDocument)===null||g===void 0?void 0:g.title)!==null&&y!==void 0?y:"",k=t.ownerDocument.title;s&&(t.ownerDocument.title=s,t.contentDocument&&(t.contentDocument.title=s)),t.contentWindow.print(),s&&(t.ownerDocument.title=k,t.contentDocument&&(t.contentDocument.title=N))}else l({messages:["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."],suppressErrors:j});[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(N=>{var k,T;return((T=(k=navigator.userAgent)!==null&&k!==void 0?k:navigator.vendor)!==null&&T!==void 0?T:"opera"in window&&window.opera).match(N)})?setTimeout(W,500):W()}}else l({messages:["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/MatthewHerbst/react-to-print/issues/"],suppressErrors:j})},500)}function K(t){const n=[],s=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null);let f=s.nextNode();for(;f;)n.push(f),f=s.nextNode();return n}function U(t,n,s){const f=K(t),w=K(n);if(f.length===w.length)for(let _=0;_<f.length;_++){const A=f[_],j=w[_],g=A.shadowRoot;if(g!==null){const y=j.attachShadow({mode:g.mode});y.innerHTML=g.innerHTML,U(g,y,s)}}else l({messages:["When cloning shadow root content, source and target elements have different size. `onBeforePrint` likely resolved too early.",t,n],suppressErrors:s})}const b=`
    @page {
        /* Remove browser default header (title) and footer (url) */
        margin: 0;
    }
    @media print {
        body {
            /* Tell browsers to print background colors */
            color-adjust: exact; /* Firefox. This is an older version of "print-color-adjust" */
            print-color-adjust: exact; /* Firefox/Safari */
            -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */
        }
    }
`;function x(t,n,s,f){var w,_,A,j,g;const{contentNode:y,clonedContentNode:W,clonedImgNodes:N,clonedVideoNodes:k,numResourcesToLoad:T,originalCanvasNodes:X}=s,{bodyClass:V,fonts:R,ignoreGlobalStyles:Z,pageStyle:q,nonce:F,suppressErrors:c,copyShadowRoots:B}=f;t.onload=null;const d=(w=t.contentDocument)!==null&&w!==void 0?w:(_=t.contentWindow)===null||_===void 0?void 0:_.document;if(d){const I=d.body.appendChild(W);B&&U(y,I,!!c),R&&(!((A=t.contentDocument)===null||A===void 0)&&A.fonts&&(!((j=t.contentWindow)===null||j===void 0)&&j.FontFace)?R.forEach(r=>{const o=new FontFace(r.family,r.source,{weight:r.weight,style:r.style});t.contentDocument.fonts.add(o),o.loaded.then(()=>{n(o)}).catch(p=>{n(o,["Failed loading the font:",o,"Load error:",G(p)])})}):(R.forEach(r=>{n(r)}),l({messages:['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'],suppressErrors:c})));const H=q??b,L=d.createElement("style");F&&(L.setAttribute("nonce",F),d.head.setAttribute("nonce",F)),L.appendChild(d.createTextNode(H)),d.head.appendChild(L),V&&d.body.classList.add(...V.split(" "));const S=d.querySelectorAll("canvas");for(let r=0;r<X.length;++r){const o=X[r],p=S[r];if(p===void 0){l({messages:["A canvas element could not be copied for printing, has it loaded? `onBeforePrint` likely resolved too early.",o],suppressErrors:c});continue}const a=p.getContext("2d");a&&a.drawImage(o,0,0)}for(let r=0;r<N.length;r++){const o=N[r],p=o.getAttribute("src");if(p){const a=new Image;a.onload=()=>{n(o)},a.onerror=(h,E,O,C,$)=>{n(o,["Error loading <img>",o,"Error",$])},a.src=p}else n(o,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it.',o])}for(let r=0;r<k.length;r++){const o=k[r];o.preload="auto";const p=o.getAttribute("poster");if(p){const a=new Image;a.onload=()=>{n(o)},a.onerror=(h,E,O,C,$)=>{n(o,["Error loading video poster",p,"for video",o,"Error:",$])},a.src=p}else o.readyState>=2?n(o):o.src?(o.onloadeddata=()=>{n(o)},o.onerror=(a,h,E,O,C)=>{n(o,["Error loading video",o,"Error",C])},o.onstalled=()=>{n(o,["Loading video stalled, skipping",o])}):n(o,["Error loading video, `src` is empty",o])}const D="select",ee=y.querySelectorAll(D),te=d.querySelectorAll(D);for(let r=0;r<ee.length;r++)te[r].value=ee[r].value;if(!Z){const r=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']");for(let o=0,p=r.length;o<p;++o){const a=r[o];if(a.tagName.toLowerCase()==="style"){const h=d.createElement(a.tagName),E=a.sheet;if(E){let O="";try{const C=E.cssRules.length;for(let $=0;$<C;++$)typeof E.cssRules[$].cssText=="string"&&(O+=`${E.cssRules[$].cssText}\r
`)}catch(C){l({messages:["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/MatthewHerbst/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",a,`Original error: ${G(C).message}`],level:"warning"})}h.setAttribute("id",`react-to-print-${o}`),F&&h.setAttribute("nonce",F),h.appendChild(d.createTextNode(O)),d.head.appendChild(h)}}else if(a.getAttribute("href"))if(a.hasAttribute("disabled"))l({messages:["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",a],level:"warning"}),n(a);else{const h=d.createElement(a.tagName);for(let E=0,O=a.attributes.length;E<O;++E){const C=a.attributes[E];C&&h.setAttribute(C.nodeName,(g=C.nodeValue)!==null&&g!==void 0?g:"")}h.onload=()=>{n(h)},h.onerror=(E,O,C,$,le)=>{n(h,["Failed to load",h,"Error:",le])},F&&h.setAttribute("nonce",F),d.head.appendChild(h)}else l({messages:["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",a],level:"warning"}),n(a)}}}T===0&&J(t,f)}function z({bodyClass:t,contentRef:n,copyShadowRoots:s,documentTitle:f,fonts:w,ignoreGlobalStyles:_,nonce:A,onAfterPrint:j,onBeforePrint:g,onPrintError:y,pageStyle:W,preserveAfterPrint:N,print:k,suppressErrors:T}){return(0,oe.useCallback)(X=>{function V(){const R={bodyClass:t,contentRef:n,copyShadowRoots:s,documentTitle:f,fonts:w,ignoreGlobalStyles:_,nonce:A,onAfterPrint:j,onPrintError:y,pageStyle:W,preserveAfterPrint:N,print:k,suppressErrors:T},Z=function(){const c=document.createElement("iframe");return c.width=`${document.documentElement.clientWidth}px`,c.height=`${document.documentElement.clientHeight}px`,c.style.position="absolute",c.style.top=`-${document.documentElement.clientHeight+100}px`,c.style.left=`-${document.documentElement.clientWidth+100}px`,c.id="printWindow",c.srcdoc="<!DOCTYPE html>",c}(),q=function(c,B){const{contentRef:d,fonts:I,ignoreGlobalStyles:H,suppressErrors:L}=B,S=function({contentRef:p,optionalContent:a,suppressErrors:h}){return a&&typeof a=="function"?(p&&l({level:"warning",messages:['"react-to-print" received a `contentRef` option and an optional-content param passed to its callback. The `contentRef` option will be ignored.']}),a()):p?p.current:void l({messages:['"react-to-print" did not receive a `contentRef` option or a optional-content param pass to its callback.'],suppressErrors:h})}({contentRef:d,optionalContent:c,suppressErrors:L});if(!S)return;const D=S.cloneNode(!0),ee=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),te=D.querySelectorAll("img"),r=D.querySelectorAll("video"),o=I?I.length:0;return{contentNode:S,clonedContentNode:D,clonedImgNodes:te,clonedVideoNodes:r,numResourcesToLoad:(H?0:ee.length)+te.length+r.length+o,originalCanvasNodes:S.querySelectorAll("canvas")}}(X,R);if(!q)return void l({messages:["There is nothing to print"],suppressErrors:T});const F=function(c,B,d){const{suppressErrors:I}=c,H=[],L=[];return function(S,D){H.includes(S)?l({level:"debug",messages:["Tried to mark a resource that has already been handled",S],suppressErrors:I}):(D?(l({messages:['"react-to-print" was unable to load a resource but will continue attempting to print the page',...D],suppressErrors:I}),L.push(S)):H.push(S),H.length+L.length===B&&J(d,c))}}(R,q.numResourcesToLoad,Z);(function(c,B,d,I){c.onload=()=>{x(c,B,d,I)},document.body.appendChild(c)})(Z,F,q,R)}Q(N,!0),g?g().then(()=>{V()}).catch(R=>{y==null||y("onBeforePrint",G(R))}):V()},[t,n,s,f,w,_,A,j,g,y,W,N,k,T])}return M}()})})(ie);var pe=ie.exports;const ge=()=>{var U;const[i,P]=Y.useState({}),[u,v]=Y.useState(!1),m=(U=ue().state)==null?void 0:U.appointment,M=Y.useRef(),oe=pe.useReactToPrint({contentRef:M,documentTitle:`Consent_Form_${i.fullName||"Patient"}`,pageStyle:`
      @page { size: auto; margin: 20mm; }
      body { -webkit-print-color-adjust: exact; }
    `});Y.useEffect(()=>{m&&(async()=>{try{const x=m.bookingId,z=m.patientId,t=m.contactNumber||m.mobileNumber,n=await he(x,z,t);n!=null&&n.data&&P({...n.data,consentFormId:n.data.id,fullName:m.patientName||n.data.fullName,contactNumber:t||n.data.contactNumber,patientAddress:n.data.patientAddress||""})}catch(x){console.error("Error fetching consent form:",x)}})()},[m]);const l=b=>{const{name:x,value:z}=b.target;P(t=>({...t,[x]:z}))},Q=b=>{P(x=>({...x,[b]:!x[b]}))},G=()=>v(!0),J=async()=>{try{if(!i.consentFormId){console.error("Consent Form ID missing — cannot update");return}await me(i.consentFormId,i),v(!1)}catch(b){console.error("Failed to update consent form:",b)}},K=[{field:"informedAboutProcedure",label:"I have been informed about the procedure."},{field:"understandRisks",label:"I understand the risks involved."},{field:"informedAlternatives",label:"I have been informed of alternatives."},{field:"hadOpportunityQuestions",label:"I have had the opportunity to ask questions and all were answered."},{field:"noGuaranteesGiven",label:"I understand that no guarantees have been given about the results."},{field:"consentAnesthesia",label:"I consent to anesthesia if required."},{field:"understandAnesthesiaRisks",label:"I understand the risks of anesthesia."},{field:"consentRecording",label:"I consent to the recording of the procedure."},{field:"noConsentRecording",label:"I do not consent to the recording of the procedure."},{field:"rightWithdraw",label:"I understand my right to withdraw consent at any time."},{field:"giveConsentProceed",label:"I give my consent to proceed with the procedure."}];return e.jsxs("div",{ref:M,id:"consent-form-container",className:"container mt-4 p-4 border rounded bg-white",children:[" ",e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h2",{children:"🏥 DermaCare Clinic"}),e.jsx("h4",{children:"Patient Consent Form"})]}),e.jsx("h5",{children:"Patient Information"}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{children:"Name"}),e.jsx("input",{name:"fullName",value:i.fullName||"",onChange:l,className:"form-control",disabled:!u})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{children:"Age"}),e.jsx("input",{name:"dateOfBirth",value:i.dateOfBirth||"",onChange:l,className:"form-control",disabled:!u})]}),e.jsxs("div",{className:"col-md-6 mt-2",children:[e.jsx("label",{children:"Contact"}),e.jsx("input",{name:"contactNumber",value:i.contactNumber||"",onChange:l,className:"form-control",disabled:!u})]}),e.jsxs("div",{className:"col-md-6 mt-2",children:[e.jsx("label",{children:"Address"}),e.jsx("input",{name:"patientAddress",value:i.patientAddress||"",onChange:l,className:"form-control",disabled:!u})]}),e.jsxs("div",{className:"col-md-6 mt-2",children:[e.jsx("label",{children:"Procedure"}),e.jsx("input",{name:"procedureName",value:i.procedureName||"",onChange:l,className:"form-control",disabled:!u})]}),e.jsxs("div",{className:"col-md-6 mt-2",children:[e.jsx("label",{children:"Procedure Date"}),e.jsx("input",{type:"date",name:"procedureDate",value:i.procedureDate||"",onChange:l,className:"form-control",disabled:!u})]}),e.jsxs("div",{className:"col-md-6 mt-2",children:[e.jsx("label",{children:"Physician"}),e.jsx("input",{name:"physicianName",value:i.physicianName||"",onChange:l,className:"form-control",disabled:!u})]})]}),e.jsx("h5",{className:"mt-4",children:"Consent Statements"}),e.jsx("div",{children:K.map((b,x)=>e.jsxs("div",{className:"form-check",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:b.field,checked:!!i[b.field],disabled:!u,onChange:()=>Q(b.field)}),e.jsx("label",{className:"form-check-label",htmlFor:b.field,children:b.label})]},x))}),e.jsx("h5",{className:"mt-4",children:"Signatures"}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ___________________"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Signature:"})," ______________"]}),e.jsx("p",{children:e.jsx("em",{children:"(Hospital Name: DermaCare Clinic)"})}),e.jsx("p",{children:e.jsxs("em",{children:["(Address:",i.patientAddress||"________________",")"]})})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," Dr. ___________________"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Designation:"})," ________________"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"License No:"})," _______________"]}),e.jsx("p",{children:e.jsx("strong",{children:"Signature:"})}),i.physicianSignature&&e.jsx("img",{src:`data:image/png;base64,${i.physicianSignature}`,alt:"Physician Signature",style:{display:"block",marginTop:"5px",maxWidth:"200px"}})]})]}),e.jsx("div",{className:"d-flex gap-2 mt-4",children:u?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-success",onClick:J,children:"Update"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>v(!1),children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-primary",onClick:G,children:"Edit"}),e.jsx("button",{className:"btn btn-info",onClick:oe,children:"Print"})]})})]})};export{ge as default};
