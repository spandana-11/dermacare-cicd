import{r as s,_ as J,$ as l,a as R,c as I,P as d,h as K,j as e}from"./index-D4bMhh6S.js";import{G as Q}from"./appointmentAPI-D52m8HQe.js";import{C as O,a as U}from"./CFormLabel-DK_Gqezi.js";import{u as W}from"./CConditionalPortal-B5iE6UDO.js";import{a as G}from"./index.esm-CKtuKisK.js";import{C as X,a as Y,b as H,c as p,d as Z,e as u}from"./CTable-CM-ntns4.js";import{j as _}from"./DefaultLayout-ZdgSbFu-.js";var g=s.forwardRef(function(a,L){var V=a.className,r=a.button,z=a.feedback,D=a.feedbackInvalid,x=a.feedbackValid,$=a.floatingLabel,M=a.tooltipFeedback,w=a.hitArea,C=a.id,y=a.indeterminate,v=a.inline,j=a.invalid,i=a.label,T=a.reverse,o=a.type,S=o===void 0?"checkbox":o,m=a.valid,N=J(a,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]),b=s.useRef(null),B=W(L,b);s.useEffect(function(){b.current&&y&&(b.current.indeterminate=y)},[y,b.current]);var k=function(){return l.createElement("input",R({type:S,className:I(r?"btn-check":"form-check-input",{"is-invalid":j,"is-valid":m,"me-2":w}),id:C},N,{ref:B}))},E=function(){return l.createElement(U,{describedby:N["aria-describedby"],feedback:z,feedbackInvalid:D,feedbackValid:x,floatingLabel:$,invalid:j,tooltipFeedback:M,valid:m})},A=function(){var f;return l.createElement(O,R({customClassName:I(r?I("btn",r.variant?"btn-".concat(r.variant,"-").concat(r.color):"btn-".concat(r.color),(f={},f["btn-".concat(r.size)]=r.size,f),"".concat(r.shape)):"form-check-label")},C&&{htmlFor:C}),i)},F=function(){return r?l.createElement(l.Fragment,null,l.createElement(k,null),i&&l.createElement(A,null),l.createElement(E,null)):i?w?l.createElement(l.Fragment,null,l.createElement(k,null),l.createElement(O,R({customClassName:I("form-check-label stretched-link",V)},C&&{htmlFor:C}),i),l.createElement(E,null)):l.createElement("div",{className:I("form-check",{"form-check-inline":v,"form-check-reverse":T,"is-invalid":j,"is-valid":m},V)},l.createElement(k,null),l.createElement(A,null),l.createElement(E,null)):l.createElement(k,null)};return l.createElement(F,null)});g.propTypes=R({button:d.object,className:d.string,hitArea:d.oneOf(["full"]),id:d.string,indeterminate:d.bool,inline:d.bool,label:d.oneOfType([d.string,d.node]),reverse:d.bool,type:d.oneOf(["checkbox","radio"])},U.propTypes);g.displayName="CFormCheck";const ie=()=>{const[a,L]=s.useState(null),[V,r]=s.useState([]),[z,D]=s.useState([]),[x,$]=s.useState([]),[M,w]=s.useState([]),[C,y]=s.useState([]),[v,j]=s.useState([]),[i,T]=s.useState([]),[o,S]=s.useState([]),[m,N]=s.useState(1),b=7,B=K(),k=async()=>{try{const t=localStorage.getItem("HospitalId");if(console.log("Hospital ID from localStorage:",t),!t){console.warn("Hospital ID not found in localStorage.");return}const n=await Q(t);console.log("Appointments for this Hospital:",n),n!=null&&n.data?j(n.data):(console.warn("No data returned for Hospital ID:",t),j([]))}catch(t){console.error("Failed to fetch appointments:",t)}},E=t=>{switch(console.log(t),t==null?void 0:t.toLowerCase()){case"completed":return"success";case"Rejected":return"danger";case"pending":return"warning";case"confirmed":return"info";case"in progress":return"primary";case"rescheduled":return"secondary";default:return"dark"}};s.useEffect(()=>{k()},[]),s.useEffect(()=>{let t=[...v];console.log("Initial bookings:",t);const n=c=>c==null?void 0:c.toLowerCase().trim(),h={"Service & Treatment":"services & treatments","Video Consultation":"online consultation","In-clinic":"in-clinic consultation"};if(o.length>0&&(t=t.filter(c=>o.some(P=>n(P)===n(c.status))),console.log("After status filter:",t)),i.length===1){const c=i[0],P=h[c];P&&(t=t.filter(q=>n(q.consultationType)===P),console.log(`After ${c} filter:`,t))}$(t),N(1)},[v,i,o]),s.useEffect(()=>{const t=[...new Set(v.map(h=>h.subServiceName).filter(Boolean))],n=[...new Set(v.map(h=>h.consultationType).filter(Boolean))];w(t),y(n),console.log("Available Consultation Types:",n)},[v]),s.useEffect(()=>{window.scrollTo(0,0)},[m]);const A=x.slice((m-1)*b,m*b),F=t=>{i.includes(t)?T([]):T([t])},f=t=>{const n=t.target.value;o.includes(n)?S([]):S([n])};return e.jsx("div",{style:{overflow:"hidden"},children:e.jsxs("div",{className:"container mt-4",children:[e.jsx("h5",{children:"Appointments"}),e.jsxs("div",{className:"d-flex gap-2 mb-3",children:[e.jsx("button",{onClick:()=>F("Service & Treatment"),className:`btn ${i.includes("Service & Treatment")?"btn-dark":"btn-outline-dark"}`,children:"Service & Treatment"}),e.jsx("button",{onClick:()=>F("In-clinic"),className:`btn ${i.includes("In-clinic")?"btn-dark":"btn-outline-dark"}`,children:"In-Clinic Consultation"}),e.jsx("button",{onClick:()=>F("Video Consultation"),className:`btn ${i.includes("Video Consultation")?"btn-dark":"btn-outline-dark"}`,children:"Video Consultation"})]}),e.jsxs("div",{className:"mb-3 d-flex justify-content-between align-items-center flex-wrap gap-2",children:[e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx(g,{label:"Pending",value:"Pending",onChange:f,checked:o.includes("Pending")}),e.jsx(g,{label:"In-Progress",value:"In-Progress",onChange:f,checked:o.includes("In-Progress")}),e.jsx(g,{label:"Completed",value:"Completed",onChange:f,checked:o.includes("Completed")}),e.jsx(g,{label:"Confirmed",value:"Confirmed",onChange:f,checked:o.includes("Confirmed")}),e.jsx(g,{label:"Rejected",value:"Rejected",onChange:f,checked:o.includes("Rejected")})]}),e.jsx(G,{color:"secondary",onClick:()=>{r([]),D([]),T([]),S([])},children:"Reset Filters"})]}),e.jsxs(X,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(Y,{children:e.jsxs(H,{children:[e.jsx(p,{children:"S.No"}),e.jsx(p,{children:"H_ID"}),e.jsx(p,{children:"Name"}),e.jsx(p,{children:"Service Name"}),e.jsx(p,{children:"Consultation Type"}),e.jsx(p,{children:"Date"}),e.jsx(p,{children:"Time"}),e.jsx(p,{children:"Status"}),e.jsx(p,{children:"Action"})]})}),e.jsx(Z,{children:Array.isArray(x)&&x.length>0?A.map((t,n)=>{var h;return e.jsxs(H,{children:[e.jsx(u,{children:n+1}),e.jsx(u,{children:t.clinicId}),e.jsx(u,{children:t.name}),e.jsx(u,{children:t.subServiceName}),e.jsx(u,{children:t.consultationType}),e.jsxs(u,{children:[t.sele?`${t.sele} `:"",t.serviceDate]}),e.jsx(u,{children:t.slot||t.servicetime}),e.jsx(u,{children:e.jsx(u,{children:e.jsx(_,{color:E(t.status),children:(h=t.status)==null?void 0:h.split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1)).join(" ")})})}),e.jsx(u,{children:e.jsx(G,{color:"primary",size:"sm",onClick:()=>B(`/appointmentDetails/${t.bookingId}`,{state:{appointment:t}}),children:"View"})})]},`${t.id} -${n}`)}):e.jsx(H,{children:e.jsx(u,{colSpan:"8",className:"text-center text-danger fw-bold",children:"No appointments found."})})})]}),e.jsx("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end"},children:Array.from({length:Math.ceil(x.length/b)},(t,n)=>e.jsx("button",{onClick:()=>N(n+1),style:{margin:"0 5px",padding:"5px 10px",backgroundColor:m===n+1?"#007bff":"#fff",color:m===n+1?"#fff":"#000",border:"1px solid #ccc",borderRadius:"5px"},children:n+1},n))})]})})};export{ie as default};
