import{r as t,i as se,h as ae,j as e,C as s,q as re,v as D,B as n}from"./index-C7YuJAAI.js";import{b as oe,c as w,a as Z}from"./index.esm-B3sb08FX.js";import te from"./Resetpassword-DlE1B6LB.js";import{C as le,a as U}from"./CRow-CsccKEEA.js";import{C as ie,a as ne}from"./CCardBody-BrATtbtc.js";import{f as ce,e as F,d as E}from"./CNavItem-BHTEVeIb.js";import{C as de}from"./CForm-B3RLrqng.js";import{C as me}from"./CFormSelect-DDyQ53N9.js";import{C as O}from"./CInputGroup-VSbhwEHL.js";import{C as q}from"./CInputGroupText-D_2HDy3q.js";import{c as pe}from"./cil-user-Ddrdy7PS.js";import{C as B}from"./CFormInput-CNM-faD4.js";import{c as he}from"./cil-lock-locked-DmxpJbVL.js";import{C as fe,a as ue,b as xe}from"./CModalHeader-Bku5iNpS.js";import{C as ge}from"./CModalTitle-CrSU8CaH.js";import{C as ye}from"./CModalFooter-BtK5r1_p.js";import"./index-2Kd0T2z5.js";import"./CFormLabel-C_a-pvv2.js";var Ce=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M384,200V144A128,128,0,0,0,166.418,52.57l22.4,22.855A96,96,0,0,1,352,144v56H88V328c0,92.636,75.364,168,168,168s168-75.364,168-168V200Zm8,128c0,74.99-61.009,136-136,136s-136-61.01-136-136V232H392Z' class='ci-primary'/>"],je=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M473.605,88.081c-1.352-.137-135.958-14.259-199.218-68.251L269.9,16H242.1l-4.488,3.83C174.464,73.727,39.744,87.944,38.4,88.081L24,89.532V104c0,89.133,14.643,165.443,43.523,226.813,38.105,80.973,100.1,133.669,184.267,156.623l4.21,1.148,4.21-1.148c84.165-22.954,146.162-75.65,184.267-156.623C473.357,269.443,488,193.133,488,104V89.532ZM455.87,118.113q-.237,12.789-.948,25.887H272V57.915C331.921,97.482,421.024,113.237,455.87,118.113ZM272,320H414.266A288.233,288.233,0,0,1,390.9,360H272Zm0-32V248H439.9a402.662,402.662,0,0,1-13.236,42.884V288Zm0-72V176H452.378c-1.4,13.307-3.256,26.682-5.639,40ZM56.13,118.113c34.846-4.876,123.949-20.631,183.87-60.2V450.224C94.012,398.389,58.492,245.387,56.13,118.113ZM272,450.224V392h92.347C340.049,416.7,309.708,436.836,272,450.224Z' class='ci-primary'/>"];const we=""+new URL("DermaCare-c_uvrZe2.png",import.meta.url).href,Oe=()=>{const[c,W]=t.useState("clinic"),[u,_]=t.useState(""),[m,z]=t.useState(""),[l,G]=t.useState("admin"),[N,h]=t.useState(""),[i,y]=t.useState({}),[b,v]=t.useState(!1),[C,J]=t.useState(!1),[$,x]=t.useState(!1),{selectedHospital:I,setUser:Y,setHospitalId:K,setSelectedHospital:Ne}=se(),Q=ae(),X=()=>{const a={};return u.trim()||(a.userName="Username is required"),m.trim()||(a.password="Password is required"),m&&m.length<6&&(a.password="Password must be at least 6 characters"),y(a),Object.keys(a).length===0};t.useEffect(()=>{localStorage.clear()},[]);const ee=async a=>{var p,S,k,L;if(a&&a.preventDefault&&a.preventDefault(),!!X()){v(!0),h("");try{let o;if(l.toLowerCase()==="admin"?o=await D.post("/clinicLogin",{userName:u,password:m,role:l},{headers:{"Content-Type":"application/json"}}):o=(await D.post("/loginUsingRoles",{userName:u,password:m,role:l},{headers:{"Content-Type":"application/json"}})).data,console.log("✅ Login API response:",o.data),(o==null?void 0:o.status)===200){const r=o.data;if(!r){n.error((o==null?void 0:o.message)||"Invalid login response");return}const f=r.hospitalId,d=r.hospitalName,P=r.staffId,g=r.staffName,H=r.accessToken,j=r.permissions,M=r.branchId;if(console.log(f,d,I,l),f&&(localStorage.setItem("HospitalId",f),K(f)),d&&localStorage.setItem("HospitalName",d),H&&localStorage.setItem("token",H),l&&localStorage.setItem("role",l),M&&localStorage.setItem("branchId",M),P&&localStorage.setItem("staffId",P),g&&localStorage.setItem("staffName",g),r.accessToken&&localStorage.setItem("token",r.accessToken),await new Promise(R=>setTimeout(R,100)),f){if(I!=null){const R=T=>{const V={};return Object.keys(T).forEach(A=>{V[A.trim()]=T[A]}),V};Y({name:d||g,role:l,permissions:j}),localStorage.setItem("hospitalUser",JSON.stringify({name:d||g,role:l,permissions:j})),localStorage.setItem("permissions",JSON.stringify(j)),n.success(((p=o.data)==null?void 0:p.message)||"Login successful!"),Q("/dashboard")}}else n.error("Clinic ID is missing")}else n.error(((S=o.data)==null?void 0:S.message)||"Login failed")}catch(o){console.error("Login error:",o);const r=(L=(k=o==null?void 0:o.response)==null?void 0:k.data)==null?void 0:L.message;r?r.toLowerCase().includes("username")?(h("Invalid username. Please try again."),n.error("Invalid username. Please try again.")):r.toLowerCase().includes("password")?(h("Invalid password. Please try again."),n.error("Invalid password. Please try again.")):(h(r),n.error(r)):(h("An unexpected error occurred. Please try again later."),n.error("An unexpected error occurred. Please try again later."))}finally{v(!1)}}};return e.jsxs("div",{className:"d-flex flex-column min-vh-100 derma-bg",children:[e.jsx("div",{className:"flex-grow-1 d-flex justify-content-center align-content-center align-items-center ",children:e.jsx(oe,{fluid:!0,className:"p-0 h-100   align-content-center align-items-center",children:e.jsxs(le,{className:"g-0 h-100",children:[e.jsxs(U,{md:6,className:"d-none d-md-flex flex-column justify-content-center derma-hero px-5 py-4",children:[e.jsx("div",{}),e.jsxs("div",{className:"text-center px-3",style:{color:s.primary},children:[e.jsx("img",{src:we,alt:"Derma Care",className:"mb-4",style:{width:120,height:"auto"}}),e.jsx("h2",{className:"fw-bold mb-3",style:{color:s.primary},children:"Welcome to Derma Care"}),e.jsx("p",{className:"lead mb-4",style:{opacity:.95,color:s.primary},children:"Manage dermatology operations seamlessly — appointments, records, billing & more."}),e.jsxs("div",{className:"d-flex justify-content-center gap-3 flex-wrap",children:[e.jsx("span",{className:"badge",style:{color:s.primary},children:"HIPAA-ready"}),e.jsx("span",{className:"badge",style:{color:s.primary},children:"e-Prescriptions"}),e.jsx("span",{className:"badge",style:{color:s.primary},children:"Smart Scheduling"})]})]})]}),e.jsx(U,{md:6,className:"d-flex align-items-center justify-content-center  md-5",children:e.jsx(ie,{className:"shadow-lg border-0 glass-card w-100",style:{maxWidth:460},children:e.jsxs(ne,{className:"p-4 p-md-5",children:[e.jsx("h3",{className:"text-center fw-bold mb-3",style:{color:s.primary},children:"Derma Portal"}),e.jsx("p",{className:"text-center mb-4",style:{color:s.primary},children:"Please choose your workspace to continue"}),e.jsxs(ce,{variant:"pills",className:"justify-content-center gap-2 mb-4",children:[e.jsx(F,{children:e.jsx(E,{active:c==="clinic",onClick:()=>W("clinic"),style:{backgroundColor:c==="clinic"?s.primary:s.white,color:c==="clinic"?s.white:s.primary,border:`1px solid ${s.primary}`,borderRadius:"8px",fontWeight:"500",padding:"8px 16px",cursor:"pointer"},children:"Clinic"})}),e.jsx(F,{children:e.jsx(E,{active:c==="doctor",onClick:()=>window.location.href="https://doctorweb.aesthetech.life",style:{backgroundColor:c==="doctor"?s.primary:s.white,color:c==="doctor"?s.white:s.primary,border:`1px solid ${s.primary}`,borderRadius:"8px",fontWeight:"500",padding:"8px 16px",cursor:"pointer"},children:"Doctor"})})]}),N&&e.jsx("div",{className:"alert alert-danger text-center py-2 mb-3",children:N}),c==="clinic"&&e.jsxs(de,{onSubmit:ee,noValidate:!0,children:[e.jsxs(me,{className:"mb-3",value:l,onChange:a=>G(a.target.value),children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"receptionist",children:"Receptionist"}),e.jsx("option",{value:"nurse",children:"Nurse"}),e.jsx("option",{value:"lab_technician",children:"Lab Technician"}),e.jsx("option",{value:"pharmacist",children:"Pharmacist"})]}),e.jsxs(O,{className:"mb-2",children:[e.jsx(q,{children:e.jsx(w,{icon:pe})}),e.jsx(B,{placeholder:"Username",value:u,onChange:a=>{_(a.target.value),i.userName&&y(p=>({...p,userName:""}))},"aria-invalid":!!i.userName,autoComplete:"username"})]}),i.userName&&e.jsx("small",{className:"text-danger",children:i.userName}),e.jsxs(O,{className:"mt-3 mb-2",children:[e.jsx(q,{onClick:()=>J(a=>!a),style:{cursor:"pointer"},title:C?"Hide password":"Show password",children:e.jsx(w,{icon:C?Ce:he})}),e.jsx(B,{type:C?"text":"password",placeholder:"Password",value:m,onChange:a=>{z(a.target.value),i.password&&y(p=>({...p,password:""}))},"aria-invalid":!!i.password,autoComplete:"current-password"})]}),i.password&&e.jsx("small",{className:"text-danger",children:i.password}),e.jsx("div",{className:"d-flex justify-content-between mt-2",style:{color:s.primary},children:e.jsx("a",{style:{color:s.primary},href:"#",className:"text-decoration-none derma-link",onClick:a=>{a.preventDefault(),x(!0)},children:"Forgot password?"})}),e.jsx(Z,{type:"submit",disabled:b,className:"w-100 mt-4 derma-btn",style:{backgroundColor:s.primary,color:"white"},children:b?e.jsx(re,{size:"sm"}):"Login"})]})]})})})]})})}),e.jsxs("footer",{className:"d-flex justify-content-around small py-2 opacity-75 mt-auto",style:{color:s.primary,backgroundColor:"#f8f9fa"},children:[e.jsxs("span",{className:"d-inline-flex align-items-center gap-2",style:{color:s.primary},children:[e.jsx(w,{icon:je})," Secure by design"]}),e.jsxs("span",{style:{color:s.primary},children:["© ",new Date().getFullYear()," Chiselon Technologies"]}),e.jsx("a",{href:"https://chiselontechnologies.com",target:"_blank",style:{color:s.primary},children:"About Chiselon Technologies"})]}),e.jsxs(fe,{visible:$,onClose:()=>x(!1),children:[e.jsx(ue,{children:e.jsx(ge,{children:"Reset Password"})}),e.jsx(xe,{children:e.jsx(te,{onClose:()=>x(!1)})}),e.jsx(ye,{children:e.jsx(Z,{color:"secondary",onClick:()=>x(!1),children:"Close"})})]})]})};export{Oe as default};
