import{r as n,h as k,j as t}from"./index-DzLAwNkK.js";import{A}from"./appointmentAPI-BlfzE0dK.js";import{a as j}from"./index.esm-l-WhNZwE.js";import{C as D,a as F,b as d,c as i,d as E,e as a}from"./CTable-s7emOImN.js";const U=()=>{const[f,h]=n.useState([]),[T,x]=n.useState(!0),[l,S]=n.useState([]),[B,H]=n.useState([]),y=k(),[c,p]=n.useState([]),[L,R]=n.useState([]),[V,$]=n.useState(1),[z,C]=n.useState([]),[M,v]=n.useState([]),[P,X]=n.useState([]),[q,G]=n.useState([]),[b,I]=n.useState(null),w={"Service & Treatment":"services & treatments","Video Consultation":"online consultation","In-clinic":"in-clinic consultation"},u=async e=>{try{const s=await A();if(s&&s.data){const o=e?s.data.filter(m=>r(m.clinicId)===r(e)):s.data;S(o||[]),x(!1)}}catch(s){console.error("Failed to fetch appointments:",s),S([]),x(!1)}};n.useEffect(()=>{const e=localStorage.getItem("HospitalId");e?(I(e),u(e)):(console.warn("No HospitalId found in localStorage. Displaying all relevant appointments."),u(null))},[]),n.useEffect(()=>{let e=l.filter(s=>r(s.status)==="completed");if(c.length===1){const s=c[0],o=w[s];o&&(e=e.filter(m=>r(m.consultationType)===o))}h(e)},[l,c,b]),n.useEffect(()=>{const e=[...new Set(l.map(o=>o.servicename).filter(Boolean))],s=[...new Set(l.map(o=>o.consultationType).filter(Boolean))];C(e),v(s),console.log("Available Consultation Types:",s)},[l]);const N=e=>{c.includes(e)?p([]):p([e])},g="Completed";n.useEffect(()=>{const e=l.filter(s=>{var o;return((o=s.status)==null?void 0:o.toLowerCase().trim())===g.toLowerCase().trim()});h(e)},[l,g]),n.useEffect(()=>{const e=localStorage.getItem("HospitalId");e?u(e):console.warn("No HospitalId in localStorage")},[]);const r=e=>e==null?void 0:e.toLowerCase().trim();return t.jsx("div",{style:{overflowX:"auto"},children:t.jsxs("div",{className:"container mt-4",children:[t.jsx("h5",{className:"mb-3",children:"Appointments"}),t.jsx("div",{className:"d-flex gap-2 mb-3",children:["Service & Treatment","In-clinic","Video Consultation"].map(e=>t.jsx("button",{onClick:()=>N(e),className:`btn ${c.includes(e)?"btn-dark":"btn-outline-dark"}`,children:e},e))}),t.jsx("div",{className:"mb-3",children:t.jsx(j,{color:"secondary",onClick:()=>p([]),children:"Reset Filters"})}),t.jsxs(D,{striped:!0,hover:!0,responsive:!0,children:[t.jsx(F,{children:t.jsxs(d,{children:[t.jsx(i,{children:"S.No"}),t.jsx(i,{children:"Name"}),t.jsx(i,{children:"Consultation Type"}),t.jsx(i,{children:"Date"}),t.jsx(i,{children:"Time"}),t.jsx(i,{children:"Status"}),t.jsx(i,{children:"Action"})]})}),t.jsx(E,{children:T?t.jsx(d,{children:t.jsx(a,{colSpan:"8",className:"text-center text-primary fw-bold",children:"Loading reports..."})}):f.length>0?f.map((e,s)=>t.jsxs(d,{children:[t.jsx(a,{children:s+1}),t.jsx(a,{children:e.name}),t.jsx(a,{children:e.consultationType}),t.jsx(a,{children:e.serviceDate}),t.jsx(a,{children:e.slot||e.servicetime}),t.jsx(a,{children:e.status}),t.jsx(a,{children:t.jsx(j,{color:"primary",size:"sm",onClick:()=>y(`/reportDetails/${e.bookingId}`,{state:{report:e,appointmentInfo:{name:e.name,age:e.age,gender:e.gender,problem:e.problem,bookingId:e.bookingId,item:e}}}),children:"View"})})]},`${e.bookingId}-${s}`)):t.jsx(d,{children:t.jsx(a,{colSpan:"8",className:"text-center text-danger fw-bold",children:"No completed appointments found."})})})]})]})})};export{U as default};
