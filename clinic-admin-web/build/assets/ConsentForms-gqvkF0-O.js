import{h as ne,M as Oe,O as We,S as Ke,T as Ye,V as Xe,r as n,j as e,B as M,y as Ze,E as Je,H as es,W as ve,e as re,i as te}from"./index-D0zCbO2O.js";import{b as be,c as W,d as K}from"./index-CCWDki6_.js";import{c as Y}from"./capitalizeWords-CuwF8AcI.js";import{C as Se}from"./ConfirmationModal-D7Rv99BP.js";import{C as me,a as he}from"./CCardBody-B1IvBwzE.js";import{b as G}from"./index.esm-CTRZmI6a.js";import{C as Ce}from"./CForm-2eCkyI8T.js";import{a as oe,C as ss}from"./CRow-DbSMaBo6.js";import{C as ae,b as ce}from"./CFormInput-BxUR3w9o.js";import{C as we}from"./CInputGroup-CYN8QgWb.js";import{C as Ie,a as Fe}from"./CListGroupItem-BgMCY7ya.js";import{C as Ae,a as Ne,b as ke,c as Pe}from"./CAccordionItem-BADAyxXM.js";import{S as rs}from"./react-select.esm-DwCNSvZI.js";import{C as ye}from"./CFormSelect-BE-mEusy.js";import{C as ts,a as ie,b as le}from"./CNavItem-B31luXr5.js";import{a as os,b as de}from"./DefaultLayout-C-KWYAVx.js";import"./CModalHeader-BWz13Y6W.js";import"./CModalTitle-FDE781Yk.js";import"./CModalFooter-DhtUFWSj.js";import"./CFormLabel-CDfh8m4I.js";import"./defineProperty-DevPl9dM.js";import"./slicedToArray-D6Gft5C9.js";import"./CustomerViewDetails-DHdEXT0k.js";const Ee=async(h,m,u)=>{try{const f=await ne.post(`${Ke}/${m}/${u}`,h,{headers:{"Content-Type":"application/json"}});return console.log("Add API response:",f.data),f.data}catch(f){throw console.error("Error response from API:",f.response||f.message),f}},qe=async(h,m,u)=>{try{return(await ne.put(`${We}/${m}/${u}`,h,{headers:{"Content-Type":"application/json"}})).data}catch(f){throw console.error("Error updating consentForm:",f.response||f.message),f}},Qe=async h=>{try{const m=await ne.delete(`${Ye}/${h}`,{headers:{"Content-Type":"application/json"}});return console.log("ConsentForm deleted successfully:",m.data),m.data}catch(m){throw console.error("Error deleting ConsentForm:",m.response||m.message),m}},ue=async(h,m)=>{try{const u=await ne.get(`${Oe}/${h}/${m}`);return console.log("Fetched data:",u.data),u.data}catch(u){throw console.error("Error fetching test data:",u.response||u.message),u}},je=async(h,m)=>{try{const u=await ne.get(`${Xe}/${h}/${m}`);return console.log("Procedure Consent Form data:",u.data),u.data}catch(u){throw console.error("Error fetching Procedure Form data:",u.message),u.response&&(console.error("Error Response Data:",u.response.data),console.error("Error Response Status:",u.response.status)),u}},ns=()=>{const[h,m]=n.useState(!1),[u,f]=n.useState([]),[y,S]=n.useState([]),[j,A]=n.useState(""),[Q,w]=n.useState(""),[v,F]=n.useState([]),[V,U]=n.useState(null),[X,B]=n.useState(null),[l,p]=n.useState({}),[N,k]=n.useState(!1),[_,P]=n.useState(null),[E,L]=n.useState(null),[Z,J]=n.useState(!1),C=localStorage.getItem("HospitalId"),T="1";n.useEffect(()=>{(async()=>{try{const o=await ue(C,T);if(console.log("✅ Forms from API:",o.data),o!=null&&o.data){const x=(Array.isArray(o.data)?o.data:[o.data]).map(g=>({...g,consentFormQuestions:g.consentFormQuestions||[]}));f(x)}}catch(o){console.error("Error fetching saved forms",o)}})()},[C,T]);const O=()=>{if(Q.trim()){if(V!==null){const a=[...v];a[V]=Q.trim(),F(a),U(null)}else v.includes(Q.trim())||F([...v,Q.trim()]);w("")}},ee=a=>{F(v.filter(o=>o!==a))},z=()=>{const a=j.trim();if(!a||v.length===0){if(a===""&&v.length===0)return;M.error("Please add a question and at least one answer.");return}if(y.some(o=>o.question===a)){M.error("This question already exists.");return}S([...y,{question:a,answers:[...v]}]),A(""),F([])},se=a=>{S(y.filter((o,d)=>d!==a))},$=async()=>{const a={};if(y.length===0&&(a.qaList="At least one question is required."),Object.keys(a).length>0){p(a);return}p({});const o={consentFormQuestions:y.map(d=>({heading:d.question,questionsAndAnswers:d.answers.map(x=>({question:x,answer:!0}))}))};try{X!==null?await qe(o,C,T):await Ee(o,C,T);const d=await ue(C,T);d!=null&&d.data&&f(Array.isArray(d.data)?d.data:[d.data]),S([]),m(!1),B(null),J(!1)}catch(d){console.error("Error saving Generic Form:",d)}},H=a=>{const o=u[a];if(!o){M.error("Selected form not found");return}const d=(o.consentFormQuestions||[]).map(x=>({question:x.heading,answers:(x.questionsAndAnswers||[]).map(g=>g.question)}));S(d),B(a),m(!0),p({})},q=async a=>{const o=u[a],d=(o==null?void 0:o.id)||(o==null?void 0:o.consentFormId)||(o==null?void 0:o.formId);if(!d){M.error("This form cannot be deleted.");return}try{await Qe(d),f(u.filter((x,g)=>g!==a)),J(!1)}catch(x){console.error("Error deleting Generic Form:",x),M.error("Failed to delete form.")}},R=a=>{const o=y[a];A(o.question),F(o.answers),S(y.filter((d,x)=>x!==a))};return e.jsxs(me,{className:"mt-3",children:[e.jsxs(he,{children:[!h&&e.jsx("div",{className:"w-100 d-flex justify-content-end",children:e.jsx(G,{style:{color:"var(--color-black)",backgroundColor:"var(--color-bgcolor)"},onClick:()=>{m(!0),S([]),B(null),J(!0)},disabled:Z||u.length>0,children:"+ Add Generic Form"})}),h&&e.jsxs(Ce,{className:"mb-4",children:[e.jsxs(oe,{md:12,children:[e.jsx("h6",{className:"mb-2",children:"Question"}),e.jsx(ae,{placeholder:"Enter question",value:j,onChange:a=>A(a.target.value)}),e.jsx("h6",{className:"mt-3 mb-2",children:"Answers"}),e.jsxs(we,{className:"mb-2",children:[e.jsx(ae,{placeholder:"Enter answer",value:Q,onChange:a=>w(a.target.value)}),e.jsx(G,{onClick:O,style:{backgroundColor:"var(--color-black)",color:"white"},children:e.jsx(be,{})})]}),v.length>0&&e.jsx(Ie,{className:"mb-3",children:v.map((a,o)=>e.jsxs(Fe,{className:"d-flex justify-content-between align-items-center",children:[a,e.jsxs("div",{children:[e.jsx(W,{onClick:()=>{w(a),U(o)},style:{cursor:"pointer",color:"var(--color-black)",marginRight:"10px"}}),e.jsx(K,{onClick:()=>ee(a),style:{cursor:"pointer",color:"var(--color-black)"}})]})]},o))}),e.jsx(G,{color:"info",className:"me-2",onClick:z,style:{backgroundColor:"var(--color-bgcolor)",color:"var(--color-black)",border:"none"},children:"Add Question"})]}),y.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Questions Added"}),y.map((a,o)=>e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:a.question}),e.jsx("ul",{children:a.answers.map((d,x)=>e.jsx("li",{children:d},x))}),e.jsxs("div",{children:[e.jsx(W,{onClick:()=>R(o),style:{cursor:"pointer",color:"var(--color-black)",marginRight:"10px"}}),e.jsx(K,{onClick:()=>se(o),style:{cursor:"pointer",color:"var(--color-black)"}})]})]},o))]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(G,{color:"secondary",className:"me-2",onClick:()=>m(!1),children:"Cancel"}),e.jsx(G,{style:{backgroundColor:"var(--color-bgcolor)",color:"var(--color-black)",border:"none"},onClick:$,children:X!==null?"Update Generic Form":"Save Generic Form"})]})]}),u.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h6",{children:"Saved Generic Forms"}),e.jsx(Ae,{children:u.map((a,o)=>e.jsxs(Ne,{itemKey:o,children:[e.jsx(ke,{children:Y(a.subServiceName)||" Generic Consent Form"}),e.jsxs(Pe,{children:[Array.isArray(a.consentFormQuestions)&&a.consentFormQuestions.map((d,x)=>e.jsxs("div",{children:[e.jsx("h6",{children:Y(d.heading)}),Array.isArray(d.questionsAndAnswers)&&d.questionsAndAnswers.map((g,D)=>e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("input",{type:"checkbox",className:"me-2",disabled:!0,checked:g.answer===void 0?!0:!!g.answer}),e.jsx("span",{children:Y(g.question)})]},D))]},x)),e.jsxs("div",{className:"d-flex gap-3 mt-2",children:[e.jsx(W,{onClick:()=>H(o),style:{color:"var(--color-black)",cursor:"pointer"}}),e.jsx(K,{onClick:()=>{P(o),k(!0),L(a.subServiceName)},style:{color:"var(--color-black)",cursor:"pointer"}})]})]})]},o))})]})]}),e.jsx(Se,{isVisible:N,title:"Delete ProcedureConsentForm",message:`Are you sure you want to delete this "${E}" ? This action cannot be undone.`,confirmText:"Yes, Delete",cancelText:"Cancel",confirmColor:"danger",cancelColor:"secondary",onConfirm:()=>{_!==null&&(q(_),P(null)),k(!1)},onCancel:()=>{P(null),k(!1)}})]})},as=()=>{const[h,m]=n.useState([]),[u,f]=n.useState([]),[y,S]=n.useState([]),[j,A]=n.useState([]),[Q,w]=n.useState(!1),[v,F]=n.useState([]),[V,U]=n.useState(null),[X,B]=n.useState(!1),[l,p]=n.useState(!0),[N,k]=n.useState(null),[_,P]=n.useState(!1),[E,L]=n.useState(null),[Z,J]=n.useState(null),[C,T]=n.useState({categoryId:"",serviceId:"",subServiceid:"",subServiceName:"",consentFormQuestions:[]}),[O,ee]=n.useState(""),[z,se]=n.useState(""),[$,H]=n.useState([]),[q,R]=n.useState([]),[a,o]=n.useState(null),[d,x]=n.useState({}),g=localStorage.getItem("HospitalId"),D="2";n.useEffect(()=>{(async()=>{var s;try{const t=await Ze();Array.isArray(t.data)?m(t.data):Array.isArray((s=t.data)==null?void 0:s.data)?m(t.data.data):m([])}catch(t){console.error("Error fetching categories:",t)}})()},[]),n.useEffect(()=>{(async()=>{console.log(g),console.log(D);try{const s=await ue(g,D);s!=null&&s.data&&F(Array.isArray(s.data)?s.data:[s.data])}catch(s){console.error("Error fetching saved forms",s)}})()},[g]),n.useEffect(()=>{if(!C.categoryId){f([]);return}(async()=>{try{const s=await Je(C.categoryId);f((s==null?void 0:s.data)||[])}catch(s){console.error("Error fetching services",s),f([])}})()},[C.categoryId]),n.useEffect(()=>{if(!C.serviceId){S([]);return}(async()=>{try{const s=await es(C.serviceId),t=(s==null?void 0:s.data)||[];let i=[];Array.isArray(t)?i=t.flatMap(c=>c.subServices||[]):t!=null&&t.subServices&&(i=t.subServices),console.log(i),S(i)}catch(s){console.error("Error fetching subServices",s),S([])}})()},[C.serviceId]),n.useEffect(()=>{(async()=>{try{const s=await je(g,D);if(console.log("✅ Forms from API:",s.data),s!=null&&s.data){const t=(Array.isArray(s.data)?s.data:[s.data]).map(i=>({...i,consentFormQuestions:i.consentFormQuestions||[]}));F(t)}}catch(s){console.error("Error fetching saved forms",s)}})()},[g,D]);const pe=r=>{const{name:s,value:t}=r.target;T(i=>{const c={...i,[s]:t};return s==="categoryId"&&(c.serviceId="",c.subServiceid=""),s==="serviceId"&&(c.subServiceid=""),c})},fe=async r=>{let s=!1;const t=localStorage.getItem("HospitalId");for(const i of r){const c=await ve(t,i);if(!c||!c.price||!c.finalCost){s=!0;break}}p(!s)},Te=()=>{if(z.trim()){if(V!==null){const r=[...$];r[V]=z.trim(),H(r),U(null)}else $.includes(z.trim())||H([...$,z.trim()]);se("")}},$e=r=>{H($.filter(s=>s!==r))},Ge=()=>{if(O.trim()&&$.length>0){if(q.some(r=>r.question===O.trim())){alert("This question already exists.");return}R([...q,{question:O.trim(),answers:[...$]}]),ee(""),H([])}},De=r=>{R(q.filter((s,t)=>t!==r))},Me=async()=>{const r={};if((!j||j.length===0)&&(r.subServiceName="At least one Procedure must be selected."),q.length===0&&(r.qaList="At least one question is required."),Object.keys(r).length>0){x(r);return}x({});const s=j.map(t=>({subServiceid:t,consentFormQuestions:q.map(i=>({heading:i.question,questionsAndAnswers:i.answers.map(c=>({question:c,answer:!0}))}))}));try{if(a!==null)await qe(s[0],g,D);else for(const i of s)await Ee(i,g,D);const t=await je(g,D);t!=null&&t.data&&F(Array.isArray(t.data)?t.data:[t.data]),T({categoryId:"",serviceId:"",subServiceid:"",subServiceName:"",consentFormQuestions:[]}),R([]),A([]),w(!1),o(null)}catch(t){console.error("Error saving Procedure Form:",t)}},Ue=async r=>{var s;try{const t=v[r];if(!t){M.error("Selected form not found");return}const i=t.subServiceid??t.subServiceId??((s=t==null?void 0:t.subService)==null?void 0:s.subServiceId)??(t==null?void 0:t.id);i||console.warn("No subService id found on selected form:",t);let c=null;if(i)try{c=await ve(g,i)}catch(b){console.warn("getSubServiceById failed:",b)}const I=i??(c==null?void 0:c.subServiceId)??"",xe=(c==null?void 0:c.subServiceName)??t.subServiceName??"",Re=(c==null?void 0:c.serviceId)??t.serviceId??"",Ve=(c==null?void 0:c.categoryId)??t.categoryId??"";c?S(b=>b.some(He=>String(He.subServiceId)===String(c.subServiceId))?b:[...b,c]):I&&!y.some(b=>String(b.subServiceId)===String(I))&&S(b=>[...b,{subServiceId:I,subServiceName:xe||"Unknown"}]),T({categoryId:Ve||"",serviceId:Re||"",subServiceid:I||"",subServiceName:xe||"",consentFormQuestions:t.consentFormQuestions||[]}),A(I?[I]:[]);const _e=(t.consentFormQuestions||[]).map(b=>({question:b.heading,answers:(b.questionsAndAnswers||[]).map(ge=>ge.question)}));R(_e),o(r),w(!0),x({});const ze=v.some(b=>String(b.subServiceid??b.subServiceId??"")===String(I));B(!ze),I&&fe([I])}catch(t){console.error("Error in editProcedureForm:",t),M.error("Unable to prepare edit form. Check console for details.")}},Be=async r=>{const s=v[r],t=(s==null?void 0:s.id)||(s==null?void 0:s.consentFormId)||(s==null?void 0:s.formId);if(!(s!=null&&s.id)){M.error("This form does not have an ID and cannot be deleted.");return}try{await Qe(t);const i=v.filter((c,I)=>I!==r);F(i)}catch(i){console.error("Error deleting Procedure Form:",i),M.error("Failed to delete procedure form.")}},Le=r=>{const s=q[r];ee(s.question),H(s.answers);const t=q.filter((i,c)=>c!==r);R(t)};return e.jsxs(me,{className:"mt-3",children:[e.jsxs(he,{children:[!Q&&e.jsx("div",{className:"  w-100",style:{display:"flex",justifyContent:"end",alignContent:"end",alignItems:"end"},children:e.jsx(G,{style:{color:"var(--color-black)",backgroundColor:"var(--color-bgcolor)"},onClick:()=>{w(!0),T({categoryId:"",serviceId:"",subServiceid:"",subServiceName:"",consentFormQuestions:[]}),R([]),o(null)},children:"+ Add Procedure Form"})}),Q&&e.jsxs(Ce,{className:"mb-4",children:[e.jsxs(ss,{className:"mb-4",children:[e.jsxs(oe,{md:4,children:[e.jsxs("h6",{children:["Category Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(ye,{value:C.categoryId||"",onChange:pe,name:"categoryId","aria-label":"Select Category",children:[e.jsx("option",{value:"",children:"Select a Category"}),h==null?void 0:h.map(r=>e.jsx("option",{value:r.categoryId,children:r.categoryName},r.categoryId))]}),d.categoryId&&e.jsx(ce,{className:"text-danger",children:d.categoryId})]}),e.jsxs(oe,{md:4,children:[e.jsxs("h6",{children:["Service Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(ye,{name:"serviceId",value:C.serviceId||"",onChange:pe,children:[e.jsx("option",{value:"",children:"Select Service"}),u.map(r=>e.jsx("option",{value:r.serviceId,children:r.serviceName},r.serviceId))]}),d.serviceId&&e.jsx(ce,{className:"text-danger",children:d.serviceId})]}),e.jsxs(oe,{md:4,children:[e.jsxs("h6",{children:["Procedure Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(rs,{isMulti:!0,name:"subServiceName",placeholder:"Select Sub Services",options:(y||[]).map(r=>({label:r.subServiceName,value:r.subServiceId})),value:(y||[]).filter(r=>j.includes(r.subServiceId)).map(r=>({label:r.subServiceName,value:r.subServiceId})),onChange:r=>{const s=r.map(i=>i.value);A(s),r.length>0&&x(i=>({...i,subServiceName:""}));const t=s.some(i=>!v.some(c=>String(c.subServiceid)===String(i)));B(t),fe(s)}}),!l&&e.jsxs("div",{className:"text-danger mt-2",children:["Some selected Procedures are missing details like price or final cost.",e.jsx("br",{}),e.jsx("a",{href:"/procedure-Management",className:"text-primary",children:"Please add Procedure details"})]}),d.subServiceName&&e.jsx(ce,{className:"text-danger",children:d.subServiceName})]})]}),e.jsxs(oe,{md:12,children:[e.jsx("h6",{className:"mb-2",children:"Question"}),e.jsx(ae,{placeholder:"Enter question",value:O,onChange:r=>ee(r.target.value)}),e.jsx("h6",{className:"mt-3 mb-2",children:"Answers"}),e.jsxs(we,{className:"mb-2",children:[e.jsx(ae,{placeholder:"Enter answer",value:z,onChange:r=>se(r.target.value)}),e.jsx(G,{onClick:Te,style:{backgroundColor:"var(--color-black)",color:"white"},children:e.jsx(be,{})})]}),$.length>0&&e.jsx(Ie,{className:"mb-3",children:$.map((r,s)=>e.jsxs(Fe,{className:"d-flex justify-content-between align-items-center",children:[r,e.jsxs("div",{children:[e.jsx(W,{onClick:()=>{se(r),U(s)},style:{cursor:"pointer",color:"var(--color-black)",marginRight:"10px"}}),e.jsx(K,{onClick:()=>$e(r),style:{cursor:"pointer",color:"var(--color-black)"}})]})]},s))}),e.jsx(G,{color:"info",className:"me-2  ",onClick:Ge,style:{backgroundColor:"var(--color-bgcolor)",color:"var(--color-black)",border:"none"},children:"Add Question"})]}),q.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Questions Added"}),q.map((r,s)=>e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:r.question}),e.jsx("ul",{children:r.answers.map((t,i)=>e.jsx("li",{children:t},i))}),e.jsxs("div",{children:[e.jsx(W,{onClick:()=>Le(s),style:{cursor:"pointer",color:"var(--color-black)",marginRight:"10px"}}),e.jsx(K,{onClick:()=>De(s),style:{cursor:"pointer",color:"var(--color-black)"}})]})]},s))]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(G,{color:"secondary",className:"me-2",onClick:()=>w(!1),children:"Cancel"}),e.jsx(G,{style:{backgroundColor:"var(--color-bgcolor)",color:"var(--color-black)",border:"none"},onClick:Me,children:a!==null?"Update Procedure Form":"Save Procedure Form"})]})]}),v.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h6",{children:"Saved Procedure Forms"}),e.jsx(Ae,{children:v.map((r,s)=>e.jsx(e.Fragment,{children:e.jsxs(Ne,{itemKey:s,children:[e.jsx(ke,{children:Y(r.subServiceName)||"Unnamed Procedure"}),e.jsxs(Pe,{children:[Array.isArray(r.consentFormQuestions)&&r.consentFormQuestions.map((t,i)=>e.jsxs("div",{children:[e.jsx("h6",{children:Y(t.heading)}),Array.isArray(t.questionsAndAnswers)&&t.questionsAndAnswers.map((c,I)=>e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("input",{type:"checkbox",checked:c.answer===void 0?!0:!!c.answer,className:"me-2",disabled:!0}),e.jsx("span",{children:Y(c.question)})]},I))]},i)),e.jsxs("div",{className:"d-flex gap-3 mt-2",children:[e.jsx(W,{onClick:()=>Ue(s),style:{color:"var(--color-black)",cursor:"pointer"}}),e.jsx(K,{onClick:()=>{L(s),P(!0),J(r.subServiceName)},style:{color:"var(--color-black)",cursor:"pointer"}})]})]})]},s)}))})]})]}),e.jsx(Se,{isVisible:_,title:"Delete Procedure Consent",message:`Are you sure you want to delete this "${Z}" ? This action cannot be undone.`,confirmText:"Yes, Delete",cancelText:"Cancel",confirmColor:"danger",cancelColor:"secondary",onConfirm:()=>{E!==null&&(Be(E),L(null)),P(!1)},onCancel:()=>{L(null),P(!1)}})]})},cs=()=>{const[h,m]=n.useState(null),[u,f]=n.useState([]),[y,S]=n.useState({}),[j,A]=n.useState(null),Q=20*1024*1024,w=async()=>{var l;try{const p=await re.get(`${te}/getAllPolicies`);(l=p.data)!=null&&l.data?f(p.data.data):Array.isArray(p.data)&&f(p.data)}catch(p){console.error("Error fetching policies:",p)}};n.useEffect(()=>{w()},[]);const v=l=>{const p=l.target.files[0];if(p){if(p.size>Q){alert("File is too large! Maximum allowed size is 20 MB.");return}m(p)}},F=()=>{if(!h)return alert("Please select a file first.");const l=new FileReader;l.readAsDataURL(h),l.onload=async()=>{const p=l.result.split(",")[1];try{await re.post(`${te}/createPolicy`,{fileName:h.name,privacyPolicy:p},{headers:{"Content-Type":"application/json"}}),alert("File uploaded successfully!"),m(null),w()}catch(N){console.error("Upload error:",N.response||N),alert("File upload failed. Check console for details.")}}},V=async l=>{var p,N;try{if(y[l.id]){const k=y[l.id];A({id:l.id,fileName:l.fileName,dataUrl:k.dataUrl,mimeType:k.mimeType})}else{const _=(N=(p=(await re.get(`${te}/getPolicyById/${l.id}`)).data)==null?void 0:p.data)==null?void 0:N.privacyPolicy;if(!_)return alert("No file data available.");const P=l.fileName.split(".").pop().toLowerCase();let E="application/octet-stream";P==="pdf"?E="application/pdf":["jpg","jpeg"].includes(P)?E="image/jpeg":P==="png"&&(E="image/png");const L=`data:${E};base64,${_}`;S(Z=>({...Z,[l.id]:{dataUrl:L,mimeType:E}})),A({id:l.id,fileName:l.fileName,dataUrl:L,mimeType:E})}}catch(k){console.error("View error:",k.response||k),alert("Unable to fetch file.")}},U=()=>A(null),X=async l=>{const p=prompt("Enter new file name",l.fileName||"");if(!(!p||p===l.fileName))try{await re.put(`${te}/updatePolicy/${l.id}`,{fileName:p},{headers:{"Content-Type":"application/json"}}),alert("Policy updated successfully!"),w()}catch(N){console.error("Update error:",N.response||N),alert("Update failed. Check console for details.")}},B=async l=>{if(window.confirm("Are you sure you want to delete this policy?"))try{await re.delete(`${te}/deletePolicyById/${l}`),alert("Policy deleted successfully!"),w()}catch(p){console.error("Delete error:",p.response||p),alert("Delete failed. Check console for details.")}};return e.jsxs("div",{style:{padding:"20px",maxWidth:"700px"},children:[e.jsx("h3",{children:"Privacy Policy Manager"}),e.jsx("input",{type:"file",accept:"*/*",onChange:v,style:{display:"block",marginBottom:"10px"}}),h&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"20px"},children:[e.jsx("span",{children:h.name}),e.jsx("button",{onClick:F,children:"Upload"})]}),e.jsx("hr",{style:{margin:"20px 0"}}),e.jsx("h4",{children:"Existing Policies"}),u.length===0&&e.jsx("p",{children:"No policies found."}),u.map(l=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",borderBottom:"1px solid #ccc",alignItems:"center"},children:[e.jsx("span",{children:l.fileName}),e.jsxs("div",{children:[e.jsx("button",{style:{marginRight:"5px"},onClick:()=>V(l),children:"View"}),e.jsx("button",{style:{marginRight:"5px"},onClick:()=>X(l),children:"Edit"}),e.jsx("button",{onClick:()=>B(l.id),children:"Delete"})]})]},l.id)),j&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},onClick:U,children:e.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",maxWidth:"80%",maxHeight:"80%",overflow:"auto"},onClick:l=>l.stopPropagation(),children:[e.jsx("h4",{children:j.fileName}),j.mimeType==="application/pdf"?e.jsx("iframe",{src:j.dataUrl,title:j.fileName,width:"100%",height:"500px"}):e.jsx("img",{src:j.dataUrl,alt:j.fileName,style:{maxWidth:"100%",maxHeight:"500px"}}),e.jsx("button",{onClick:U,style:{marginTop:"10px"},children:"Close"})]})})]})},Es=()=>{const[h,m]=n.useState(1);return e.jsx(me,{children:e.jsxs(he,{children:[e.jsxs(ts,{variant:"tabs",style:{cursor:"pointer",color:"var(--color-black)"},children:[e.jsx(ie,{children:e.jsx(le,{active:h===1,onClick:()=>m(1),style:{color:"var(--color-black)"},children:"Generic Consent Form"})}),e.jsx(ie,{children:e.jsx(le,{active:h===2,onClick:()=>m(2),style:{color:"var(--color-black)"},children:"Procedure Consent Form"})}),e.jsx(ie,{children:e.jsx(le,{active:h===3,onClick:()=>m(3),style:{color:"var(--color-black)"},children:"Privacy Policy Consent Form"})})]}),e.jsxs(os,{children:[e.jsx(de,{visible:h===1,children:e.jsx(ns,{})}),e.jsx(de,{visible:h===2,children:e.jsx(as,{})}),e.jsx(de,{visible:h===3,children:e.jsx(cs,{})})]})]})})};export{Es as default};
