import{r as d,j as e,B as y,h as Z,i as Y,a as ue,b as he,R as xe}from"./index-CE8wgZIf.js";import{a as J,f as je}from"./Features-D45jZVjg.js";import{c as M}from"./capitalizeWords-CuwF8AcI.js";import{U as ge}from"./UserPermissionModal-CzldWoA8.js";import{v as w}from"./Validators-Dx98MvA1.js";import{C as le,a as ne,b as ce}from"./CModalHeader-bTJJxI9I.js";import{C as be}from"./CModalTitle-B0ZxrCNp.js";import{C as pe}from"./CForm-C9vHVwto.js";import{C as g}from"./CFormLabel-1p4Lfu_H.js";import{C as v}from"./CFormInput-Po4QMieX.js";import{C as ve}from"./CFormSelect-CaEax12Y.js";import{C as fe}from"./CFormTextarea-CygHvoyJ.js";import{C as me}from"./CModalFooter-26nQh_i4.js";import{b as B}from"./index.esm-D3SzBvqQ.js";import{C as Ne}from"./ConfirmationModal-CS0aBXT7.js";import{L as ye}from"./loader-CsxI0wUU.js";import{C as Ce,a as ke,b as re,c as F,d as we,e as A}from"./CTable-D7EOl3_R.js";import{E as Se}from"./eye-vIkjkHwb.js";import{P as De,T as Ie}from"./trash-2-B9Iv_Lgk.js";import"./CNavItem-D_DanzKb.js";const Ae=({visible:f,onClose:S,onSave:W,initialData:I,viewMode:P,technicians:C,fetchTechs:oe})=>{const $={},D={clinicId:localStorage.getItem("HospitalId"),branchId:localStorage.getItem("branchId"),hospitalName:localStorage.getItem("HospitalName"),fullName:"",gender:"male",dateOfBirth:"",contactNumber:"",emailId:"",govermentId:"",dateOfJoining:"",department:"",role:"security",address:{houseNo:"",street:"",landmark:"",city:"",state:"",postalCode:"",country:"India"},bankAccountDetails:{accountNumber:"",accountHolderName:"",ifscCode:"",bankName:"",branchName:"",panCardNumber:""},medicalFitnessCertificate:"",profilePicture:"",policeVerification:"",previousEmployeeHistory:"",traningOrGuardLicense:"",permissions:$,userName:"",password:""},[t,b]=d.useState(D),[ie,q]=d.useState(localStorage.getItem("HospitalId")),[de,V]=d.useState(!1),[R,L]=d.useState(!1),[Q,_]=d.useState(null),[T,K]=d.useState(!1),[m,u]=d.useState({}),H=["fullName","dateOfBirth","gender","contactNumber","govermentId","dateOfJoining","department","address.houseNo","address.street","address.city","address.state","address.postalCode","address.country","bankAccountDetails.accountNumber","bankAccountDetails.accountHolderName","bankAccountDetails.bankName","bankAccountDetails.branchName","bankAccountDetails.ifscCode","bankAccountDetails.panCardNumber","policeVerification","medicalFitnessCertificate"];function X(s,r){const a=[];for(const l of r){const i=l.split(".");let n=s;for(const p of i)n=n==null?void 0:n[p];(!n||String(n).trim()==="")&&a.push(l)}return a}const U=s=>{b(r=>{const a={...r.permissions};return a[s]?delete a[s]:a[s]=[],{...r,permissions:a}})},E=(s,r)=>{b(a=>{const l={...a.permissions};return l[s]||(l[s]=[]),l[s].includes(r)?l[s]=l[s].filter(i=>i!==r):l[s]=[...l[s],r],{...a,permissions:l}})},ee=s=>{b(r=>{const a={...r.permissions};return a[s]?a[s].length===J.length?a[s]=[]:a[s]=[...J]:a[s]=[...J],{...r,permissions:a}})},se=s=>new Promise((r,a)=>{const l=new FileReader;l.readAsDataURL(s),l.onload=()=>r(l.result),l.onerror=i=>a(i)});d.useEffect(()=>{b(I||D)},[I]);const x=(s,r)=>{b(l=>({...l,[s]:r}));const a=w(s,r,{...t,[s]:r},C);u(l=>({...l,[s]:a}))},j=(s,r,a)=>{b(l=>({...l,[s]:{...l[s],[r]:a}}))},G=(s,r)=>{const a=w(s,r,t,C);u(l=>({...l,[s]:a}))},O=(s,r)=>{const a=s.target.files[0];if(!a)return;const l=new FileReader;l.onloadend=()=>{b(i=>({...i,[r]:l.result,[`${r}Name`]:a.name,[`${r}Type`]:a.type}))},l.readAsDataURL(a)},ae=()=>{const s=X(t,H);if(s.length>0){y.error(`Please fill required fields: ${s.join(", ")}`);return}if(t.dateOfBirth){const n=new Date(t.dateOfBirth),p=new Date,k=p.getFullYear()-n.getFullYear();if((p.getMonth()<n.getMonth()||p.getMonth()===n.getMonth()&&p.getDate()<n.getDate()?k-1:k)<18){y.error("Technician must be at least 18 years old.");return}}if(!/^[6-9]\d{9}$/.test(t.contactNumber)){y.error("Contact number must be 10 digits and start with 6-9.");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.emailId)){y.error("Please enter a valid email address.");return}if(C==null?void 0:C.some(n=>n.contactNumber===t.contactNumber&&n.id!==t.id)){y.error("Contact number already exists!");return}if(C==null?void 0:C.some(n=>n.emailId===t.emailId&&n.id!==t.id)){y.error("Email already exists!");return}console.log(t),W(t),b(D),S()},c=()=>{V(!1),_(null),K(!1)},o=s=>{try{return atob(s)}catch{return null}},N=({title:s,children:r})=>e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold border-b pb-2 mb-4",children:s}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:r})]}),h=({label:s,value:r})=>e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 fw-bold",children:s}),e.jsx("p",{className:"text-base text-gray-900 text-break",children:r||"N/A"})]}),z=({label:s,value:r})=>e.jsxs("div",{className:"col-span-3",children:[s&&e.jsx("p",{className:"text-sm font-medium text-gray-600 fw-bold",children:s}),e.jsx("p",{className:"text-base text-gray-900 text-break",children:r||"N/A"})]});return e.jsxs(e.Fragment,{children:[e.jsxs(le,{visible:f,onClose:S,size:"lg",className:"custom-modal",backdrop:"static",children:[e.jsx(ne,{children:e.jsx(be,{children:P?"Personal Information":"Add / Edit Security"})}),e.jsx(ce,{children:P?e.jsxs("div",{className:"p-4 border rounded shadow-sm bg-white ",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"fw-bold ",children:"Name : "}),e.jsx("span",{children:t.fullName})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"fw-bold",children:"Email : "}),e.jsx("span",{children:t.emailId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"fw-bold",children:"Cantact : "}),e.jsx("span",{children:t.contactNumber})]})]}),e.jsxs("div",{className:"text-center",children:[t.profilePicture?e.jsx("img",{src:o(t.profilePicture),alt:t.fullName,width:"80",height:"80",style:{borderRadius:"50%",objectFit:"cover",border:"1px solid var(--color-black)"}}):e.jsx("img",{src:"/assets/images/default-avatar.png",alt:"No profile",width:"40",height:"40",style:{borderRadius:"50%",objectFit:"cover",border:"1px solid var(--color-black)"}}),e.jsxs("div",{style:{color:"var(--color-black)",marginTop:"5px",fontSize:"14px",fontWeight:"500"},children:["ID: ",t.id]})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"space-y-5 mt-5",children:[e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Full Name",value:t.fullName})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Email",value:t.emailId})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Contact",value:t.contactNumber})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Gender",value:t.gender})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Date of Birth",value:t.dateOfBirth})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Government ID",value:t.govermentId})})]}),e.jsx(N,{title:"Work Information",children:e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Date of Joining",value:t.dateOfJoining})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Department",value:t.department})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Training or Guard License",value:t.traningOrGuardLicense})})]})}),e.jsx(N,{title:"Address",children:e.jsx(z,{value:`${t.address.houseNo}, ${t.address.street}, ${t.address.city}, ${t.address.state} - ${t.address.postalCode}, ${t.address.country}`})}),e.jsx(N,{title:"Bank Details",children:e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Account Number",value:t.bankAccountDetails.accountNumber})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Account Holder Name",value:t.bankAccountDetails.accountHolderName})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"IFSC Code",value:t.bankAccountDetails.ifscCode})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Bank Name",value:t.bankAccountDetails.bankName})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"Branch Name",value:t.bankAccountDetails.branchName})}),e.jsx("div",{className:"col-md-4",children:e.jsx(h,{label:"PAN Card",value:t.bankAccountDetails.panCardNumber})})]})}),e.jsx("div",{className:"mt-4"}),e.jsx(N,{title:"Other Information ",children:e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(z,{label:"Previous Employment",value:t.previousEmployeeHistory})}),e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(z,{label:"User Name",value:t.userName})}),e.jsx("div",{className:"col-md-6",children:e.jsx(z,{label:"Password",value:t.password})})]})]})})]})]}):e.jsxs(pe,{children:[e.jsx("h5",{children:"Basic Information"}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-5",children:[e.jsxs(g,{children:["ClinicID ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{value:ie,disabled:!0,onChange:s=>x("clinicId",s.target.value)})]}),e.jsxs("div",{className:"col-md-7",children:[e.jsxs(g,{children:["Role ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{value:t.role,disabled:!0,onChange:s=>x("role",s.target.value)})]})]})}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(g,{children:["Full Name ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{value:t.fullName,onChange:s=>x("fullName",s.target.value),onBlur:()=>G("fullName",t.fullName)}),m.fullName&&e.jsx("div",{className:"text-danger mt-1",children:m.fullName})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(g,{children:["Gender ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs(ve,{value:t.gender,onChange:s=>x("gender",s.target.value),children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsxs(g,{children:["Date of Birth ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{type:"date",value:t.dateOfBirth,max:new Date(new Date().setFullYear(new Date().getFullYear()-18)).toISOString().split("T")[0],onChange:s=>x("dateOfBirth",s.target.value)})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(g,{children:["Contact Number ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{type:"text",maxLength:10,value:t.contactNumber,onChange:s=>{const r=s.target.value;if(/^\d*$/.test(r)){x("contactNumber",r);const a=validators.contactNumber(r);u(l=>({...l,contactNumber:a}))}}}),m.contactNumber&&e.jsx("div",{className:"text-danger mt-1",children:m.contactNumber})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx(g,{children:"Email"}),e.jsx(v,{type:"email",value:t.emailId,onChange:s=>{const r=s.target.value;x("emailId",r);const a=validators.email(r);u(l=>({...l,emailId:a}))}}),m.emailId&&e.jsx("div",{className:"text-danger mt-1",children:m.emailId})]})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsxs(g,{children:["GovernmentID(AadharCard No) ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{maxLength:12,value:t.govermentId,onChange:s=>{const r=s.target.value;if(/^\d*$/.test(r)){x("govermentId",r);const a=w("governmentId",r,t);u(l=>({...l,govermentId:a}))}},onBlur:()=>{const s=w("governmentId",t.govermentId,t);u(r=>({...r,govermentId:s}))}}),m.govermentId&&e.jsx("div",{className:"text-danger mt-1",children:m.govermentId})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(g,{children:["Police Verification  ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{value:M(t.policeVerification),onChange:s=>{x("policeVerification",s.target.value);const r=w("policeVerification",s.target.value,t);u(a=>({...a,policeVerification:r}))},onBlur:()=>{const s=w("policeVerification",t.policeVerification,t);u(r=>({...r,policeVerification:s}))}}),m.policeVerification&&e.jsx("div",{className:"text-danger mt-1",children:m.policeVerification})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(g,{children:["Department ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{value:M(t.department),onChange:s=>{x("department",s.target.value);const r=w("department",s.target.value,t);u(a=>({...a,department:r}))},onBlur:()=>{const s=w("department",t.department,t);u(r=>({...r,department:s}))}}),m.department&&e.jsx("div",{className:"text-danger mt-1",children:m.department})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(g,{children:["Date of Joining ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{type:"date",value:t.dateOfJoining,onChange:s=>x("dateOfJoining",s.target.value)})]})]}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-md-4",children:" "})}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-4"}),e.jsx("div",{className:"col-md-4"})]}),e.jsx("h5",{className:"mt-3",children:"Address"}),Object.keys(t.address).reduce((s,r,a)=>(a%3===0&&s.push([]),s[s.length-1].push(r),s),[]).map((s,r)=>e.jsx("div",{className:"row mb-3",children:s.map(a=>{var l;return e.jsxs("div",{className:"col-md-4",children:[e.jsxs(g,{className:"text-capitalize",children:[a," ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{type:"text",maxLength:a==="postalCode"?6:void 0,value:M(t.address[a]),onChange:i=>{let n=i.target.value;a==="postalCode"?/^\d*$/.test(n)&&j("address",a,n):j("address",a,n);const p=w(a,n,t);u(k=>({...k,address:{...k.address,[a]:p}}))},onBlur:()=>{const i=w(a,t.address[a],t);u(n=>({...n,address:{...n.address,[a]:i}}))}}),((l=m.address)==null?void 0:l[a])&&e.jsx("div",{className:"text-danger mt-1",children:m.address[a]})]},a)})},r)),e.jsx("h5",{className:"mt-3",children:"Bank Account Details"}),Object.keys(t.bankAccountDetails).reduce((s,r,a)=>(a%3===0&&s.push([]),s[s.length-1].push(r),s),[]).map((s,r)=>e.jsx("div",{className:"row mb-3",children:s.map(a=>{var l;return e.jsxs("div",{className:"col-md-4",children:[e.jsxs(g,{className:"text-capitalize",children:[a," ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{value:t.bankAccountDetails[a],maxLength:a==="accountNumber"?20:a==="panCardNumber"?10:a==="ifscCode"?11:void 0,onChange:async i=>{let n=i.target.value;a==="accountNumber"?/^\d*$/.test(n)&&j("bankAccountDetails",a,n):a==="panCardNumber"?(n=n.toUpperCase(),/^[A-Z]{0,5}[0-9]{0,4}[A-Z]{0,1}$/.test(n)&&j("bankAccountDetails",a,n)):a==="ifscCode"?(n=n.toUpperCase(),/^[A-Z0-9]*$/.test(n)&&j("bankAccountDetails",a,n)):j("bankAccountDetails",a,n);const p=w(a,n,t);u(k=>({...k,bankAccountDetails:{...k.bankAccountDetails,[a]:p}}))},onBlur:async()=>{const i=t.bankAccountDetails[a],n=w(a,i,t);if(u(p=>({...p,bankAccountDetails:{...p.bankAccountDetails,[a]:n}})),a==="panCardNumber"&&i.length===10&&(/^[A-Z]{5}[0-9]{4}[A-Z]$/.test(i)||y.error("Invalid PAN format (e.g., ABCDE1234F)")),a==="ifscCode"&&i.length===11)if(!/^[A-Z]{4}0[A-Z0-9]{6}$/.test(i))y.error("Invalid IFSC format (e.g., HDFC0001234)"),j("bankAccountDetails","bankName",""),j("bankAccountDetails","branchName","");else try{const k=await fetch(`https://ifsc.razorpay.com/${i}`);if(k.ok){const te=await k.json();j("bankAccountDetails","bankName",te.BANK||""),j("bankAccountDetails","branchName",te.BRANCH||"")}}catch{y.error("Error fetching bank details"),j("bankAccountDetails","bankName",""),j("bankAccountDetails","branchName","")}}}),((l=m.bankAccountDetails)==null?void 0:l[a])&&e.jsx("div",{className:"text-danger mt-1",children:m.bankAccountDetails[a]})]},a)})},r)),e.jsx("h5",{className:"mt-3",children:"Documents"}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsxs(g,{children:["Profile Image ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{type:"file",accept:"image/*",onChange:async s=>{const r=s.target.files[0];if(r){const a=await se(r);x("profilePicture",a)}}})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs(g,{children:["Medical Fitness Certificate ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(v,{type:"file",onChange:s=>O(s,"medicalFitnessCertificate")})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx(g,{children:"Teaining Guard License"}),e.jsx(v,{type:"file",onChange:s=>O(s,"traningOrGuardLicense")})]})]}),e.jsx(g,{children:"Previous Employment History"}),e.jsx(fe,{rows:3,value:t.previousEmployeeHistory,onChange:s=>x("previousEmployeeHistory",s.target.value),placeholder:"Enter previous employment history"}),e.jsx("div",{className:"mb-3 w-100 mt-4",style:{display:"flex",justifyContent:"end",alignContent:"end",alignItems:"end"}}),e.jsx(ge,{show:R,onClose:()=>L(!1),features:je,actions:J,permissions:t.permissions,toggleFeature:U,toggleAllActions:ee,togglePermission:E,onSave:()=>{console.log("Saved Permissions",t.permissions),L(!1)}})]})}),e.jsx(me,{children:P?e.jsx(B,{color:"secondary",onClick:S,children:"Close"}):e.jsxs(e.Fragment,{children:[e.jsx(B,{style:{backgroundColor:"var(--color-bgcolor)",color:"var(--color-black)"},onClick:()=>b(D),children:"Clear"}),e.jsx(B,{color:"secondary",onClick:S,children:"Cancel"}),e.jsx(B,{style:{backgroundColor:"var(--color-black)",color:"white"},onClick:ae,children:"Save"})]})})]}),e.jsxs(le,{visible:de,onClose:c,size:"xl",children:[e.jsx(ne,{onClose:c,children:e.jsx("strong",{children:T?"PDF Preview":"Image Preview"})}),e.jsx(ce,{className:"text-center",children:T?e.jsx("iframe",{src:Q,title:"PDF Preview",style:{width:"100%",height:"80vh",border:"none"}}):e.jsx("img",{src:Q,alt:"Preview",style:{maxWidth:"100%",maxHeight:"80vh",borderRadius:"8px"}})})]})]})},Pe=f=>Z.get(`${Y}/getAllSecurityStaffByClinicId/${f}`),Fe=f=>Z.post(`${Y}/addSecurityStaff`,f),Be=(f,S)=>Z.put(`${Y}/updateSecurityStaffById/${f}`,S),Re=f=>Z.delete(`${Y}/deleteSecurityStaffById/${f}`),ss=()=>{const[f,S]=d.useState([]),[W,I]=d.useState(!1),[P,C]=d.useState(null),[oe,$]=d.useState(!1),[D,t]=d.useState(1),[b,ie]=d.useState(10),{searchQuery:q,setSearchQuery:de}=ue(),[V,R]=d.useState(!1),[L,Q]=d.useState(null),[_,T]=d.useState(!1),[K,m]=d.useState(null),[u,H]=d.useState(null),[X,U]=d.useState(!1),E=async()=>{var c;R(!0);try{const o=localStorage.getItem("HospitalId");if(o){const N=await Pe(o);console.log("API Response:",N),R(!1),S(((c=N.data)==null?void 0:c.data)||[])}}catch(o){console.error("❌ Error fetching lab technicians:",o),S([]),R(!1)}finally{R(!1)}};d.useEffect(()=>{E()},[]);const ee=async c=>{try{if(P)await Be(P.securityStaffId,c),E(),y.success("Security updated successfully!");else{const o=await Fe(c);await E(),console.log(o),H({username:o.data.data.userName,password:o.data.data.password}),I(!1),U(!0),y.success("Security added successfully!")}}catch(o){y.error("❌ Failed to save security."),console.error("API error:",o)}},se=async c=>{console.log(c);try{await Re(c),S(o=>o.filter(N=>N.id!==c)),y.success("Security deleted successfully!")}catch(o){y.error("❌ Failed to delete security."),console.error("Delete error:",o)}finally{T(!1)}},{user:x}=he(),j=(c,o)=>{var N,h;return(h=(N=x==null?void 0:x.permissions)==null?void 0:N[c])==null?void 0:h.includes(o)},G=xe.useMemo(()=>{const c=q.toLowerCase().trim();return c?f.filter(o=>Object.values(o).some(N=>String(N).toLowerCase().includes(c))):f},[q,f]),O=G.slice((D-1)*b,D*b),ae=c=>{try{return atob(c)}catch{return null}};return e.jsxs("div",{children:[j("Laboratory","create")&&e.jsx("div",{className:"mb-3 w-100",style:{display:"flex",justifyContent:"end",alignContent:"end",alignItems:"end"},children:e.jsx(B,{style:{color:"var(--color-black)",backgroundColor:"var(--color-bgcolor)"},onClick:()=>I(!0),children:"Add Security"})}),e.jsxs(le,{visible:X,backdrop:"static",keyboard:!1,children:[e.jsx(ne,{children:e.jsx("h5",{children:"Technician Credentials"})}),e.jsx(ce,{children:u?e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",u.username]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Password:"})," ",u.password]}),e.jsx("small",{className:"text-danger",children:"⚠️ Please save these credentials securely. They will not be shown again."})]}):e.jsx("p",{children:"No data available"})}),e.jsx(me,{children:e.jsx(B,{color:"primary",onClick:()=>{U(!1),H(null)},children:"Close"})})]}),e.jsx(Ne,{isVisible:_,title:"Delete Security",message:"Are you sure you want to delete this Security? This action cannot be undone.",confirmText:"Yes, Delete",cancelText:"Cancel",confirmColor:"danger",cancelColor:"secondary",onConfirm:()=>se(K),onCancel:()=>T(!1)}),V?e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx(ye,{message:"Loading technician..."})}):L?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"50vh",color:"var(--color-black)"},children:L}):e.jsxs(Ce,{className:"mt-3",striped:!0,hover:!0,responsive:!0,children:[e.jsx(ke,{children:e.jsxs(re,{className:"pink-table  w-auto",children:[e.jsx(F,{children:"#"}),e.jsx(F,{children:"Photo"})," ",e.jsx(F,{children:"Name"}),e.jsx(F,{children:"Contact"}),e.jsx(F,{children:"Sex"}),e.jsx(F,{children:"Date Of Joining"}),e.jsx(F,{className:"text-end",children:"Actions"})]})}),e.jsx(we,{className:"pink-table",children:O.length>0?O.map((c,o)=>e.jsxs(re,{children:[e.jsx(A,{children:(D-1)*b+o+1}),e.jsx(A,{children:c.profilePicture?e.jsx("img",{src:ae(c.profilePicture),alt:c.fullName,width:"40",height:"40",style:{borderRadius:"50%",objectFit:"cover",border:"1px solid var(--color-black)"}}):e.jsx("img",{src:"/assets/images/default-avatar.png",alt:"No profile",width:"40",height:"40",style:{borderRadius:"50%",objectFit:"cover",border:"1px solid var(--color-black)"}})}),e.jsx(A,{children:M(c.fullName)}),e.jsx(A,{children:M(c.contactNumber)}),e.jsx(A,{children:M(c.gender)}),e.jsx(A,{children:c.dateOfJoining}),e.jsx(A,{className:"text-end",children:e.jsxs("div",{className:"d-flex justify-content-end gap-2  ",children:[j("Laboratory","read")&&e.jsx("button",{className:"actionBtn",onClick:()=>{C(c),$(!0),I(!0)},title:"View",children:e.jsx(Se,{size:18})}),j("Laboratory","update")&&e.jsx("button",{className:"actionBtn",onClick:()=>{C(c),$(!1),I(!0)},title:"Edit",children:e.jsx(De,{size:18})}),j("Laboratory","delete")&&e.jsx("button",{className:"actionBtn",onClick:()=>{console.log(c.securityStaffId),m(c.securityStaffId),T(!0)},title:"Delete",children:e.jsx(Ie,{size:18})})]})})]},c.id)):e.jsx(re,{children:e.jsx(A,{colSpan:"9",className:"text-center",style:{color:"var(--color-black)"},children:"No Security found."})})})]}),!V&&e.jsx("div",{className:"d-flex justify-content-end mt-3",style:{marginRight:"40px"},children:Array.from({length:Math.ceil(G.length/b)},(c,o)=>e.jsx(B,{style:{backgroundColor:D===o+1?"var(--color-black)":"#fff",color:D===o+1?"#fff":"var(--color-black)",border:"1px solid #ccc",borderRadius:"5px",cursor:"pointer"},className:"ms-2",onClick:()=>t(o+1),children:o+1},o))}),e.jsx(Ae,{visible:W,onClose:()=>{I(!1),C(null),$(!1)},onSave:ee,initialData:P,viewMode:oe,technicians:f,fetchTechs:E})]})};export{ss as default};
