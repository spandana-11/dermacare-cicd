import{r as n,h as $,j as e}from"./index-C6Cu0DpS.js";import{G as H}from"./appointmentAPI-CT6zXdIJ.js";import{C as h}from"./CFormCheck-YAZaqH7I.js";import{a as S}from"./index.esm-CuIIRQYS.js";import{C as R,a as E,b,c as i,d as V,e as o}from"./CTable-qb4loNj2.js";import{j as M}from"./DefaultLayout-9Hl5yeW5.js";import"./CFormLabel-DMQAq1-n.js";import"./CConditionalPortal-DtVGpKjo.js";const Y=()=>{n.useState(null);const[z,T]=n.useState([]),[G,k]=n.useState([]),[f,I]=n.useState([]),[L,w]=n.useState([]),[_,N]=n.useState([]),[d,y]=n.useState([]),[c,x]=n.useState([]),[a,g]=n.useState([]),[u,v]=n.useState(1),j=7,A=$(),D=async()=>{try{const t=localStorage.getItem("HospitalId");if(console.log("Hospital ID from localStorage:",t),!t)return;const s=await H(t);console.log("Appointments for this Hospital:",s),s!=null&&s.data?y(s.data):(console.warn("No data returned for Hospital ID:",t),y([]))}catch(t){console.error("Failed to fetch appointments:",t)}},P=t=>{switch(console.log(t),t==null?void 0:t.toLowerCase()){case"completed":return"success";case"Rejected":return"danger";case"pending":return"warning";case"confirmed":return"info";case"in progress":return"primary";case"rescheduled":return"secondary";default:return"dark"}};n.useEffect(()=>{D()},[]),n.useEffect(()=>{let t=[...d];console.log("Initial bookings:",t);const s=l=>l==null?void 0:l.toLowerCase().trim(),r={"Service & Treatment":"services & treatments","Video Consultation":"online consultation","In-clinic":"in-clinic consultation"};if(a.length>0&&(t=t.filter(l=>a.some(m=>s(m)===s(l.status))),console.log("After status filter:",t)),c.length===1){const l=c[0],m=r[l];m&&(t=t.filter(F=>s(F.consultationType)===m),console.log(`After ${l} filter:`,t))}I(t),v(1)},[d,c,a]),n.useEffect(()=>{const t=[...new Set(d.map(r=>r.subServiceName).filter(Boolean))],s=[...new Set(d.map(r=>r.consultationType).filter(Boolean))];w(t),N(s),console.log("Available Consultation Types:",s)},[d]),n.useEffect(()=>{window.scrollTo(0,0)},[u]);const B=f.slice((u-1)*j,u*j),C=t=>{c.includes(t)?x([]):x([t])},p=t=>{const s=t.target.value;a.includes(s)?g([]):g([s])};return e.jsx("div",{style:{overflow:"hidden"},children:e.jsxs("div",{className:"container mt-4",children:[e.jsx("h5",{children:"Appointments"}),e.jsxs("div",{className:"d-flex gap-2 mb-3",children:[e.jsx("button",{onClick:()=>C("Service & Treatment"),className:`btn ${c.includes("Service & Treatment")?"btn-dark":"btn-outline-dark"}`,children:"Service & Treatment"}),e.jsx("button",{onClick:()=>C("In-clinic"),className:`btn ${c.includes("In-clinic")?"btn-dark":"btn-outline-dark"}`,children:"In-Clinic Consultation"}),e.jsx("button",{onClick:()=>C("Video Consultation"),className:`btn ${c.includes("Video Consultation")?"btn-dark":"btn-outline-dark"}`,children:"Video Consultation"})]}),e.jsxs("div",{className:"mb-3 d-flex justify-content-between align-items-center flex-wrap gap-2",children:[e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx(h,{label:"Pending",value:"Pending",onChange:p,checked:a.includes("Pending")}),e.jsx(h,{label:"In-Progress",value:"In-Progress",onChange:p,checked:a.includes("In-Progress")}),e.jsx(h,{label:"Completed",value:"Completed",onChange:p,checked:a.includes("Completed")}),e.jsx(h,{label:"Confirmed",value:"Confirmed",onChange:p,checked:a.includes("Confirmed")}),e.jsx(h,{label:"Rejected",value:"Rejected",onChange:p,checked:a.includes("Rejected")})]}),e.jsx(S,{color:"secondary",onClick:()=>{T([]),k([]),x([]),g([])},children:"Reset Filters"})]}),e.jsxs(R,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(E,{children:e.jsxs(b,{children:[e.jsx(i,{children:"S.No"}),e.jsx(i,{children:"H_ID"}),e.jsx(i,{children:"Name"}),e.jsx(i,{children:"Service Name"}),e.jsx(i,{children:"Consultation Type"}),e.jsx(i,{children:"Date"}),e.jsx(i,{children:"Time"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Action"})]})}),e.jsx(V,{children:Array.isArray(f)&&f.length>0?B.map((t,s)=>{var r;return e.jsxs(b,{children:[e.jsx(o,{children:s+1}),e.jsx(o,{children:t.clinicId}),e.jsx(o,{children:t.name}),e.jsx(o,{children:t.subServiceName}),e.jsx(o,{children:t.consultationType}),e.jsxs(o,{children:[t.sele?`${t.sele} `:"",t.serviceDate]}),e.jsx(o,{children:t.slot||t.servicetime}),e.jsx(o,{children:e.jsx(o,{children:e.jsx(M,{color:P(t.status),children:(r=t.status)==null?void 0:r.split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")})})}),e.jsx(o,{children:e.jsx(S,{color:"primary",size:"sm",onClick:()=>A(`/appointmentDetails/${t.bookingId}`,{state:{appointment:t}}),children:"View"})})]},`${t.id} -${s}`)}):e.jsx(b,{children:e.jsx(o,{colSpan:"8",className:"text-center text-danger fw-bold",children:"No appointments found."})})})]}),e.jsx("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end"},children:Array.from({length:Math.ceil(f.length/j)},(t,s)=>e.jsx("button",{onClick:()=>v(s+1),style:{margin:"0 5px",padding:"5px 10px",backgroundColor:u===s+1?"#007bff":"#fff",color:u===s+1?"#fff":"#000",border:"1px solid #ccc",borderRadius:"5px"},children:s+1},s))})]})})};export{Y as default};
