import{j as e,r as i,b as ds,a as ms,R as us,Q as hs,y as gs,z as xs,E as Fe,h as De,F as Me,H as ke,I as ps,B as $,J as js,K as vs}from"./index-BpN0qZrt.js";import"./index.es-BCMPbiOB.js";import{b as E}from"./index.esm-BAveQmLP.js";import{b as ys,c as Ee,d as Ve}from"./index-B7wVdPfa.js";import{C as fs,a as ue,b as he,c as ge}from"./CAccordionItem-B-L0mXqm.js";import{a as c,C as p}from"./CRow-D0GPXItY.js";import{C as T,b as P}from"./CFormInput-DMF4wKOV.js";import{C as Ns}from"./CInputGroup-DivyHFoW.js";import{C as bs,a as Ss}from"./CListGroupItem-DMzJVNJW.js";import{C as As}from"./ConfirmationModal-Blpddd1P.js";import{c as xe}from"./capitalizeWords-CuwF8AcI.js";import{L as Ps}from"./loader-OBkaezw1.js";import{C as Re}from"./CForm-D_Fm9Pc8.js";import{C as $e,a as Ge,b as Le}from"./CModalHeader-DLH-68_W.js";import{C as Oe}from"./CModalTitle-CwvqIfsB.js";import{C as Be}from"./CModalFooter-Dm04Litg.js";import{C as G}from"./CFormSelect-DDJD4c8G.js";import{C as Is}from"./CFormLabel-DO0eStXP.js";import{C as Cs,a as Qs,b as pe,c as L,d as Ts,e as k}from"./CTable-Bgk4qBUR.js";import{E as ws}from"./eye-BuIXT__x.js";import{P as Fs,T as Ds}from"./trash-2-CRkTwtCJ.js";import"./CNavItem-DIVzBTzM.js";const je=({title:y,qaList:g=[],setQAList:f})=>{const[I,N]=i.useState(""),[w,V]=i.useState(""),[b,F]=i.useState([]),[W,Ue]=i.useState("add"),[O,B]=i.useState(null),D=()=>{w.trim()!==""&&(F([...b,w]),V(""))},o=d=>{F(b.filter(m=>m!==d))},U=()=>{if(I.trim()&&b.length>0){const d=g.findIndex(m=>Object.keys(m)[0]===I);if(O!==null){const m=[...g];m[O]={[I]:b},f(m),B(null)}else if(d!==-1){const m=[...g];m[d]={[I]:b},f(m)}else f([...g,{[I]:b}]);N(""),F([])}},J=d=>{const m=g[d],C=Object.keys(m)[0],_=m[C];N(C),F(_),B(d)},ae=d=>{const m=[...g];m.splice(d,1),f(m),O===d&&(N(""),F([]),B(null))};return i.useEffect(()=>{if(g.length>0){const d=g[g.length-1],m=Object.keys(d)[0],C=d[m];N(m),F(C)}},[g]),i.useEffect(()=>{if((W==="edit"||W==="view")&&g.length>0){const d=g[g.length-1],m=Object.keys(d)[0],C=d[m];N(m),F(C)}},[g,W]),e.jsxs(c,{md:12,className:"mt-3",children:[e.jsx("label",{className:"mb-2",children:"Instruction"}),e.jsx(T,{placeholder:"Enter your question",value:I,onChange:d=>N(d.target.value)}),e.jsx("label",{className:"mt-3",children:"Guidelines"}),e.jsxs(Ns,{className:"mb-2",children:[e.jsx(T,{placeholder:"Enter answer",value:w,onChange:d=>V(d.target.value)}),e.jsx(E,{color:"success",onClick:D,className:"text-white",children:e.jsx(ys,{})})]}),b.length>0&&e.jsx(bs,{className:"mb-3",children:b.map((d,m)=>e.jsxs(Ss,{className:"d-flex justify-content-between align-items-center",children:[d,e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(Ee,{onClick:()=>{V(d),o(d)},style:{color:"orange",cursor:"pointer"},title:"Edit Answer"}),e.jsx(Ve,{onClick:()=>o(d),style:{color:"red",cursor:"pointer"},title:"Delete Answer"})]})]},m))}),e.jsx(E,{color:"info",className:"mb-3 text-white",onClick:U,children:O!==null?"Update Q&A":"Save Q&A"}),g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h6",{className:"mt-4",children:"Saved Questions & Answers"}),g.map((d,m)=>{const C=Object.keys(d)[0],_=d[C];return e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:C}),e.jsx("ul",{children:_.map((ve,ne)=>e.jsx("li",{children:ve},ne))}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(Ee,{onClick:()=>J(m),style:{color:"orange",cursor:"pointer"},title:"Edit Q&A"}),e.jsx(Ve,{onClick:()=>ae(m),style:{color:"red",cursor:"pointer"},title:"Delete Q&A"})]})]},m)})]})]})},Ms=({preQAList:y,setPreQAList:g,procedureQAList:f,setProcedureQAList:I,postQAList:N,setPostQAList:w})=>e.jsxs(fs,{default:!0,children:[e.jsxs(ue,{itemKey:1,children:[e.jsx(he,{children:"Pre-Procedure"}),e.jsx(ge,{children:e.jsx(je,{title:"Pre-Procedure",qaList:y,setQAList:g})})]}),e.jsxs(ue,{itemKey:2,children:[e.jsx(he,{children:"Procedure"}),e.jsx(ge,{children:e.jsx(je,{title:"Procedure",qaList:f,setQAList:I})})]}),e.jsxs(ue,{itemKey:3,children:[e.jsx(he,{children:"Post-Procedure"}),e.jsx(ge,{children:e.jsx(je,{title:"Post-Procedure",qaList:N,setQAList:w})})]})]}),vr=()=>{const[y,g]=i.useState([]),[f,I]=i.useState([]),[N,w]=i.useState(!1),[V,b]=i.useState(null),[F,W]=i.useState(""),[Ue,O]=i.useState([]),[B,D]=i.useState(!1),[o,U]=i.useState(null),[J,ae]=i.useState(!1),[d,m]=i.useState(""),[C,_]=i.useState(""),[ve,ne]=i.useState([]),[ks,ie]=i.useState([]),[ye,ce]=i.useState([]),[q,fe]=i.useState([]),[qe,oe]=i.useState(""),[He,ze]=i.useState(""),[Ne,Es]=i.useState(null),{searchQuery:be,setSearchQuery:Vs}=ds(),[H,Ke]=i.useState(1),[Y,Rs]=i.useState(10),{user:le}=ms(),X=(s,r)=>{var a,n;return(n=(a=le==null?void 0:le.permissions)==null?void 0:a[s])==null?void 0:n.includes(r)},[Z,We]=i.useState({serviceImage:"",viewImage:"",subServiceName:"",serviceName:"",serviceImageFile:null}),[$s,Gs]=i.useState([]),[Ls,Os]=i.useState([]),[Bs,Us]=i.useState([]),Je={1:"Generic ConsentForm",2:"Procedure ConsentForm"};let Se=[];try{typeof y.descriptionQA=="string"?Se=JSON.parse(y.descriptionQA):Se=y.descriptionQA||[]}catch(s){console.error("Invalid descriptionQA format:",s)}const[t,x]=i.useState({categoryName:"",categoryId:"",serviceName:"",subServiceName:"",description:"",price:"",gst:0,gstAmount:0,consultationFee:0,procedureQA:[],preProcedureQA:[],postProcedureQA:[]}),[z,Ae]=i.useState("add"),[qs,Hs]=i.useState(null),[zs,Ks]=i.useState(""),de=us.useMemo(()=>{const s=be.toLowerCase().trim();return s?y.filter(r=>Object.values(r).some(a=>String(a).toLowerCase().includes(s))):y},[be,y]),_e=()=>{Ae("add"),ie([]),ne([]),m(""),oe(""),x({categoryName:"",categoryId:"",serviceName:"",serviceId:"",subServiceId:"",subServiceName:"",price:"",discount:0,gst:0,gstAmount:0,consultationFee:0,minTime:"",taxPercentage:0,status:"",serviceImage:"",serviceImageFile:null,viewImage:"",viewDescription:"",consentFormType:Fe.consentFormType==="Generic ConsentForm"?"1":"2",platformFeePercentage:0,descriptionQA:[]}),D(!0)},Ye=async s=>{var we;console.log(s.subServiceId),ze(s.subServiceId),Ae("edit"),D(!0);const r=f.find(A=>A.categoryName===s.categoryName),a=(r==null?void 0:r.categoryId)||"";let n=[];try{n=((we=(await De.get(`/${Me}/${a}`)).data)==null?void 0:we.data)||[],console.log(n),ce(n)}catch(A){console.error("Error fetching service list:",A)}const l=n.find(A=>A.serviceName===s.serviceName),u=(l==null?void 0:l.serviceId)||"";let j=[];if(u)try{const R=(await ke(u)).data;Array.isArray(R)?j=R.flatMap(ls=>ls.subServices||[]):R!=null&&R.subServices&&(j=R.subServices)}catch(A){console.error("Error fetching subservices:",A)}fe({subServices:j});const v=j.find(A=>A.subServiceName===s.subServiceName),Q=(v==null?void 0:v.subServiceId)||"",K=(v==null?void 0:v.subServiceName)||"";oe(Q);const se=Array.isArray(s.procedureQA)?s.procedureQA:JSON.parse(s.procedureQA||"[]"),re=Array.isArray(s.preProcedureQA)?s.preProcedureQA:JSON.parse(s.preProcedureQA||"[]"),te=Array.isArray(s.postProcedureQA)?s.postProcedureQA:JSON.parse(s.postProcedureQA||"[]"),S=s.serviceImage||"";S.startsWith("data:")||`${S}`,x({subServiceId:Q,subServiceName:K,serviceName:s.serviceName||"",serviceId:u,categoryName:s.categoryName||"",categoryId:a||"",price:s.price||"",discount:s.discountPercentage||0,gst:s.gst||0,gstAmount:s.gstAmount||0,consultationFee:s.consultationFee||0,taxPercentage:s.taxPercentage||0,minTime:s.minTime||"",serviceImage:S,serviceImageFile:null,status:s.status||"",viewDescription:s.viewDescription||"",consentFormType:s.consentFormType?String(s.consentFormType):"",platformFeePercentage:s.platformFeePercentage||0,viewImage:s.viewImage||"",procedureQA:se,preProcedureQA:re,postProcedureQA:te}),ie(formattedQA)},[Xe,me]=i.useState(!1),[Pe,Ze]=i.useState(null),[h,M]=i.useState({subServiceName:"",serviceName:"",serviceId:"",categoryName:"",price:"",status:"",taxPercentage:"",descriptionQA:"",answers:"",minTime:"",discount:"",viewDescription:"",consentFormType:"",serviceImage:"",bannerImage:""}),[Ws,Js]=i.useState({}),ee=async()=>{w(!0),b(null);try{const s=await gs();if(s.data&&Array.isArray(s.data)){const a=s.data.map(n=>({categoryId:n.categoryId,categoryName:n.categoryName}));I(s.data)}else throw new Error("Invalid category data format");const r=localStorage.getItem("HospitalId");if(r){const a=await xs(r);Array.isArray(a)?(g(a),console.log(a)):(g([]),console.warn("No subservices found for this hospital."))}else console.warn("No hospitalId found in localStorage."),g([])}catch(s){console.error("Error fetching data:",s),b("Failed to fetch data. Please try again later.")}finally{w(!1)}};i.useEffect(()=>{ee()},[]),i.useEffect(()=>{if(J&&(Z!=null&&Z.descriptionQA)&&typeof Z.descriptionQA=="string")try{We(s=>({...s,descriptionQA:JSON.parse(s.descriptionQA)}))}catch{console.error("Invalid QA format")}},[J]);const es=parseFloat(t.minTime),ss=()=>{const s={};return t.serviceName||(s.serviceName="Service name is required."),t.categoryName||(s.categoryName="Category is required."),t.price?isNaN(t.price)?s.price="price must be a valid number.":parseFloat(t.price)<0&&(s.price="price cannot be a negative number."):s.price="price is required.",t.status||(s.status="Status is required."),(t.gst===""||isNaN(t.gst)||parseFloat(t.gst)<0)&&(s.gst="GST must be a valid number and not negative."),(t.consultationFee===""||isNaN(t.consultationFee)||parseFloat(t.consultationFee)<0)&&(s.consultationFee="Consultation fee must be a valid number and not negative."),!t.discount&&t.discount!==0?s.discount="Discount is required.":parseFloat(t.discount)<0&&(s.discount="Discount cannot be a negative number."),!t.minTimeValue||isNaN(t.minTimeValue)?s.minTime="Minimum time is required":parseFloat(t.minTimeValue)<=0&&(s.minTime="Minimum time must be greater than zero."),t.viewDescription||(s.viewDescription="View description is Required."),t.consentFormType||(s.consentFormType="consentFormType is Required."),t.serviceImage||(console.log("Service Image in Form:",t.serviceImage),s.serviceImage="Please upload a service image."),t.categoryId||(s.categoryId="Please select a valid category."),M(s),Object.keys(s).length===0},Ie=de.slice((H-1)*Y,H*Y),rs=async()=>{var re,te;console.log("--- handleAddService START ---");const s=t.price*t.discount/100;t.price*t.gst/100;const r=t.price-s,a=r*t.taxPercentage/100,n=t.gst||0,l=r*(t.platformFeePercentage||0)/100,u=r+a-l,j=u+n+(t.consultationFee||0),v=`${t.minTimeValue} ${t.minTimeUnit}`;console.log("Calculated values:",{discountAmount:s,discountedCost:r,taxAmount:a,platformFee:l,clinicPay:u,finalCost:j});const Q=await Ce(t.serviceImageFile),K=(Q==null?void 0:Q.split(",")[1])||"";if(!ss()){$.error("Validation failed",{position:"top-right"});return}const se={hospitalId:localStorage.getItem("HospitalId"),subServiceName:t.subServiceName,subServiceId:t.subServiceId,serviceId:t.serviceId,serviceName:t.serviceName,categoryName:t.categoryName,categoryId:t.categoryId,price:t.price,discountPercentage:t.discount,discountAmount:s,discountedCost:r,taxPercentage:t.taxPercentage,taxAmount:a,platformFeePercentage:t.platformFeePercentage,platformFee:l,clinicPay:u,finalCost:j,gst:t.gst,gstAmount:t.gstAmount,consultationFee:t.consultationFee,minTime:v,status:t.status,subServiceImage:K,procedureQA:t.procedureQA,preProcedureQA:t.preProcedureQA,postProcedureQA:t.postProcedureQA,viewDescription:t.viewDescription,consentFormType:Number(t.consentFormType)};console.log("Payload ready to submit:",se);try{const S=await js(se,t.subServiceId);console.log("Response received:",S),S.status===201&&($.success(S.data.message,{position:"top-right"}),D(!1),ee(),Fe())}catch(S){console.error("Error in handleAddService:",S.response),$.error((te=(re=S.response)==null?void 0:re.data)==null?void 0:te.message,{position:"top-right"})}x({categoryName:"",categoryId:"",serviceName:"",serviceId:"",subServiceId:"",subServiceName:"",price:0,discount:0,gst:0,gstAmount:0,consultationFee:0,taxPercentage:0,minTimeValue:es,minTimeUnit:"",status:"",serviceImage:"",viewDescription:"",consentFormType:"",procedureQA:[],preProcedureQA:[],postProcedureQA:[],platformFeePercentage:0,descriptionQA:[]}),ie([]),console.log("--- handleAddService END ---")},ts=s=>{const r=parseInt(s,10);if(isNaN(r))return"Invalid time";if(r<60)return`${r} min`;const a=Math.floor(r/60),n=r%60;return n===0?`${a} hour${a>1?"s":""}`:`${a} hour${a>1?"s":""} ${n} min`},as=async()=>{var s;try{const r=localStorage.getItem("HospitalId");let a="";t.serviceImageFile?a=(await Ce(t.serviceImageFile)).split(",")[1]:(s=t.serviceImage)!=null&&s.startsWith("data:")?a=t.serviceImage.split(",")[1]:a=t.serviceImage||"";const n=t.price>0?Number(t.price):0,l={hospitalId:r,subServiceName:t.subServiceName||"",viewDescription:t.viewDescription||"",consentFormType:Number(t.consentFormType),status:t.status||"",minTime:t.minTimeValue?`${t.minTimeValue} ${t.minTimeUnit}`:"",procedureQA:Array.isArray(t.procedureQA)?t.procedureQA:[],preProcedureQA:Array.isArray(t.preProcedureQA)?t.preProcedureQA:[],postProcedureQA:Array.isArray(t.postProcedureQA)?t.postProcedureQA:[],price:t.price||0,discountPercentage:t.discount||0,taxPercentage:t.taxPercentage||0,platformFeePercentage:t.platformFeePercentage||0,subServiceImage:a,gst:t.gst||0,gstAmount:t.gstAmount||0,consultationFee:t.consultationFee||0};console.log("Payload for updateSubServiceData:",l);const u=await ps(He,r,l);$.success("Procedure updated successfully!",{position:"top-right"}),ae(!1),D(!1),ee()}catch(r){console.error("Update failed:",r),$.error("Error updating service.",{position:"top-right"})}},Ce=s=>new Promise((r,a)=>{const n=new FileReader;n.readAsDataURL(s),n.onload=()=>r(n.result),n.onerror=l=>a(l)}),ns=async s=>{console.log(s),Ze(s.subServiceId),me(!0)},is=async()=>{console.log(Pe);const s=localStorage.getItem("HospitalId");try{const r=await vs(Pe,s);console.log("Service deleted:",r),$.success("Procedure deleted successfully!",{position:"top-right"}),ee()}catch(r){console.error("Error deleting Procedure:",r)}me(!1)},cs=()=>{me(!1),console.log("Service deletion canceled")},Qe=s=>{const{name:r,value:a}=s.target;x(n=>{if(r==="categoryName"){const l=f.find(u=>u.categoryName===a);return{...n,[r]:a,categoryId:l?l.categoryId:""}}return r==="gst"||r==="gstAmount"||r==="consultationFee"||r==="price"||r==="discount"||r==="taxPercentage"||r==="minTime"?{...n,[r]:parseFloat(a)||0}:{...n,[r]:a}}),M(n=>({...n,[r]:""}))},os=()=>{x({serviceName:"",categoryName:"",price:"",discount:0,taxPercentage:0,minTime:"",minTimeValue:"",minTimeUnit:"minutes",status:"",serviceImage:"",viewImage:"",viewDescription:"",consentFormType:"",categoryId:""}),D(!1),M({})},Te=async s=>{var n;const{name:r,value:a}=s.target;if(r==="categoryName"){const l=f.find(u=>u.categoryId===a);x(u=>({...u,categoryName:(l==null?void 0:l.categoryName)||"",categoryId:a,serviceName:"",serviceId:""}));try{const j=((n=(await De.get(`/${Me}/${a}`)).data)==null?void 0:n.data)||[];ce(j)}catch(u){console.error("Failed to fetch services:",u),ce([])}}else if(r==="serviceName"){const l=ye.find(j=>j.serviceName===a),u=(l==null?void 0:l.serviceId)||"";if(x(j=>({...j,serviceName:a,serviceId:u})),u){const v=(await ke(u)).data;let Q=[];Array.isArray(v)?Q=v.flatMap(K=>K.subServices||[]):v&&v.subServices&&(Q=v.subServices),fe({subServices:Q})}}else x(l=>({...l,[r]:a}))};return e.jsxs("div",{style:{overflow:"hidden"},children:[e.jsx(hs,{}),e.jsx("div",{children:e.jsx(Re,{className:"d-flex justify-content-end mb-3",children:X("Procedure Management","create")&&e.jsx("div",{className:" w-100",style:{display:"flex",justifyContent:"end",alignContent:"end",alignItems:"end"},children:e.jsx(E,{style:{color:"var(--color-black)",backgroundColor:"var(--color-bgcolor)"},onClick:()=>_e(),children:"Add Procedure Details"})})})}),o&&e.jsxs($e,{visible:!!o,onClose:()=>U(null),size:"xl",children:[e.jsx(Ge,{style:{color:"var(--color-black)"},children:e.jsx(Oe,{className:"w-100 text-center  fs-4",children:"Procedure Details"})}),e.jsxs(Le,{style:{color:"var(--color-black)"},children:[e.jsxs(p,{className:"mb-3",children:[e.jsxs(c,{sm:6,children:[e.jsx("strong",{children:"Procedure Name:"}),e.jsx("div",{children:o.subServiceName})]}),e.jsxs(c,{sm:6,children:[e.jsx("strong",{children:"Procedure ID:"}),e.jsx("div",{children:o.subServiceId})]})]}),e.jsxs(p,{className:"mb-3",children:[e.jsxs(c,{sm:6,children:[e.jsx("strong",{children:"Service Name:"}),e.jsx("div",{children:o.serviceName})]}),e.jsxs(c,{sm:6,children:[e.jsx("strong",{children:"Service Id:"}),e.jsx("div",{children:o.serviceId})]})]}),e.jsxs(p,{className:"mb-3",children:[e.jsxs(c,{sm:6,children:[e.jsx("strong",{children:"Category Name:"}),e.jsx("div",{children:o.categoryName})]}),e.jsxs(c,{sm:6,children:[e.jsx("strong",{children:"Category Id:"}),e.jsx("div",{children:o.categoryId})]}),e.jsxs(c,{sm:6,children:[e.jsx("strong",{children:"Consent Form Type:"}),e.jsx("div",{children:Je[o.consentFormType]||"N/A"})]})]}),e.jsx(p,{className:"mb-3",children:e.jsxs(c,{sm:6,children:[e.jsx("strong",{children:"Status:"}),e.jsx("div",{children:o.status})]})}),e.jsx("hr",{}),e.jsxs(p,{className:"mb-3",children:[e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"Price:"}),e.jsxs("div",{children:["â‚¹ ",Math.round(o.price)]})]}),e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"Discount %:"}),e.jsxs("div",{children:[Math.round(o.discountPercentage),"%"]})]}),e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"Discount Amount:"}),e.jsxs("div",{children:["â‚¹ ",Math.round(o.discountAmount)]})]})]}),e.jsxs(p,{className:"mb-3",children:[e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"Discounted Cost:"}),e.jsxs("div",{children:["â‚¹ ",Math.round(o.discountedCost)]})]}),e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"Tax %:"}),e.jsxs("div",{children:[Math.round(o.taxPercentage),"%"]})]}),e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"Tax Amount:"}),e.jsxs("div",{children:["â‚¹ ",Math.round(o.taxAmount)]})]})]}),e.jsxs(p,{className:"mb-3",children:[e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"Platform Fee %:"}),e.jsxs("div",{children:[Math.round(o.platformFeePercentage),"%"]})]}),e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"Platform Fee:"}),e.jsxs("div",{children:["â‚¹ ",Math.round(o.platformFee)]})]}),e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"Clinic Pay:"}),e.jsxs("div",{children:["â‚¹ ",Math.round(o.clinicPay)]})]})]}),e.jsxs(p,{className:"mb-3",children:[e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"GST:"}),e.jsx("div",{children:Math.round(o.gst)})]}),e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"Consultation Fee:"}),e.jsxs("div",{children:["â‚¹ ",o.consultationFee]})]}),e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"Final Cost:"}),e.jsxs("div",{children:["â‚¹ ",Math.round(o.finalCost)]})]})]}),e.jsx(p,{className:"mb-3",children:e.jsxs(c,{sm:4,children:[e.jsx("strong",{children:"Service Time:"}),e.jsx("div",{children:ts(o.minTime)})]})}),e.jsx("hr",{}),e.jsx(p,{className:"mb-3",children:e.jsxs(c,{sm:12,children:[e.jsx("strong",{className:"mb-3",children:"Pre-Procedure QA:"}),Array.isArray(o.preProcedureQA)&&o.preProcedureQA.length>0?o.preProcedureQA.map((s,r)=>{const a=Object.keys(s)[0],n=s[a];return e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:a}),e.jsx("ul",{children:n.map((l,u)=>e.jsx("li",{children:l},u))})]},r)}):e.jsx("div",{children:"No Pre-Procedure Q&A available"})]})}),e.jsx(p,{className:"mb-3",children:e.jsxs(c,{sm:12,children:[e.jsx("strong",{className:"mb-3",children:"Procedure QA:"}),Array.isArray(o.procedureQA)&&o.procedureQA.length>0?o.procedureQA.map((s,r)=>{const a=Object.keys(s)[0],n=s[a];return e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:a}),e.jsx("ul",{children:n.map((l,u)=>e.jsx("li",{children:l},u))})]},r)}):e.jsx("div",{children:"No Procedure Q&A available"})]})}),e.jsx(p,{className:"mb-3",children:e.jsxs(c,{sm:12,children:[e.jsx("strong",{className:"mb-3",children:"Post-Procedure QA:"}),Array.isArray(o.postProcedureQA)&&o.postProcedureQA.length>0?o.postProcedureQA.map((s,r)=>{const a=Object.keys(s)[0],n=s[a];return e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:a}),e.jsx("ul",{children:n.map((l,u)=>e.jsx("li",{children:l},u))})]},r)}):e.jsx("div",{children:"No Post-Procedure Q&A available"})]})}),e.jsx("hr",{}),e.jsxs(p,{children:[e.jsxs(c,{sm:6,children:[e.jsx("strong",{children:"Service Image:"}),o.subServiceImage?e.jsxs("div",{className:"mt-2",children:[e.jsx("img",{src:`data:image/png;base64,${o.subServiceImage}`,alt:"Service",style:{width:"100%",maxWidth:"250px",borderRadius:"8px"}}),Ne&&e.jsx("img",{src:Ne,alt:"Preview",height:"80",className:"mt-2"})]}):e.jsx("div",{children:"No image available"})]}),e.jsxs(c,{sm:6,children:[e.jsx("strong",{children:"View Description:"}),e.jsx("div",{children:o.viewDescription})]})]})]}),e.jsx(Be,{children:e.jsx(E,{color:"secondary",onClick:()=>U(null),children:"Close"})})]}),e.jsxs($e,{visible:B,onClose:()=>D(!1),size:"xl",backdrop:"static",children:[e.jsx(Ge,{children:e.jsx(Oe,{style:{textAlign:"center",width:"100%"},children:z==="edit"?"Edit Procedure Details":"Add New Procedure Details"})}),e.jsx(Le,{children:e.jsxs(Re,{children:[e.jsxs(p,{className:"mb-4",children:[e.jsxs(c,{md:4,children:[e.jsxs("h6",{children:["Category Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(G,{value:t.categoryId||"",onChange:Te,"aria-label":"Select Category",name:"categoryName",disabled:z==="edit",children:[e.jsx("option",{value:"",children:"Select a Category"}),f==null?void 0:f.map(s=>e.jsx("option",{value:s.categoryId,children:s.categoryName},s.categoryId))]}),h.categoryName&&e.jsx(P,{className:"text-danger",children:h.categoryName})]}),e.jsxs(c,{md:4,children:[e.jsxs("h6",{children:["Service Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(G,{name:"serviceName",value:t.serviceName||"",onChange:Te,disabled:z==="edit",children:[e.jsx("option",{value:"",children:"Select Service"}),ye.map(s=>e.jsx("option",{value:s.serviceName,children:s.serviceName},s.serviceId))]}),h.serviceName&&e.jsx(P,{className:"text-danger",children:h.serviceName})]}),e.jsxs(c,{md:4,children:[e.jsxs("h6",{children:["Procedure Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(G,{name:"subServiceId",value:qe,onChange:s=>{var n;const r=s.target.value;oe(r);const a=(n=q==null?void 0:q.subServices)==null?void 0:n.find(l=>l.subServiceId===r);x(l=>({...l,subServiceId:r,subServiceName:(a==null?void 0:a.subServiceName)||"",preProcedureQA:y.preProcedureQA||[],procedureQA:y.procedureQA||[],postProcedureQA:y.postProcedureQA||[]}))},children:[e.jsx("option",{value:"",children:"Select Procedure"}),Array.isArray(q.subServices)&&q.subServices.map(s=>e.jsx("option",{value:s.subServiceId,children:s.subServiceName},s.subServiceId))]}),h.subServiceName&&e.jsx(P,{className:"text-danger",children:h.subServiceName})]})]}),e.jsxs(p,{className:"mb-4",children:[e.jsxs(c,{md:4,children:[e.jsxs("h6",{children:["Procedure Image ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(T,{type:"file",accept:"image/*",onChange:s=>{const r=s.target.files[0];if(r){const a=new FileReader;a.onloadend=()=>{var l;const n=((l=a.result)==null?void 0:l.split(",")[1])||"";x(u=>({...u,serviceImage:n,serviceImageFile:r}))},a.readAsDataURL(r)}}}),(t==null?void 0:t.serviceImage)&&e.jsx("img",{src:t.serviceImage.startsWith("data:")?t.serviceImage:`data:image/jpeg;base64,${t.serviceImage}`,alt:"Preview",style:{width:100,height:100,marginTop:10}})]}),e.jsxs(c,{md:4,children:[e.jsxs("h6",{children:["View Description ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(T,{type:"text",placeholder:"View Description",value:t.viewDescription||"",name:"viewDescription",onChange:Qe,maxLength:100}),h.viewDescription&&e.jsx(P,{className:"text-danger",children:h.viewDescription})]}),e.jsxs(c,{md:4,children:[e.jsxs("h6",{children:["Status ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(G,{value:t.status||"",onChange:Qe,name:"status",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"InActive",children:"Inactive"})]}),h.status&&e.jsx(P,{className:"text-danger",children:h.status})]})]}),e.jsxs(p,{className:"mb-4",children:[e.jsxs(c,{md:4,children:[e.jsxs(Is,{children:["ConsentFormType",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(G,{value:t.consentFormType||"",onChange:s=>x(r=>({...r,consentFormType:s.target.value})),children:[e.jsx("option",{value:"",children:"Select consentFormType"}),e.jsx("option",{value:"1",children:"Generic ConsentForm"}),e.jsx("option",{value:"2",children:"Procedure ConsentForm"})]}),h.consentFormType&&e.jsx(P,{className:"text-danger",children:h.consentFormType})]}),e.jsxs(c,{md:4,children:[e.jsxs("h6",{children:["Consultation Fee",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(T,{type:"number",value:t.consultationFee||"",onChange:s=>x(r=>({...r,consultationFee:Number(s.target.value)}))})]}),e.jsx(c,{children:e.jsxs("div",{className:"mb-4",children:[e.jsxs("h6",{children:["Min Time ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"d-flex",children:[e.jsx(T,{type:"number",name:"minTimeValue",value:t.minTimeValue||"",onChange:s=>x({...t,minTimeValue:s.target.value}),placeholder:"Enter time"}),e.jsxs(G,{name:"minTimeUnit",className:"ms-2",value:t.minTimeUnit||"",onChange:s=>x({...t,minTimeUnit:s.target.value}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Time"}),e.jsx("option",{value:"minutes",children:"Minutes"}),e.jsx("option",{value:"hours",children:"Hours"})]})]}),h.minTime&&e.jsx(P,{className:"text-danger",children:h.minTime})]})})]}),e.jsxs(p,{className:"mb-4",children:[e.jsxs(c,{md:3,children:[e.jsxs("h6",{children:["Procedure Price ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(T,{type:"number",placeholder:"Procedure Price",value:t.price||"",min:100,onChange:s=>{const r=s.target.value;x(n=>({...n,price:r}));let a="";(!r||r.trim()==="")&&(a="Price is required"),M(n=>({...n,price:a}))},onKeyDown:s=>{(s.key==="-"||s.key==="e"||s.key==="0"&&!t.price)&&s.preventDefault()},invalid:!!h.price}),h.price&&e.jsx(P,{className:"text-danger",children:h.price})]}),e.jsxs(c,{md:3,children:[e.jsxs("h6",{children:["Discount (%) ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(T,{type:"number",placeholder:"Discount",value:t.discount||"",name:"discount",onChange:s=>{let r=s.target.value;r.startsWith("0")&&(r=r.replace(/^0+/,"")),r.length>2&&(r=r.slice(0,2)),x(n=>({...n,discount:r}));let a="";r?isNaN(r)||Number(r)<=0?a="Discount must be greater than 0":Number(r)>99&&(a="Discount cannot exceed 99"):a="Discount is required",M(n=>({...n,discount:a}))},onKeyDown:s=>{(s.key==="-"||s.key==="e")&&s.preventDefault()},invalid:!!h.discount}),h.discount&&e.jsx(P,{className:"text-danger",children:h.discount})]}),e.jsxs(c,{md:3,children:[e.jsxs("h6",{children:["GST (%)",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(T,{type:"number",placeholder:"GST (%)",value:t.gst||"",onChange:s=>{let r=s.target.value;if(/^\d{0,2}$/.test(r)&&!(r.startsWith("0")&&r.length>1)){x(n=>({...n,gst:r}));let a="";r.trim()?Number(r)<=0?a="GST must be greater than 0":Number(r)>99&&(a="GST cannot exceed 99%"):a="GST is required",M(n=>({...n,gst:a}))}},onKeyDown:s=>{["-","e","+"].includes(s.key)&&s.preventDefault(),s.key==="0"&&!t.gst&&s.preventDefault()},min:1,max:99,invalid:!!h.gst}),h.gst&&e.jsx(P,{className:"text-danger",children:h.gst})]}),e.jsxs(c,{md:3,children:[e.jsx("h6",{children:"Other Taxes(%)"}),e.jsx(T,{type:"number",placeholder:"Tax Percentage",value:t.taxPercentage||"",name:"taxPercentage",min:1,max:99,onChange:s=>{let r=s.target.value;if(/^\d{0,2}$/.test(r)){x(n=>({...n,taxPercentage:r}));let a="";Number(r)<=0?a="Tax Percentage must be greater than 0":Number(r)>99&&(a="Tax Percentage cannot exceed 99"),M(n=>({...n,taxPercentage:a}))}},onKeyDown:s=>{(s.key==="-"||s.key==="e"||s.key==="+"||s.key==="0"&&!t.taxPercentage)&&s.preventDefault()},invalid:!!h.taxPercentage}),h.taxPercentage&&e.jsx(P,{className:"text-danger",children:h.taxPercentage})]})]}),e.jsx("h6",{className:"m-3",children:"Procedure (Optional)"}),e.jsx(Ms,{preQAList:t.preProcedureQA,setPreQAList:s=>x(r=>({...r,preProcedureQA:s})),procedureQAList:t.procedureQA,setProcedureQAList:s=>x(r=>({...r,procedureQA:s})),postQAList:t.postProcedureQA,setPostQAList:s=>x(r=>({...r,postProcedureQA:s}))})]})}),e.jsxs(Be,{children:[e.jsx(E,{color:"secondary",onClick:os,children:"Cancel"}),e.jsx(E,{color:"info",className:"pink-Btn",onClick:z==="edit"?as:rs,children:z==="edit"?"Update":"Add"})]})]}),N?e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx(Ps,{message:"Loading Procedure..."})}):V?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"50vh",color:"var(--color-black)"},children:V}):e.jsxs(Cs,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(Qs,{className:"pink-table w-auto",children:e.jsxs(pe,{children:[e.jsx(L,{style:{paddingLeft:"40px"},children:"S.No"}),e.jsx(L,{children:"Procedure Name"}),e.jsx(L,{children:"Servic eName"}),e.jsx(L,{children:"Category Name"}),e.jsx(L,{children:"Price"}),e.jsx(L,{className:"text-end",children:"Actions"})]})}),e.jsx(Ts,{className:"pink-table",children:Ie.length>0?Ie.map((s,r)=>e.jsxs(pe,{children:[e.jsx(k,{style:{paddingLeft:"40px"},children:(H-1)*Y+r+1}),e.jsx(k,{children:xe(s.subServiceName)}),e.jsx(k,{children:xe(s.serviceName||"NA")}),e.jsx(k,{children:xe(s.categoryName||"NA")}),e.jsx(k,{children:s.price||"NA"}),e.jsx(k,{className:"text-end",children:e.jsxs("div",{className:"d-flex justify-content-end gap-2  ",children:[X("Procedure Management","read")&&e.jsx("button",{className:"actionBtn",onClick:()=>U(s),title:"View",children:e.jsx(ws,{size:18})}),X("Procedure Management","update")&&e.jsx("button",{className:"actionBtn",onClick:()=>Ye(s),title:"Edit",children:e.jsx(Fs,{size:18})}),X("Procedure Management","delete")&&e.jsx("button",{className:"actionBtn",onClick:()=>ns(s),title:"Delete",children:e.jsx(Ds,{size:18})}),e.jsx(As,{isVisible:Xe,title:"Delete Procedure",message:"Are you sure you want to delete this procedure? This action cannot be undone.",confirmText:"Yes, Delete",cancelText:"Cancel",confirmColor:"danger",cancelColor:"secondary",onConfirm:is,onCancel:cs})]})})]},s.id)):e.jsx(pe,{children:e.jsx(k,{colSpan:5,className:"text-center text-muted",children:'ðŸ” No procedure found"'})})})]}),!N&&e.jsx("div",{className:"d-flex justify-content-end mt-3",style:{marginRight:"40px"},children:Array.from({length:Math.ceil((de.length?de.length:y.length)/Y)},(s,r)=>e.jsx(E,{style:{margin:"0 5px",padding:"5px 10px",backgroundColor:H===r+1?"var(--color-black)":"#fff",color:H===r+1?"#fff":"var(--color-black)",border:"1px solid #ccc",borderRadius:"5px",cursor:"pointer"},className:"ms-2",onClick:()=>Ke(r+1),children:r+1},r))})]})};export{vr as default};
