import{r as n,h as E,j as e}from"./index-D4EgioAp.js";import{G as V}from"./appointmentAPI-B_FFVWVT.js";import{C as v}from"./CFormCheck-CVNxMDK-.js";import{a as T}from"./index.esm--WqZM78H.js";import{C as P,a as L,b as m,c as i,d as M,e as l}from"./CTable-L9tFeSnF.js";import{j as R}from"./DefaultLayout-BXdUDKRE.js";import"./CFormLabel-CxEZYpEj.js";import"./CConditionalPortal-DMe4fTxW.js";const te=()=>{const[z,G]=n.useState(null),[_,k]=n.useState([]),[U,A]=n.useState([]),[f,N]=n.useState([]),[q,w]=n.useState([]),[J,I]=n.useState([]),[p,h]=n.useState([]),[c,x]=n.useState([]),[r,j]=n.useState([]),[u,y]=n.useState(1),[D,S]=n.useState(!0),C=7,$=E(),B=async()=>{try{const t=localStorage.getItem("HospitalId");if(console.log("Hospital ID from localStorage:",t),!t){h([]),S(!1);return}const s=await V(t);console.log("Appointments for this Hospital:",s),s!=null&&s.data?h(s.data):(console.warn("No data returned for Hospital ID:",t),h([]))}catch(t){console.error("Failed to fetch appointments:",t),h([])}finally{S(!1)}};n.useEffect(()=>{B()},[]),n.useEffect(()=>{let t=[...p];console.log("Initial bookings:",t);const s=o=>o==null?void 0:o.toLowerCase().trim(),a={"Service & Treatment":"services & treatments","Video Consultation":"video consultation","In-clinic":"in-clinic consultation"};if(r.length>0&&(t=t.filter(o=>r.some(d=>s(d)===s(o.status))),console.log("After status filter:",t)),c.length===1){const o=c[0];if(o==="Video Consultation")t=t.filter(d=>s(d.consultationType)==="video consultation"||s(d.consultationType)==="online consultation"),console.log(`After ${o} filter:`,t);else{const d=a[o];d&&(t=t.filter(H=>s(H.consultationType)===d),console.log(`After ${o} filter:`,t))}}N(t),y(1)},[p,c,r]),n.useEffect(()=>{const t=[...new Set(p.map(a=>a.subServiceName).filter(Boolean))],s=[...new Set(p.map(a=>a.consultationType).filter(Boolean))];w(t),I(s),console.log("Available Consultation Types:",s)},[p]),n.useEffect(()=>{window.scrollTo(0,0)},[u]);const F=f.slice((u-1)*C,u*C),g=t=>{c.includes(t)?x([]):x([t])},b=t=>{const s=t.target.value;r.includes(s)?j([]):j([s])};return e.jsx("div",{style:{overflow:"hidden"},children:e.jsxs("div",{className:"container mt-4",children:[e.jsx("h5",{children:"Appointments"}),e.jsxs("div",{className:"d-flex gap-2 mb-3",children:[e.jsx("button",{onClick:()=>g("Service & Treatment"),className:`btn ${c.includes("Service & Treatment")?"btn-dark":"btn-outline-dark"}`,children:"Service & Treatment"}),e.jsx("button",{onClick:()=>g("In-clinic"),className:`btn ${c.includes("In-clinic")?"btn-dark":"btn-outline-dark"}`,children:"In-Clinic Consultation"}),e.jsx("button",{onClick:()=>g("Video Consultation"),className:`btn ${c.includes("Video Consultation")?"btn-dark":"btn-outline-dark"}`,children:"Tele Consultation"})]}),e.jsxs("div",{className:"mb-3 d-flex justify-content-between align-items-center flex-wrap gap-2",children:[e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx(v,{label:"Active",value:"Active",onChange:b,checked:r.includes("Active")}),e.jsx(v,{label:"Completed",value:"Completed",onChange:b,checked:r.includes("Completed")}),e.jsx(v,{label:"Confirmed",value:"Confirmed",onChange:b,checked:r.includes("Confirmed")})]}),e.jsx(T,{color:"secondary",onClick:()=>{k([]),A([]),x([]),j([])},children:"Reset Filters"})]}),e.jsxs(P,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(L,{children:e.jsxs(m,{children:[e.jsx(i,{children:"S.No"}),e.jsx(i,{children:"H_ID"}),e.jsx(i,{children:"Name"}),e.jsx(i,{children:"Service Name"}),e.jsx(i,{children:"Consultation Type"}),e.jsx(i,{children:"Date"}),e.jsx(i,{children:"Time"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Action"})]})}),e.jsx(M,{children:D?e.jsx(m,{children:e.jsx(l,{colSpan:"9",className:"text-center text-primary fw-bold",children:"Loading appointments..."})}):Array.isArray(f)&&f.length>0?F.map((t,s)=>{var a;return e.jsxs(m,{children:[e.jsx(l,{children:s+1}),e.jsx(l,{children:t.clinicId}),e.jsx(l,{children:t.name}),e.jsx(l,{children:t.subServiceName}),e.jsx(l,{children:t.consultationType}),e.jsxs(l,{children:[t.sele?`${t.sele} `:"",t.serviceDate]}),e.jsx(l,{children:t.slot||t.servicetime}),e.jsx(l,{children:e.jsx(R,{color:"info",children:(a=t.status)==null?void 0:a.split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ")})}),e.jsx(l,{children:e.jsx(T,{color:"info",size:"sm",onClick:()=>$(`/appointmentDetails/${t.bookingId}`,{state:{appointment:t}}),children:"View"})})]},`${t.id}-${s}`)}):e.jsx(m,{children:e.jsx(l,{colSpan:"9",className:"text-center text-danger fw-bold",children:"No appointments found."})})})]}),e.jsx("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end"},children:Array.from({length:Math.ceil(f.length/C)},(t,s)=>e.jsx("button",{onClick:()=>y(s+1),style:{margin:"0 5px",padding:"5px 10px",backgroundColor:u===s+1?"#007bff":"#fff",color:u===s+1?"#fff":"#000",border:"1px solid #ccc",borderRadius:"5px"},children:s+1},s))})]})})};export{te as default};
