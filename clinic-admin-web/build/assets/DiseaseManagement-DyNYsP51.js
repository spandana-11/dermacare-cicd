import{o as A,B as F,H as pe,I as me,U as he,J as ue,r as i,j as e,Q as xe,x as m}from"./index-Bbof3Raq.js";import{c as ye,a as x}from"./index.esm-DU0vhm2R.js";/* empty css                      */import{X as je}from"./index.es-BAZgkv5U.js";import{C as B}from"./CForm-DxYkKeUQ.js";import{C as fe}from"./CInputGroup-CtTcLUUM.js";import{C as y}from"./CFormInput-CmKNn4Xk.js";import{C as be}from"./CInputGroupText-C29dhTFc.js";import{c as Ce}from"./cil-search-CDkY_4k-.js";import{C as E,a as M,b as k}from"./CModalHeader-DgAtWpAm.js";import{C as $}from"./CModalTitle-CUcX6T0i.js";import{C as H,a as j}from"./CRow-C1i5i5s0.js";import{C as L}from"./CModalFooter-BQhV1fDY.js";import"./CFormLabel-siHnfzPm.js";import"./CConditionalPortal-Brqyb-aa.js";const De=async l=>{try{const o=await A.get(`${F}/${pe}/${l}`);return console.log("test data:",o.data),o.data}catch(o){throw console.error("Error fetching test data:",o.message),o.response&&(console.error("Error Response Data:",o.response.data),console.error("Error Response Status:",o.response.status)),o}},ge=async l=>{var o;try{const n={disease:l.disease||"",hospitalId:l.hospitalId||""},r=await A.post(`${F}/${me}`,n,{headers:{"Content-Type":"application/json"}});return console.log("Add Disease Response:",r),r.data}catch(n){throw console.error("Error adding disease:",((o=n.response)==null?void 0:o.data)||n),n}},Se=async(l,o,n)=>{var r;try{return(await A.put(`${F}/${he}/${o}/${n}`,l,{headers:{"Content-Type":"application/json"}})).data}catch(h){throw console.error("Error updating disease:",((r=h.response)==null?void 0:r.data)||h),h}},we=async(l,o)=>{var n;try{const r=await A.delete(`${F}/${ue}/${l}/${o}`,{headers:{"Content-Type":"application/json"}});return console.log("Disease deleted successfully:",r.data),r.data}catch(r){throw console.error("Error deleting disease:",((n=r.response)==null?void 0:n.data)||r),r}},Ue=()=>{const[l,o]=i.useState(""),[n,r]=i.useState([]),[h,T]=i.useState([]),[X,C]=i.useState(!1),[V,O]=i.useState(null),[K,D]=i.useState(!1),[f,U]=i.useState(null),[W,g]=i.useState(!1),[a,S]=i.useState(null),[w,P]=i.useState({}),[Y,R]=i.useState(!1),[Z,Q]=i.useState(null),[ee,q]=i.useState(null),[d,v]=i.useState({disease:""}),u=localStorage.getItem("HospitalId"),z=["Fever, cough","Headache, fatigue","Nausea, dizziness","Joint pain, swelling","Shortness of breath, chest pain","Skin rash, itching"],G=["Monitor symptoms closely.","Patient should rest.","Follow-up required in 2 weeks.","Medication may be needed.","Symptoms usually mild.","Consult specialist if persists."],N=s=>s[Math.floor(Math.random()*s.length)],se=s=>s.map(t=>({...t,id:t.id||t._id,disease:t.disease||"",probableSymptoms:N(z),notes:N(G)})),_=async s=>{C(!0);try{const t=await De(s);r(se(t.data))}catch{O("Failed to fetch disease data.")}finally{C(!1)}},te=async()=>{try{await we(Z,ee),m.success("Disease deleted successfully!",{position:"top-right"}),_(u)}catch(s){m.error("Failed to delete disease."),console.error("Delete error:",s)}R(!1)},ae=()=>{Q(null),q(null),R(!1)};i.useEffect(()=>{_(u)},[]),i.useEffect(()=>{const s=l.toLowerCase().trim();if(!s){T([]);return}const t=n.filter(c=>{var p;return(p=c.disease)==null?void 0:p.toLowerCase().includes(s)});T(t)},[l,n]);const oe=()=>{const s={};return d.disease.trim()||(s.disease="Disease name is required."),P(s),Object.keys(s).length===0},re=async()=>{var s,t,c,p;if(oe())try{const b={disease:d.disease,hospitalId:u};await ge(b);const I={id:Date.now(),disease:d.disease,probableSymptoms:d.probableSymptoms||N(z),notes:d.notes||N(G),hospitalId:u};r(J=>[I,...J]),v({disease:"",probableSymptoms:"",notes:""}),o(""),m.success("Disease added successfully!"),D(!1)}catch(b){const I=((t=(s=b.response)==null?void 0:s.data)==null?void 0:t.message)||((c=b.response)==null?void 0:c.statusText)||"An unexpected error occurred.";((p=b.response)==null?void 0:p.status)===409||I.toLowerCase().includes("duplicate")?m.error(`Error: Duplicate disease name - ${d.disease} already exists!`,{position:"top-right"}):m.error(`Error adding disease: ${I}`,{position:"top-right"})}},ie=s=>{S({...s,hospitalId:u}),g(!0)},ne=async()=>{if(!a||!a.id){m.error("Missing disease data to update.");return}C(!0);try{await Se({disease:a.disease,hospitalId:u},a.id,u),r(s=>s.map(t=>t.id===a.id?{...t,disease:a.disease,probableSymptoms:a.probableSymptoms||"",notes:a.notes||""}:t)),m.success("Disease updated successfully!"),g(!1)}catch(s){console.error("Update error:",s),m.error("Failed to update disease.")}finally{C(!1)}},le=s=>{Q(s.diseaseId||s.id||s._id),q(s.hospitalId),R(!0)},de=[{name:"S.No",selector:(s,t)=>t+1,width:"5%"},{name:"Disease Name",selector:s=>s.disease,sortable:!0,width:"20%"},{name:"Probable Symptoms",selector:s=>s.probableSymptoms,width:"25%"},{name:"Notes",selector:s=>s.notes,width:"30%"},{name:"Actions",cell:s=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"180px"},children:[e.jsx("div",{onClick:()=>U(s),style:{color:"green",cursor:"pointer"},children:"View"}),e.jsx("div",{onClick:()=>ie(s),style:{color:"blue",cursor:"pointer"},children:"Edit"}),e.jsx("div",{onClick:()=>le(s),style:{color:"red",cursor:"pointer"},children:"Delete"})]})}],ce=({isVisible:s,message:t,onConfirm:c,onCancel:p})=>e.jsxs(E,{visible:s,onClose:p,backdrop:"static",children:[e.jsx(M,{children:e.jsx($,{children:"Confirmation"})}),e.jsx(k,{children:t}),e.jsxs(L,{children:[e.jsx(x,{color:"secondary",onClick:p,children:"Cancel"}),e.jsx(x,{color:"danger",onClick:c,children:"Confirm"})]})]});return e.jsxs("div",{children:[e.jsx(xe,{}),e.jsxs(B,{className:"d-flex justify-content-between mb-3",children:[e.jsxs(fe,{className:"mb-3",style:{width:"300px",marginLeft:"40px"},children:[e.jsx(y,{type:"text",placeholder:"Search by Disease Name",value:l,onChange:s=>o(s.target.value)}),e.jsx(be,{children:e.jsx(ye,{icon:Ce})})]}),e.jsx(x,{color:"primary",style:{marginRight:"100px"},onClick:()=>D(!0),children:"Add Disease"})]}),f&&e.jsxs(E,{visible:!!f,onClose:()=>U(null),children:[e.jsx(M,{children:e.jsx($,{children:"Disease Details"})}),e.jsxs(k,{children:[e.jsxs(H,{className:"mb-3",children:[e.jsx(j,{sm:4,children:e.jsx("strong",{children:"Disease Name:"})}),e.jsx(j,{sm:8,children:f.disease})]}),e.jsxs(H,{className:"mb-3",children:[e.jsx(j,{sm:4,children:e.jsx("strong",{children:"Probable Symptoms:"})}),e.jsx(j,{sm:8,children:f.probableSymptoms})]}),e.jsxs(H,{className:"mb-3",children:[e.jsx(j,{sm:4,children:e.jsx("strong",{children:"Notes:"})}),e.jsx(j,{sm:8,children:f.notes})]})]})]}),e.jsxs(E,{visible:K,onClose:()=>D(!1),backdrop:"static",children:[e.jsx(M,{children:e.jsx($,{children:"Add New Disease"})}),e.jsx(k,{children:e.jsxs(B,{children:[e.jsxs("h6",{children:["Disease Name ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(y,{type:"text",name:"disease",value:d.disease,onChange:s=>{const t=s.target.value;v({...d,disease:t}),w.disease&&P(c=>({...c,disease:""}))},placeholder:"Enter disease name",className:w.disease?"is-invalid":""}),w.disease&&e.jsx("div",{className:"invalid-feedback",style:{color:"red"},children:w.disease}),e.jsx("h6",{className:"mt-3",children:"Probable Symptoms"}),e.jsx(y,{type:"text",name:"probableSymptoms",value:d.probableSymptoms||"",onChange:s=>v({...d,probableSymptoms:s.target.value}),placeholder:"Enter probable symptoms (optional)"}),e.jsx("h6",{className:"mt-3",children:"Notes"}),e.jsx(y,{type:"text",name:"notes",value:d.notes||"",onChange:s=>v({...d,notes:s.target.value}),placeholder:"Enter notes (optional)"})]})}),e.jsxs(L,{children:[e.jsx(x,{color:"primary",onClick:re,children:"Add"}),e.jsx(x,{color:"secondary",onClick:()=>D(!1),children:"Cancel"})]})]}),e.jsxs(E,{visible:W,onClose:()=>g(!1),backdrop:"static",children:[e.jsx(M,{children:e.jsx($,{children:"Edit Disease"})}),e.jsx(k,{children:e.jsxs(B,{children:[e.jsx("h6",{children:"Disease Name"}),e.jsx(y,{type:"text",value:(a==null?void 0:a.disease)||"",onChange:s=>S({...a,disease:s.target.value})}),e.jsx("h6",{className:"mt-2",children:"Probable Symptoms"}),e.jsx(y,{type:"text",value:(a==null?void 0:a.probableSymptoms)||"",onChange:s=>S({...a,probableSymptoms:s.target.value})}),e.jsx("h6",{className:"mt-2",children:"Notes"}),e.jsx(y,{type:"text",value:(a==null?void 0:a.notes)||"",onChange:s=>S({...a,notes:s.target.value})})]})}),e.jsxs(L,{children:[e.jsx(x,{color:"primary",onClick:ne,children:"Update"}),e.jsx(x,{color:"secondary",onClick:()=>g(!1),children:"Cancel"})]})]}),e.jsx(ce,{isVisible:Y,message:"Are you sure you want to delete this disease?",onConfirm:te,onCancel:ae}),X?e.jsx("div",{style:{textAlign:"center"},children:"Loading..."}):V?e.jsx("div",{children:V}):e.jsx(je,{columns:de,data:h.length?h:n,pagination:!0})]})};export{Ue as default};
