import{h as re,M as Ye,O as Xe,S as Ze,T as Je,V as es,r as n,j as e,B as R,y as ss,E as rs,H as ts,W as ye,e as ne,i as ae}from"./index-uxa4g2ur.js";import{b as we,c as Y,d as X,a as os,e as ns}from"./index-DyYk9zWq.js";import{c as Z}from"./capitalizeWords-CuwF8AcI.js";import{C as Fe}from"./ConfirmationModal-CqaUvATP.js";import{C as xe,a as pe}from"./CCardBody-CKAxebwi.js";import{b as S}from"./index.esm-DjiU8BSy.js";import{C as Ie}from"./CForm-DBDKG-J3.js";import{a as se,C as as}from"./CRow-CyOXNQXL.js";import{C as J,b as ie}from"./CFormInput-Bq8b7aaW.js";import{C as Ae}from"./CInputGroup-DQxgcdxh.js";import{C as Ne,a as ke}from"./CListGroupItem-sMVrVkYw.js";import{C as Pe,a as Ee,b as qe,c as Qe}from"./CAccordionItem-G8Ih4WAz.js";import{S as cs}from"./react-select.esm-C3w8o2bt.js";import{C as Ce}from"./CFormSelect-CgaU_adc.js";import{C as is,a as ls,b as le,c as de,d as ds,e as ce}from"./CTable-Kp0k1S59.js";import{C as us,a as ms,b as hs}from"./CModalHeader-B9tHwb6P.js";import{C as vs}from"./CModalTitle-C7iQGtyU.js";import{C as xs}from"./CModalFooter-Bsfp-_9q.js";import{C as ps,a as ue,b as me}from"./CNavItem-BPRZGw1g.js";import{a as gs,b as he}from"./DefaultLayout-DuKnEPD3.js";import"./CFormLabel-BuZXY1hU.js";import"./defineProperty-DevPl9dM.js";import"./slicedToArray-D6Gft5C9.js";import"./CustomerViewDetails-DHdEXT0k.js";const Te=async(v,u,m)=>{try{const p=await re.post(`${Ze}/${u}/${m}`,v,{headers:{"Content-Type":"application/json"}});return console.log("Add API response:",p.data),p.data}catch(p){throw console.error("Error response from API:",p.response||p.message),p}},$e=async(v,u,m)=>{try{return(await re.put(`${Xe}/${u}/${m}`,v,{headers:{"Content-Type":"application/json"}})).data}catch(p){throw console.error("Error updating consentForm:",p.response||p.message),p}},Me=async v=>{try{const u=await re.delete(`${Je}/${v}`,{headers:{"Content-Type":"application/json"}});return console.log("ConsentForm deleted successfully:",u.data),u.data}catch(u){throw console.error("Error deleting ConsentForm:",u.response||u.message),u}},ve=async(v,u)=>{try{const m=await re.get(`${Ye}/${v}/${u}`);return console.log("Fetched data:",m.data),m.data}catch(m){throw console.error("Error fetching test data:",m.response||m.message),m}},Se=async(v,u)=>{try{const m=await re.get(`${es}/${v}/${u}`);return console.log("Procedure Consent Form data:",m.data),m.data}catch(m){throw console.error("Error fetching Procedure Form data:",m.message),m.response&&(console.error("Error Response Data:",m.response.data),console.error("Error Response Status:",m.response.status)),m}},fs=()=>{const[v,u]=n.useState(!1),[m,p]=n.useState([]),[y,w]=n.useState([]),[k,P]=n.useState(""),[Q,I]=n.useState(""),[f,N]=n.useState([]),[U,z]=n.useState(null),[ee,E]=n.useState(null),[te,H]=n.useState({}),[oe,_]=n.useState(!1),[W,M]=n.useState(null),[K,a]=n.useState(null),[h,x]=n.useState(!1),g=localStorage.getItem("HospitalId"),C="1";n.useEffect(()=>{(async()=>{try{const o=await ve(g,C);if(console.log("âœ… Forms from API:",o.data),o!=null&&o.data){const j=(Array.isArray(o.data)?o.data:[o.data]).map(b=>({...b,consentFormQuestions:b.consentFormQuestions||[]}));p(j)}}catch(o){console.error("Error fetching saved forms",o)}})()},[g,C]);const D=()=>{if(Q.trim()){if(U!==null){const c=[...f];c[U]=Q.trim(),N(c),z(null)}else f.includes(Q.trim())||N([...f,Q.trim()]);I("")}},O=c=>{N(f.filter(o=>o!==c))},G=()=>{const c=k.trim();if(!c||f.length===0){if(c===""&&f.length===0)return;R.error("Please add a question and at least one answer.");return}if(y.some(o=>o.question===c)){R.error("This question already exists.");return}w([...y,{question:c,answers:[...f]}]),P(""),N([])},T=c=>{w(y.filter((o,d)=>d!==c))},$=async()=>{const c={};if(y.length===0&&(c.qaList="At least one question is required."),Object.keys(c).length>0){H(c);return}H({});const o={consentFormQuestions:y.map(d=>({heading:d.question,questionsAndAnswers:d.answers.map(j=>({question:j,answer:!0}))}))};try{ee!==null?await $e(o,g,C):await Te(o,g,C);const d=await ve(g,C);d!=null&&d.data&&p(Array.isArray(d.data)?d.data:[d.data]),w([]),u(!1),E(null),x(!1)}catch(d){console.error("Error saving Generic Form:",d)}},V=c=>{const o=m[c];if(!o){R.error("Selected form not found");return}const d=(o.consentFormQuestions||[]).map(j=>({question:j.heading,answers:(j.questionsAndAnswers||[]).map(b=>b.question)}));w(d),E(c),u(!0),H({})},q=async c=>{const o=m[c],d=(o==null?void 0:o.id)||(o==null?void 0:o.consentFormId)||(o==null?void 0:o.formId);if(!d){R.error("This form cannot be deleted.");return}try{await Me(d),p(m.filter((j,b)=>b!==c)),x(!1)}catch(j){console.error("Error deleting Generic Form:",j),R.error("Failed to delete form.")}},B=c=>{const o=y[c];P(o.question),N(o.answers),w(y.filter((d,j)=>j!==c))};return e.jsxs(xe,{className:"mt-3",children:[e.jsxs(pe,{children:[!v&&e.jsx("div",{className:"w-100 d-flex justify-content-end",children:e.jsx(S,{style:{color:"var(--color-black)",backgroundColor:"var(--color-bgcolor)"},onClick:()=>{u(!0),w([]),E(null),x(!0)},disabled:h||m.length>0,children:"+ Add Generic Form"})}),v&&e.jsxs(Ie,{className:"mb-4",children:[e.jsxs(se,{md:12,children:[e.jsx("h6",{className:"mb-2",children:"Question"}),e.jsx(J,{placeholder:"Enter question",value:k,onChange:c=>P(c.target.value)}),e.jsx("h6",{className:"mt-3 mb-2",children:"Answers"}),e.jsxs(Ae,{className:"mb-2",children:[e.jsx(J,{placeholder:"Enter answer",value:Q,onChange:c=>I(c.target.value)}),e.jsx(S,{onClick:D,style:{backgroundColor:"var(--color-black)",color:"white"},children:e.jsx(we,{})})]}),f.length>0&&e.jsx(Ne,{className:"mb-3",children:f.map((c,o)=>e.jsxs(ke,{className:"d-flex justify-content-between align-items-center",children:[c,e.jsxs("div",{children:[e.jsx(Y,{onClick:()=>{I(c),z(o)},style:{cursor:"pointer",color:"var(--color-black)",marginRight:"10px"}}),e.jsx(X,{onClick:()=>O(c),style:{cursor:"pointer",color:"var(--color-black)"}})]})]},o))}),e.jsx(S,{color:"info",className:"me-2",onClick:G,style:{backgroundColor:"var(--color-bgcolor)",color:"var(--color-black)",border:"none"},children:"Add Question"})]}),y.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Questions Added"}),y.map((c,o)=>e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:c.question}),e.jsx("ul",{children:c.answers.map((d,j)=>e.jsx("li",{children:d},j))}),e.jsxs("div",{children:[e.jsx(Y,{onClick:()=>B(o),style:{cursor:"pointer",color:"var(--color-black)",marginRight:"10px"}}),e.jsx(X,{onClick:()=>T(o),style:{cursor:"pointer",color:"var(--color-black)"}})]})]},o))]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(S,{color:"secondary",className:"me-2",onClick:()=>u(!1),children:"Cancel"}),e.jsx(S,{style:{backgroundColor:"var(--color-bgcolor)",color:"var(--color-black)",border:"none"},onClick:$,children:ee!==null?"Update Generic Form":"Save Generic Form"})]})]}),m.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h6",{children:"Saved Generic Forms"}),e.jsx(Pe,{children:m.map((c,o)=>e.jsxs(Ee,{itemKey:o,children:[e.jsx(qe,{children:Z(c.subServiceName)||" Generic Consent Form"}),e.jsxs(Qe,{children:[Array.isArray(c.consentFormQuestions)&&c.consentFormQuestions.map((d,j)=>e.jsxs("div",{children:[e.jsx("h6",{children:Z(d.heading)}),Array.isArray(d.questionsAndAnswers)&&d.questionsAndAnswers.map((b,L)=>e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("input",{type:"checkbox",className:"me-2",disabled:!0,checked:b.answer===void 0?!0:!!b.answer}),e.jsx("span",{children:Z(b.question)})]},L))]},j)),e.jsxs("div",{className:"d-flex gap-3 mt-2",children:[e.jsx(Y,{onClick:()=>V(o),style:{color:"var(--color-black)",cursor:"pointer"}}),e.jsx(X,{onClick:()=>{M(o),_(!0),a(c.subServiceName)},style:{color:"var(--color-black)",cursor:"pointer"}})]})]})]},o))})]})]}),e.jsx(Fe,{isVisible:oe,title:"Delete ProcedureConsentForm",message:`Are you sure you want to delete this "${K}" ? This action cannot be undone.`,confirmText:"Yes, Delete",cancelText:"Cancel",confirmColor:"danger",cancelColor:"secondary",onConfirm:()=>{W!==null&&(q(W),M(null)),_(!1)},onCancel:()=>{M(null),_(!1)}})]})},js=()=>{const[v,u]=n.useState([]),[m,p]=n.useState([]),[y,w]=n.useState([]),[k,P]=n.useState([]),[Q,I]=n.useState(!1),[f,N]=n.useState([]),[U,z]=n.useState(null),[ee,E]=n.useState(!1),[te,H]=n.useState(!0),[oe,_]=n.useState(null),[W,M]=n.useState(!1),[K,a]=n.useState(null),[h,x]=n.useState(null),[g,C]=n.useState({categoryId:"",serviceId:"",subServiceid:"",subServiceName:"",consentFormQuestions:[]}),[D,O]=n.useState(""),[G,T]=n.useState(""),[$,V]=n.useState([]),[q,B]=n.useState([]),[c,o]=n.useState(null),[d,j]=n.useState({}),b=localStorage.getItem("HospitalId"),L="2";n.useEffect(()=>{(async()=>{var s;try{const t=await ss();Array.isArray(t.data)?u(t.data):Array.isArray((s=t.data)==null?void 0:s.data)?u(t.data.data):u([])}catch(t){console.error("Error fetching categories:",t)}})()},[]),n.useEffect(()=>{(async()=>{console.log(b),console.log(L);try{const s=await ve(b,L);s!=null&&s.data&&N(Array.isArray(s.data)?s.data:[s.data])}catch(s){console.error("Error fetching saved forms",s)}})()},[b]),n.useEffect(()=>{if(!g.categoryId){p([]);return}(async()=>{try{const s=await rs(g.categoryId);p((s==null?void 0:s.data)||[])}catch(s){console.error("Error fetching services",s),p([])}})()},[g.categoryId]),n.useEffect(()=>{if(!g.serviceId){w([]);return}(async()=>{try{const s=await ts(g.serviceId),t=(s==null?void 0:s.data)||[];let l=[];Array.isArray(t)?l=t.flatMap(i=>i.subServices||[]):t!=null&&t.subServices&&(l=t.subServices),console.log(l),w(l)}catch(s){console.error("Error fetching subServices",s),w([])}})()},[g.serviceId]),n.useEffect(()=>{(async()=>{try{const s=await Se(b,L);if(console.log("âœ… Forms from API:",s.data),s!=null&&s.data){const t=(Array.isArray(s.data)?s.data:[s.data]).map(l=>({...l,consentFormQuestions:l.consentFormQuestions||[]}));N(t)}}catch(s){console.error("Error fetching saved forms",s)}})()},[b,L]);const ge=r=>{const{name:s,value:t}=r.target;C(l=>{const i={...l,[s]:t};return s==="categoryId"&&(i.serviceId="",i.subServiceid=""),s==="serviceId"&&(i.subServiceid=""),i})},fe=async r=>{let s=!1;const t=localStorage.getItem("HospitalId");for(const l of r){const i=await ye(t,l);if(!i||!i.price||!i.finalCost){s=!0;break}}H(!s)},De=()=>{if(G.trim()){if(U!==null){const r=[...$];r[U]=G.trim(),V(r),z(null)}else $.includes(G.trim())||V([...$,G.trim()]);T("")}},Ge=r=>{V($.filter(s=>s!==r))},Le=()=>{if(D.trim()&&$.length>0){if(q.some(r=>r.question===D.trim())){alert("This question already exists.");return}B([...q,{question:D.trim(),answers:[...$]}]),O(""),V([])}},Re=r=>{B(q.filter((s,t)=>t!==r))},Ue=async()=>{const r={};if((!k||k.length===0)&&(r.subServiceName="At least one Procedure must be selected."),q.length===0&&(r.qaList="At least one question is required."),Object.keys(r).length>0){j(r);return}j({});const s=k.map(t=>({subServiceid:t,consentFormQuestions:q.map(l=>({heading:l.question,questionsAndAnswers:l.answers.map(i=>({question:i,answer:!0}))}))}));try{if(c!==null)await $e(s[0],b,L);else for(const l of s)await Te(l,b,L);const t=await Se(b,L);t!=null&&t.data&&N(Array.isArray(t.data)?t.data:[t.data]),C({categoryId:"",serviceId:"",subServiceid:"",subServiceName:"",consentFormQuestions:[]}),B([]),P([]),I(!1),o(null)}catch(t){console.error("Error saving Procedure Form:",t)}},Be=async r=>{var s;try{const t=f[r];if(!t){R.error("Selected form not found");return}const l=t.subServiceid??t.subServiceId??((s=t==null?void 0:t.subService)==null?void 0:s.subServiceId)??(t==null?void 0:t.id);l||console.warn("No subService id found on selected form:",t);let i=null;if(l)try{i=await ye(b,l)}catch(F){console.warn("getSubServiceById failed:",F)}const A=l??(i==null?void 0:i.subServiceId)??"",je=(i==null?void 0:i.subServiceName)??t.subServiceName??"",Oe=(i==null?void 0:i.serviceId)??t.serviceId??"",Ve=(i==null?void 0:i.categoryId)??t.categoryId??"";i?w(F=>F.some(Ke=>String(Ke.subServiceId)===String(i.subServiceId))?F:[...F,i]):A&&!y.some(F=>String(F.subServiceId)===String(A))&&w(F=>[...F,{subServiceId:A,subServiceName:je||"Unknown"}]),C({categoryId:Ve||"",serviceId:Oe||"",subServiceid:A||"",subServiceName:je||"",consentFormQuestions:t.consentFormQuestions||[]}),P(A?[A]:[]);const _e=(t.consentFormQuestions||[]).map(F=>({question:F.heading,answers:(F.questionsAndAnswers||[]).map(be=>be.question)}));B(_e),o(r),I(!0),j({});const We=f.some(F=>String(F.subServiceid??F.subServiceId??"")===String(A));E(!We),A&&fe([A])}catch(t){console.error("Error in editProcedureForm:",t),R.error("Unable to prepare edit form. Check console for details.")}},ze=async r=>{const s=f[r],t=(s==null?void 0:s.id)||(s==null?void 0:s.consentFormId)||(s==null?void 0:s.formId);if(!(s!=null&&s.id)){R.error("This form does not have an ID and cannot be deleted.");return}try{await Me(t);const l=f.filter((i,A)=>A!==r);N(l)}catch(l){console.error("Error deleting Procedure Form:",l),R.error("Failed to delete procedure form.")}},He=r=>{const s=q[r];O(s.question),V(s.answers);const t=q.filter((l,i)=>i!==r);B(t)};return e.jsxs(xe,{className:"mt-3",children:[e.jsxs(pe,{children:[!Q&&e.jsx("div",{className:"  w-100",style:{display:"flex",justifyContent:"end",alignContent:"end",alignItems:"end"},children:e.jsx(S,{style:{color:"var(--color-black)",backgroundColor:"var(--color-bgcolor)"},onClick:()=>{I(!0),C({categoryId:"",serviceId:"",subServiceid:"",subServiceName:"",consentFormQuestions:[]}),B([]),o(null)},children:"+ Add Procedure Form"})}),Q&&e.jsxs(Ie,{className:"mb-4",children:[e.jsxs(as,{className:"mb-4",children:[e.jsxs(se,{md:4,children:[e.jsxs("h6",{children:["Category Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(Ce,{value:g.categoryId||"",onChange:ge,name:"categoryId","aria-label":"Select Category",children:[e.jsx("option",{value:"",children:"Select a Category"}),v==null?void 0:v.map(r=>e.jsx("option",{value:r.categoryId,children:r.categoryName},r.categoryId))]}),d.categoryId&&e.jsx(ie,{className:"text-danger",children:d.categoryId})]}),e.jsxs(se,{md:4,children:[e.jsxs("h6",{children:["Service Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs(Ce,{name:"serviceId",value:g.serviceId||"",onChange:ge,children:[e.jsx("option",{value:"",children:"Select Service"}),m.map(r=>e.jsx("option",{value:r.serviceId,children:r.serviceName},r.serviceId))]}),d.serviceId&&e.jsx(ie,{className:"text-danger",children:d.serviceId})]}),e.jsxs(se,{md:4,children:[e.jsxs("h6",{children:["Procedure Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(cs,{isMulti:!0,name:"subServiceName",placeholder:"Select Sub Services",options:(y||[]).map(r=>({label:r.subServiceName,value:r.subServiceId})),value:(y||[]).filter(r=>k.includes(r.subServiceId)).map(r=>({label:r.subServiceName,value:r.subServiceId})),onChange:r=>{const s=r.map(l=>l.value);P(s),r.length>0&&j(l=>({...l,subServiceName:""}));const t=s.some(l=>!f.some(i=>String(i.subServiceid)===String(l)));E(t),fe(s)}}),!te&&e.jsxs("div",{className:"text-danger mt-2",children:["Some selected Procedures are missing details like price or final cost.",e.jsx("br",{}),e.jsx("a",{href:"/procedure-Management",className:"text-primary",children:"Please add Procedure details"})]}),d.subServiceName&&e.jsx(ie,{className:"text-danger",children:d.subServiceName})]})]}),e.jsxs(se,{md:12,children:[e.jsx("h6",{className:"mb-2",children:"Question"}),e.jsx(J,{placeholder:"Enter question",value:D,onChange:r=>O(r.target.value)}),e.jsx("h6",{className:"mt-3 mb-2",children:"Answers"}),e.jsxs(Ae,{className:"mb-2",children:[e.jsx(J,{placeholder:"Enter answer",value:G,onChange:r=>T(r.target.value)}),e.jsx(S,{onClick:De,style:{backgroundColor:"var(--color-black)",color:"white"},children:e.jsx(we,{})})]}),$.length>0&&e.jsx(Ne,{className:"mb-3",children:$.map((r,s)=>e.jsxs(ke,{className:"d-flex justify-content-between align-items-center",children:[r,e.jsxs("div",{children:[e.jsx(Y,{onClick:()=>{T(r),z(s)},style:{cursor:"pointer",color:"var(--color-black)",marginRight:"10px"}}),e.jsx(X,{onClick:()=>Ge(r),style:{cursor:"pointer",color:"var(--color-black)"}})]})]},s))}),e.jsx(S,{color:"info",className:"me-2  ",onClick:Le,style:{backgroundColor:"var(--color-bgcolor)",color:"var(--color-black)",border:"none"},children:"Add Question"})]}),q.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Questions Added"}),q.map((r,s)=>e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:r.question}),e.jsx("ul",{children:r.answers.map((t,l)=>e.jsx("li",{children:t},l))}),e.jsxs("div",{children:[e.jsx(Y,{onClick:()=>He(s),style:{cursor:"pointer",color:"var(--color-black)",marginRight:"10px"}}),e.jsx(X,{onClick:()=>Re(s),style:{cursor:"pointer",color:"var(--color-black)"}})]})]},s))]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(S,{color:"secondary",className:"me-2",onClick:()=>I(!1),children:"Cancel"}),e.jsx(S,{style:{backgroundColor:"var(--color-bgcolor)",color:"var(--color-black)",border:"none"},onClick:Ue,children:c!==null?"Update Procedure Form":"Save Procedure Form"})]})]}),f.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h6",{children:"Saved Procedure Forms"}),e.jsx(Pe,{children:f.map((r,s)=>e.jsx(e.Fragment,{children:e.jsxs(Ee,{itemKey:s,children:[e.jsx(qe,{children:Z(r.subServiceName)||"Unnamed Procedure"}),e.jsxs(Qe,{children:[Array.isArray(r.consentFormQuestions)&&r.consentFormQuestions.map((t,l)=>e.jsxs("div",{children:[e.jsx("h6",{children:Z(t.heading)}),Array.isArray(t.questionsAndAnswers)&&t.questionsAndAnswers.map((i,A)=>e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("input",{type:"checkbox",checked:i.answer===void 0?!0:!!i.answer,className:"me-2",disabled:!0}),e.jsx("span",{children:Z(i.question)})]},A))]},l)),e.jsxs("div",{className:"d-flex gap-3 mt-2",children:[e.jsx(Y,{onClick:()=>Be(s),style:{color:"var(--color-black)",cursor:"pointer"}}),e.jsx(X,{onClick:()=>{a(s),M(!0),x(r.subServiceName)},style:{color:"var(--color-black)",cursor:"pointer"}})]})]})]},s)}))})]})]}),e.jsx(Fe,{isVisible:W,title:"Delete Procedure Consent",message:`Are you sure you want to delete this "${h}" ? This action cannot be undone.`,confirmText:"Yes, Delete",cancelText:"Cancel",confirmColor:"danger",cancelColor:"secondary",onConfirm:()=>{K!==null&&(ze(K),a(null)),M(!1)},onCancel:()=>{a(null),M(!1)}})]})},bs=()=>{const[v,u]=n.useState([]),[m,p]=n.useState(null),[y,w]=n.useState(""),[k,P]=n.useState(null),[Q,I]=n.useState(!1),[f,N]=n.useState(null),[U,z]=n.useState(!1),ee=20*1024*1024;n.useEffect(()=>{E()},[]);const E=async()=>{var a;try{const h=await ne.get(`${ae}/getAllPolicies`);(a=h.data)!=null&&a.data?u(h.data.data):Array.isArray(h.data)?u(h.data):u([])}catch(h){console.error(h)}},te=a=>{const h=a.target.files[0];if(h){if(h.size>ee)return alert("Max size 20MB");P(h)}},H=(a,h)=>{let x=h==null?void 0:h.split(".").pop().toLowerCase(),g=x==="pdf"?"application/pdf":x==="jpg"||x==="jpeg"?"image/jpeg":x==="png"?"image/png":"application/octet-stream";a.startsWith("data:")&&(a=a.split(",")[1]);const C=atob(a),D=new Array(C.length);for(let T=0;T<C.length;T++)D[T]=C.charCodeAt(T);const O=new Uint8Array(D),G=new Blob([O],{type:g});return URL.createObjectURL(G)},oe=a=>{var C;if(!(a!=null&&a.privacyPolicy))return alert("No file to preview");const h=(C=a.fileName)==null?void 0:C.split(".").pop().toLowerCase(),x=h==="pdf"?"application/pdf":h==="jpg"||h==="jpeg"?"image/jpeg":h==="png"?"image/png":"application/octet-stream";let g=a.privacyPolicy;g=g.replace(/\s+/g,""),g.startsWith("data:")||(g=`data:${x};base64,${g}`),N(g),z(x==="application/pdf"),I(!0)},_=a=>{if(!(a!=null&&a.privacyPolicy))return alert("No file to download");const h=H(a.privacyPolicy,a.fileName),x=document.createElement("a");x.href=h,x.download=a.fileName,document.body.appendChild(x),x.click(),document.body.removeChild(x)},W=a=>{p(a.id),w(a.fileName),P(null)},M=async a=>{if(!y&&!k)return alert("Enter new name or select file");const h={fileName:y};if(k){const x=new FileReader;x.readAsDataURL(k),x.onload=async()=>{h.privacyPolicy=x.result.split(",")[1],await ne.put(`${ae}/updatePolicy/${a}`,h),alert("Updated!"),p(null),P(null),E()}}else await ne.put(`${ae}/updatePolicy/${a}`,h),alert("Updated!"),p(null),E()},K=async a=>{window.confirm("Are you sure?")&&(await ne.delete(`${ae}/deletePolicyById/${a}`),alert("Deleted!"),E())};return e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h2",{className:"mb-4",children:"Privacy Policy Manager"}),e.jsxs(is,{bordered:!0,responsive:!0,children:[e.jsx(ls,{color:"light",children:e.jsxs(le,{children:[e.jsx(de,{children:"#"}),e.jsx(de,{children:"File Name"}),e.jsx(de,{children:"Actions"})]})}),e.jsx(ds,{children:v.length>0?v.map((a,h)=>e.jsxs(le,{children:[e.jsx(ce,{children:h+1}),e.jsx(ce,{children:m===a.id?e.jsx(J,{value:y,onChange:x=>w(x.target.value)}):a.fileName}),e.jsx(ce,{children:m===a.id?e.jsxs(e.Fragment,{children:[e.jsx(J,{type:"file",onChange:te,className:"mb-1"}),e.jsx(S,{color:"primary",size:"sm",onClick:()=>M(a.id),children:"Save"})," ",e.jsx(S,{color:"secondary",size:"sm",onClick:()=>p(null),children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{color:"info",size:"sm",onClick:()=>oe(a),children:e.jsx(os,{})})," ",e.jsx(S,{color:"success",size:"sm",onClick:()=>_(a),children:e.jsx(ns,{})})," ",e.jsx(S,{color:"warning",size:"sm",onClick:()=>W(a),children:"Edit"})," ",e.jsx(S,{color:"danger",size:"sm",onClick:()=>K(a.id),children:"Delete"})]})})]},a.id)):e.jsx(le,{children:e.jsx(ce,{colSpan:"3",className:"text-center",children:"No Policies Found"})})})]}),e.jsxs(us,{visible:Q,onClose:()=>I(!1),size:"xl",children:[e.jsx(ms,{onClose:()=>I(!1),children:e.jsx(vs,{children:U?"PDF Preview":"Image Preview"})}),e.jsx(hs,{className:"text-center",children:U?e.jsx("iframe",{src:f,title:"PDF Preview",style:{width:"100%",height:"80vh",border:"none"}}):e.jsx("img",{src:f,alt:"Preview",style:{maxWidth:"100%",maxHeight:"80vh",borderRadius:"8px"}})}),e.jsx(xs,{children:e.jsx(S,{color:"secondary",onClick:()=>I(!1),children:"Close"})})]})]})},Os=()=>{const[v,u]=n.useState(1);return e.jsx(xe,{children:e.jsxs(pe,{children:[e.jsxs(ps,{variant:"tabs",style:{cursor:"pointer",color:"var(--color-black)"},children:[e.jsx(ue,{children:e.jsx(me,{active:v===1,onClick:()=>u(1),style:{color:"var(--color-black)"},children:"Generic Consent Form"})}),e.jsx(ue,{children:e.jsx(me,{active:v===2,onClick:()=>u(2),style:{color:"var(--color-black)"},children:"Procedure Consent Form"})}),e.jsx(ue,{children:e.jsx(me,{active:v===3,onClick:()=>u(3),style:{color:"var(--color-black)"},children:"Privacy Policy Consent Form"})})]}),e.jsxs(gs,{children:[e.jsx(he,{visible:v===1,children:e.jsx(fs,{})}),e.jsx(he,{visible:v===2,children:e.jsx(js,{})}),e.jsx(he,{visible:v===3,children:e.jsx(bs,{})})]})]})})};export{Os as default};
