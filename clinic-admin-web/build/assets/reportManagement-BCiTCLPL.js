import{r as s,h as b,j as t}from"./index-EDE8c9MU.js";import{A as I}from"./appointmentAPI-BAQG-kgf.js";import{a as x}from"./index.esm-DqT4Gkkm.js";import{C as w,a as N,b as d,c as i,d as k,e as a}from"./CTable-BN_W_bcG.js";const O=()=>{const[p,u]=s.useState([]),[A,D]=s.useState(!0),[l,j]=s.useState([]),[E,F]=s.useState([]),S=b(),[r,c]=s.useState([]),[B,H]=s.useState([]),[L,R]=s.useState(1),[V,T]=s.useState([]),[$,g]=s.useState([]),[z,M]=s.useState([]),[P,X]=s.useState([]),C={"Service & Treatment":"services & treatments","Video Consultation":"online consultation","In-clinic":"in-clinic consultation"},h=async()=>{try{const e=await I();j(e.data||[])}catch(e){console.error("Failed to fetch appointments:",e)}};s.useEffect(()=>{localStorage.getItem("HospitalId")&&h()},[]),s.useEffect(()=>{let e=l.filter(n=>f(n.status)==="completed");if(r.length===1){const n=r[0],o=C[n];o&&(e=e.filter(v=>f(v.consultationType)===o))}u(e)},[l,r]),s.useEffect(()=>{const e=[...new Set(l.map(o=>o.servicename).filter(Boolean))],n=[...new Set(l.map(o=>o.consultationType).filter(Boolean))];T(e),g(n),console.log("Available Consultation Types:",n)},[l]);const y=e=>{r.includes(e)?c([]):c([e])},m="Completed";s.useEffect(()=>{const e=l.filter(n=>{var o;return((o=n.status)==null?void 0:o.toLowerCase().trim())===m.toLowerCase().trim()});u(e)},[l,m]),s.useEffect(()=>{localStorage.getItem("HospitalId")?h():console.warn("No HospitalId in localStorage")},[]);const f=e=>e==null?void 0:e.toLowerCase().trim();return t.jsx("div",{style:{overflowX:"auto"},children:t.jsxs("div",{className:"container mt-4",children:[t.jsx("h5",{className:"mb-3",children:"Appointments"}),t.jsx("div",{className:"d-flex gap-2 mb-3",children:["Service & Treatment","In-clinic","Video Consultation"].map(e=>t.jsx("button",{onClick:()=>y(e),className:`btn ${r.includes(e)?"btn-dark":"btn-outline-dark"}`,children:e},e))}),t.jsx("div",{className:"mb-3",children:t.jsx(x,{color:"secondary",onClick:()=>c([]),children:"Reset Filters"})}),t.jsxs(w,{striped:!0,hover:!0,responsive:!0,children:[t.jsx(N,{children:t.jsxs(d,{children:[t.jsx(i,{children:"S.No"}),t.jsx(i,{children:"Name"}),t.jsx(i,{children:"Consultation Type"}),t.jsx(i,{children:"Date"}),t.jsx(i,{children:"Time"}),t.jsx(i,{children:"Status"}),t.jsx(i,{children:"Action"})]})}),t.jsx(k,{children:p.length>0?p.map((e,n)=>t.jsxs(d,{children:[t.jsx(a,{children:n+1}),t.jsx(a,{children:e.name}),t.jsx(a,{children:e.consultationType}),t.jsx(a,{children:e.serviceDate}),t.jsx(a,{children:e.slot||e.servicetime}),t.jsx(a,{children:e.status}),t.jsx(a,{children:t.jsx(x,{color:"primary",size:"sm",onClick:()=>S(`/reportDetails/${e.reportId}`,{state:{report:e,appointmentInfo:{name:e.name,age:e.age,gender:e.gender,problem:e.problem,bookingId:e.bookingId,item:e}}}),children:"View"})})]},`${e.bookingId}-${n}`)):t.jsx(d,{children:t.jsx(a,{colSpan:"8",className:"text-center text-danger fw-bold",children:"No completed appointments found."})})})]})]})})};export{O as default};
