import{r as n,h as R,j as e}from"./index-DzLAwNkK.js";import{G as E}from"./appointmentAPI-BlfzE0dK.js";import{C as h}from"./CFormCheck-Iq_d56XJ.js";import{a as T}from"./index.esm-l-WhNZwE.js";import{C as V,a as L,b as g,c as i,d as M,e as o}from"./CTable-s7emOImN.js";import{j as z}from"./DefaultLayout-alpaIdsc.js";import"./CFormLabel-DycmuJxn.js";import"./CConditionalPortal-RBUkZH3n.js";const se=()=>{const[G,_]=n.useState(null),[U,k]=n.useState([]),[q,w]=n.useState([]),[f,I]=n.useState([]),[J,N]=n.useState([]),[K,A]=n.useState([]),[d,m]=n.useState([]),[c,j]=n.useState([]),[a,C]=n.useState([]),[u,v]=n.useState(1),[D,S]=n.useState(!0),b=7,P=R(),B=async()=>{try{const t=localStorage.getItem("HospitalId");if(console.log("Hospital ID from localStorage:",t),!t){m([]),S(!1);return}const s=await E(t);console.log("Appointments for this Hospital:",s),s!=null&&s.data?m(s.data):(console.warn("No data returned for Hospital ID:",t),m([]))}catch(t){console.error("Failed to fetch appointments:",t),m([])}finally{S(!1)}},F=t=>{switch(console.log(t),t==null?void 0:t.toLowerCase()){case"completed":return"success";case"Rejected":return"danger";case"pending":return"warning";case"confirmed":return"info";case"in progress":return"primary";case"rescheduled":return"secondary";default:return"dark"}};n.useEffect(()=>{B()},[]),n.useEffect(()=>{let t=[...d];console.log("Initial bookings:",t);const s=l=>l==null?void 0:l.toLowerCase().trim(),r={"Service & Treatment":"services & treatments","Video Consultation":"online consultation","In-clinic":"in-clinic consultation"};if(a.length>0&&(t=t.filter(l=>a.some(x=>s(x)===s(l.status))),console.log("After status filter:",t)),c.length===1){const l=c[0],x=r[l];x&&(t=t.filter(H=>s(H.consultationType)===x),console.log(`After ${l} filter:`,t))}I(t),v(1)},[d,c,a]),n.useEffect(()=>{const t=[...new Set(d.map(r=>r.subServiceName).filter(Boolean))],s=[...new Set(d.map(r=>r.consultationType).filter(Boolean))];N(t),A(s),console.log("Available Consultation Types:",s)},[d]),n.useEffect(()=>{window.scrollTo(0,0)},[u]);const $=f.slice((u-1)*b,u*b),y=t=>{c.includes(t)?j([]):j([t])},p=t=>{const s=t.target.value;a.includes(s)?C([]):C([s])};return e.jsx("div",{style:{overflow:"hidden"},children:e.jsxs("div",{className:"container mt-4",children:[e.jsx("h5",{children:"Appointments"}),e.jsxs("div",{className:"d-flex gap-2 mb-3",children:[e.jsx("button",{onClick:()=>y("Service & Treatment"),className:`btn ${c.includes("Service & Treatment")?"btn-dark":"btn-outline-dark"}`,children:"Service & Treatment"}),e.jsx("button",{onClick:()=>y("In-clinic"),className:`btn ${c.includes("In-clinic")?"btn-dark":"btn-outline-dark"}`,children:"In-Clinic Consultation"}),e.jsx("button",{onClick:()=>y("Video Consultation"),className:`btn ${c.includes("Video Consultation")?"btn-dark":"btn-outline-dark"}`,children:"Video Consultation"})]}),e.jsxs("div",{className:"mb-3 d-flex justify-content-between align-items-center flex-wrap gap-2",children:[e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx(h,{label:"Pending",value:"Pending",onChange:p,checked:a.includes("Pending")}),e.jsx(h,{label:"In-Progress",value:"In-Progress",onChange:p,checked:a.includes("In-Progress")}),e.jsx(h,{label:"Completed",value:"Completed",onChange:p,checked:a.includes("Completed")}),e.jsx(h,{label:"Confirmed",value:"Confirmed",onChange:p,checked:a.includes("Confirmed")}),e.jsx(h,{label:"Rejected",value:"Rejected",onChange:p,checked:a.includes("Rejected")})]}),e.jsx(T,{color:"secondary",onClick:()=>{k([]),w([]),j([]),C([])},children:"Reset Filters"})]}),e.jsxs(V,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(L,{children:e.jsxs(g,{children:[e.jsx(i,{children:"S.No"}),e.jsx(i,{children:"H_ID"}),e.jsx(i,{children:"Name"}),e.jsx(i,{children:"Service Name"}),e.jsx(i,{children:"Consultation Type"}),e.jsx(i,{children:"Date"}),e.jsx(i,{children:"Time"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Action"})]})}),e.jsx(M,{children:D?e.jsx(g,{children:e.jsx(o,{colSpan:"9",className:"text-center text-primary fw-bold",children:"Loading appointments..."})}):Array.isArray(f)&&f.length>0?$.map((t,s)=>{var r;return e.jsxs(g,{children:[e.jsx(o,{children:s+1}),e.jsx(o,{children:t.clinicId}),e.jsx(o,{children:t.name}),e.jsx(o,{children:t.subServiceName}),e.jsx(o,{children:t.consultationType}),e.jsxs(o,{children:[t.sele?`${t.sele} `:"",t.serviceDate]}),e.jsx(o,{children:t.slot||t.servicetime}),e.jsx(o,{children:e.jsx(z,{color:F(t.status),children:(r=t.status)==null?void 0:r.split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")})}),e.jsx(o,{children:e.jsx(T,{color:"primary",size:"sm",onClick:()=>P(`/appointmentDetails/${t.bookingId}`,{state:{appointment:t}}),children:"View"})})]},`${t.id}-${s}`)}):e.jsx(g,{children:e.jsx(o,{colSpan:"9",className:"text-center text-danger fw-bold",children:"No appointments found."})})})]}),e.jsx("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end"},children:Array.from({length:Math.ceil(f.length/b)},(t,s)=>e.jsx("button",{onClick:()=>v(s+1),style:{margin:"0 5px",padding:"5px 10px",backgroundColor:u===s+1?"#007bff":"#fff",color:u===s+1?"#fff":"#000",border:"1px solid #ccc",borderRadius:"5px"},children:s+1},s))})]})})};export{se as default};
