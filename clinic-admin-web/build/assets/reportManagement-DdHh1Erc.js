import{r as n,h as w,j as t}from"./index-CvjLi_3Y.js";import{A as k}from"./appointmentAPI-j0Pc8aCK.js";import{a as g}from"./index.esm-EslNgVKV.js";import{C as N,a as A,b as m,c as i,d as D,e as a}from"./CTable-BuYhlkaI.js";const U=()=>{const[f,h]=n.useState([]),[F,E]=n.useState(!0),[l,x]=n.useState([]),[B,H]=n.useState([]),j=w(),[c,d]=n.useState([]),[L,R]=n.useState([]),[V,$]=n.useState(1),[z,T]=n.useState([]),[M,C]=n.useState([]),[P,X]=n.useState([]),[q,G]=n.useState([]),[v,y]=n.useState(null),b={"Service & Treatment":"services & treatments","Video Consultation":"online consultation","In-clinic":"in-clinic consultation"},p=async e=>{try{const s=await k();if(s&&s.data){const o=e?s.data.filter(u=>r(u.clinicId)===r(e)):s.data;x(o||[])}}catch(s){console.error("Failed to fetch appointments:",s),x([])}};n.useEffect(()=>{const e=localStorage.getItem("HospitalId");e?(y(e),p(e)):(console.warn("No HospitalId found in localStorage. Displaying all relevant appointments."),p(null))},[]),n.useEffect(()=>{let e=l.filter(s=>r(s.status)==="completed");if(c.length===1){const s=c[0],o=b[s];o&&(e=e.filter(u=>r(u.consultationType)===o))}h(e)},[l,c,v]),n.useEffect(()=>{const e=[...new Set(l.map(o=>o.servicename).filter(Boolean))],s=[...new Set(l.map(o=>o.consultationType).filter(Boolean))];T(e),C(s),console.log("Available Consultation Types:",s)},[l]);const I=e=>{c.includes(e)?d([]):d([e])},S="Completed";n.useEffect(()=>{const e=l.filter(s=>{var o;return((o=s.status)==null?void 0:o.toLowerCase().trim())===S.toLowerCase().trim()});h(e)},[l,S]),n.useEffect(()=>{const e=localStorage.getItem("HospitalId");e?p(e):console.warn("No HospitalId in localStorage")},[]);const r=e=>e==null?void 0:e.toLowerCase().trim();return t.jsx("div",{style:{overflowX:"auto"},children:t.jsxs("div",{className:"container mt-4",children:[t.jsx("h5",{className:"mb-3",children:"Appointments"}),t.jsx("div",{className:"d-flex gap-2 mb-3",children:["Service & Treatment","In-clinic","Video Consultation"].map(e=>t.jsx("button",{onClick:()=>I(e),className:`btn ${c.includes(e)?"btn-dark":"btn-outline-dark"}`,children:e},e))}),t.jsx("div",{className:"mb-3",children:t.jsx(g,{color:"secondary",onClick:()=>d([]),children:"Reset Filters"})}),t.jsxs(N,{striped:!0,hover:!0,responsive:!0,children:[t.jsx(A,{children:t.jsxs(m,{children:[t.jsx(i,{children:"S.No"}),t.jsx(i,{children:"Name"}),t.jsx(i,{children:"Consultation Type"}),t.jsx(i,{children:"Date"}),t.jsx(i,{children:"Time"}),t.jsx(i,{children:"Status"}),t.jsx(i,{children:"Action"})]})}),t.jsx(D,{children:f.length>0?f.map((e,s)=>t.jsxs(m,{children:[t.jsx(a,{children:s+1}),t.jsx(a,{children:e.name}),t.jsx(a,{children:e.consultationType}),t.jsx(a,{children:e.serviceDate}),t.jsx(a,{children:e.slot||e.servicetime}),t.jsx(a,{children:e.status}),t.jsx(a,{children:t.jsx(g,{color:"primary",size:"sm",onClick:()=>j(`/reportDetails/${e.bookingId}`,{state:{report:e,appointmentInfo:{name:e.name,age:e.age,gender:e.gender,problem:e.problem,bookingId:e.bookingId,item:e}}}),children:"View"})})]},`${e.bookingId}-${s}`)):t.jsx(m,{children:t.jsx(a,{colSpan:"8",className:"text-center text-danger fw-bold",children:"No completed appointments found."})})})]})]})})};export{U as default};
